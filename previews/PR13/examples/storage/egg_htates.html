<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Digital twinning of a high-temperature aquifer thermal energy storage system | Fimbul.jl</title>
    <meta name="description" content="Documentation for Fimbul.jl">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/Fimbul.jl/previews/PR13/assets/style.CvIEFnVx.css" as="style">
    <link rel="preload stylesheet" href="/Fimbul.jl/previews/PR13/vp-icons.css" as="style">
    
    <script type="module" src="/Fimbul.jl/previews/PR13/assets/app.CxSsYsLj.js"></script>
    <link rel="preload" href="/Fimbul.jl/previews/PR13/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/Fimbul.jl/previews/PR13/assets/chunks/theme.rOKQ9fni.js">
    <link rel="modulepreload" href="/Fimbul.jl/previews/PR13/assets/chunks/framework.Dp4Ew8QM.js">
    <link rel="modulepreload" href="/Fimbul.jl/previews/PR13/assets/examples_storage_egg_htates.md.DVtbfeVL.lean.js">
    <script src="/Fimbul.jl/versions.js"></script>
    <script src="/Fimbul.jl/previews/PR13/siteinfo.js"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-492508fc></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-492508fc>Skip to content</a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle has-sidebar" data-v-822684d1 data-v-0f4f798b><a class="title" href="/Fimbul.jl/previews/PR13/" data-v-0f4f798b><!--[--><!--]--><!--[--><img class="VPImage logo" src="/Fimbul.jl/previews/PR13/logo.png" width="24" height="24" alt data-v-35a7d0b8><!--]--><span data-v-0f4f798b>Fimbul.jl</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Manual</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Introduction</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR13/index" data-v-acbfed09><!--[--><span data-v-acbfed09>Fimbul.jl</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Cases</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR13/man/cases/cases" data-v-acbfed09><!--[--><span data-v-acbfed09>Setup functions</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR13/man/cases/utils" data-v-acbfed09><!--[--><span data-v-acbfed09>Utilities</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup active" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Examples</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Storage</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR13/examples/storage/btes" data-v-acbfed09><!--[--><span data-v-acbfed09>Borehole Thermal Energy Storage (BTES)</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link active" href="/Fimbul.jl/previews/PR13/examples/storage/egg_htates" data-v-acbfed09><!--[--><span data-v-acbfed09>Digital twinning of a high-temperature aquifer thermal energy storage system</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Production</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR13/examples/production/doublet" data-v-acbfed09><!--[--><span data-v-acbfed09>Simulation of geothermal energy production from doublet</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Analytical</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR13/examples/analytical/analytical_1d" data-v-acbfed09><!--[--><span data-v-acbfed09>Heat equation in 1D</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><!----><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/sintefmath/Fimbul.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-04f5c5e9><span class="vpi-more-horizontal icon" data-v-04f5c5e9></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/sintefmath/Fimbul.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--[--><!--[--><div class="VPFlyout VPNolebaseEnhancedReadabilitiesMenu VPNolebaseEnhancedReadabilitiesMenuFlyout" aria-label="Enhanced Readability" role="menuitem" data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><span class="i-icon-park-outline:book-open option-icon" data-v-04f5c5e9></span><!----><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--]--></div></div></div><!--]--><!--]--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-168ddf5d><button data-v-168ddf5d>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-18756405><div class="curtain" data-v-18756405></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18756405><span class="visually-hidden" id="sidebar-aria-label" data-v-18756405> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Manual</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Introduction</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR13/index" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Fimbul.jl</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Cases</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR13/man/cases/cases" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Setup functions</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR13/man/cases/utils" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Utilities</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible has-active" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Examples</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><section class="VPSidebarItem level-1 collapsible has-active" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Storage</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR13/examples/storage/btes" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Borehole Thermal Energy Storage (BTES)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR13/examples/storage/egg_htates" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Digital twinning of a high-temperature aquifer thermal energy storage system</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Production</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR13/examples/production/doublet" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Simulation of geothermal energy production from doublet</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Analytical</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR13/examples/analytical/analytical_1d" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Heat equation in 1D</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _Fimbul_jl_previews_PR13_examples_storage_egg_htates" data-v-83890dd9><div><h1 id="Digital-twinning-of-a-high-temperature-aquifer-thermal-energy-storage-system" tabindex="-1">Digital twinning of a high-temperature aquifer thermal energy storage system <a class="header-anchor" href="#Digital-twinning-of-a-high-temperature-aquifer-thermal-energy-storage-system" aria-label="Permalink to &quot;Digital twinning of a high-temperature aquifer thermal energy storage system {#Digital-twinning-of-a-high-temperature-aquifer-thermal-energy-storage-system}&quot;">​</a></h1><p>This script was prepared for the <a href="https://dte_aicomas_2025.iacm.info" target="_blank" rel="noreferrer">2025 DTE &amp; AICOMAS conference</a>:</p><p>Ø. Klemetsdal, O. Andersen, S. Krogstad, O. Møyner, &quot;Predictive Digital Twins for Underground Thermal Energy Storage using Differentiable Programming&quot;</p><p>The example demonstrates digital twinning of high-temperature aquifer thermal energy storage (HT-ATES). We first set up and simulate high-fidelity model of the system, before we construct reduced-order models at several resolutions and calibrate using adjoint-based optimization so that their output matches that of the high-fidelity model.</p><p>Add modules to namespace</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Jutul, JutulDarcy </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Jutul and JutulDarcy modules</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Fimbul </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Fimbul module</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> HYPRE </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Iterative linear solvers</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GLMakie </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Visualization</span></span></code></pre></div><h1 id="Set-up-model" tabindex="-1">Set up model <a class="header-anchor" href="#Set-up-model" aria-label="Permalink to &quot;Set up model {#Set-up-model}&quot;">​</a></h1><p>We use the first realization of the EGG benchmark model [cite], and place a well doublet near the center of the domain. The fluid model is a single-phase water system with PVT formulations taken from the NIST database [cite], which can be conveniently set up with the :geothermal keyword.</p><p>The HT-ATES system is operated by charging the aquifer through the main well (labelled &quot;Hot&quot; in this setup) with water at 25 l/s and 90°C from June to September while a supporting well (labelled &quot;Cold&quot;) is used to extract water at a constant BHP of 25 bar. The system is then discharged from December to March by producing hot water from the main well at a rate of 25 l/s with the supporting well injecting water at 10°C at a BHP of 45 bar. For the remaining months, the system is left to rest with no external forces applied. This cycle of charge – rest – discharge – rest is repeated for a total of 5 years.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hifi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> egg_ates</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    use_bc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, report_interval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> si_unit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:year</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul case with 240 time-steps (5 years) and forces for each step.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Model:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">MultiModel with 5 models and 18 cross-terms. 37181 equations, 37181 degrees of freedom and 301469 parameters.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  models:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    1) Reservoir (37106x37106)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       SinglePhaseSystem{AqueousPhase, Tuple{Float64}}(AqueousPhase(), (998.20715,))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       ∈ MinimalTPFATopology (18553 cells, 52113 faces)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    2) WellA (23x23)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       SinglePhaseSystem{AqueousPhase, Tuple{Float64}}(AqueousPhase(), (998.20715,))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       ∈ MultiSegmentWell [WellA] (8 nodes, 7 segments, 7 perforations)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    3) WellB (23x23)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       SinglePhaseSystem{AqueousPhase, Tuple{Float64}}(AqueousPhase(), (998.20715,))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       ∈ MultiSegmentWell [WellB] (8 nodes, 7 segments, 7 perforations)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    4) WellObs (23x23)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       SinglePhaseSystem{AqueousPhase, Tuple{Float64}}(AqueousPhase(), (998.20715,))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       ∈ MultiSegmentWell [WellObs] (8 nodes, 7 segments, 7 perforations)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    5) Facility (6x6)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.PredictionMode()</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       ∈ WellGroup([:WellA, :WellB, :WellObs], true, true)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  cross_terms:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    1) WellA &lt;-&gt; Reservoir (Eqs: mass_conservation &lt;-&gt; mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    2) WellA &lt;-&gt; Reservoir (Eqs: energy_conservation &lt;-&gt; energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    3) WellB &lt;-&gt; Reservoir (Eqs: mass_conservation &lt;-&gt; mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    4) WellB &lt;-&gt; Reservoir (Eqs: energy_conservation &lt;-&gt; energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    5) WellObs &lt;-&gt; Reservoir (Eqs: mass_conservation &lt;-&gt; mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    6) WellObs &lt;-&gt; Reservoir (Eqs: energy_conservation &lt;-&gt; energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    7) WellA  -&gt; Facility (Eq: control_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    8) Facility  -&gt; WellA (Eq: mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    9) Facility  -&gt; WellA (Eq: energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    10) WellA  -&gt; Facility (Eq: temperature_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellTemperatureCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    11) WellB  -&gt; Facility (Eq: control_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    12) Facility  -&gt; WellB (Eq: mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    13) Facility  -&gt; WellB (Eq: energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    14) WellB  -&gt; Facility (Eq: temperature_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellTemperatureCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    15) WellObs  -&gt; Facility (Eq: control_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    16) Facility  -&gt; WellObs (Eq: mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    17) Facility  -&gt; WellObs (Eq: energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    18) WellObs  -&gt; Facility (Eq: temperature_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellTemperatureCT</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Model storage will be optimized for runtime performance.</span></span></code></pre></div><h2 id="Visualize-the-model" tabindex="-1">Visualize the model <a class="header-anchor" href="#Visualize-the-model" aria-label="Permalink to &quot;Visualize the model {#Visualize-the-model}&quot;">​</a></h2><p>We visualize the model interactively using <code>plot_reservoir</code>.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">reservoir_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data_domain)</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR13/assets/yymqhmy.BCUOuk8a.jpeg" alt=""></p><h2 id="Simulate-high-fidelity-model" tabindex="-1">Simulate high-fidelity model <a class="header-anchor" href="#Simulate-high-fidelity-model" aria-label="Permalink to &quot;Simulate high-fidelity model {#Simulate-high-fidelity-model}&quot;">​</a></h2><p>We set up a simulator for the high-fidelity model and simulate the system.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">results_hifi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> simulate_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">ReservoirSimResult with 240 entries:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  wells (3 present):</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :WellObs</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :WellB</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :WellA</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    Results per well:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :lrat =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :wrat =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :temperature =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :control =&gt; Vector{Symbol} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :Aqueous_mass_rate =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :bhp =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :wcut =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :mass_rate =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :rate =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  states (Vector with 240 entries, reservoir variables for each state)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Pressure =&gt; Vector{Float64} of size (18553,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :TotalMasses =&gt; Matrix{Float64} of size (1, 18553)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :TotalThermalEnergy =&gt; Vector{Float64} of size (18553,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :FluidEnthalpy =&gt; Matrix{Float64} of size (1, 18553)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Temperature =&gt; Vector{Float64} of size (18553,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :PhaseMassDensities =&gt; Matrix{Float64} of size (1, 18553)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :RockInternalEnergy =&gt; Vector{Float64} of size (18553,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :FluidInternalEnergy =&gt; Matrix{Float64} of size (1, 18553)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :PhaseViscosities =&gt; Matrix{Float64} of size (1, 18553)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  time (report time for each state)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     Vector{Float64} of length 240</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  result (extended states, reports)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     SimResult with 240 entries</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  extra</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     Dict{Any, Any} with keys :simulator, :config</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Completed at Jul. 03 2025 11:07 after 42 seconds, 588 milliseconds, 181.8 microseconds.</span></span></code></pre></div><h3 id="Visualize-the-reservoir-states" tabindex="-1">Visualize the reservoir states <a class="header-anchor" href="#Visualize-the-reservoir-states" aria-label="Permalink to &quot;Visualize the reservoir states {#Visualize-the-reservoir-states}&quot;">​</a></h3><p>We visualize the results of the high-fidelity simulation interactively using <code>plot_reservoir</code>. We see that a hot thermal plume develops around the main well, while a cold plume develops around the supporting well. After a few cycles, the plumes start to interact slightly.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi, results_hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, step </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dt),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :seaborn_icefire_gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR13/assets/pjwleus.Az5Y0dcT.jpeg" alt=""></p><h3 id="Inspect-well-output" tabindex="-1">Inspect well output <a class="header-anchor" href="#Inspect-well-output" aria-label="Permalink to &quot;Inspect well output {#Inspect-well-output}&quot;">​</a></h3><p>We can also inspect the well output using <code>plot_well_results</code>.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_well_results</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(results_hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells)</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR13/assets/gsialxh.Bcs9jDyY.jpeg" alt=""></p><h2 id="Construct-proxy-model" tabindex="-1">Construct proxy model <a class="header-anchor" href="#Construct-proxy-model" aria-label="Permalink to &quot;Construct proxy model {#Construct-proxy-model}&quot;">​</a></h2><p>The high-fidelity model is posed on a logicaly Cartesian mesh with 60×60×7 cells. We construct a proxy models by coarsening the high-fidelity model to 15×15×1 cells using the <code>coarsen_reservoir_case</code> function.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">coarsening </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">proxy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JutulDarcy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">coarsen_reservoir_case</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi, coarsening,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    method</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:ijk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    setup_arg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (block_backend </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">results_proxy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> simulate_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(proxy, info_level</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(proxy, results_proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, step </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dt),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :seaborn_icefire_gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR13/assets/gpfksjt.CqfS6JCe.jpeg" alt=""></p><h3 id="Compare-proxy-models-to-high-fidelity-model" tabindex="-1">Compare proxy models to high-fidelity model <a class="header-anchor" href="#Compare-proxy-models-to-high-fidelity-model" aria-label="Permalink to &quot;Compare proxy models to high-fidelity model {#Compare-proxy-models-to-high-fidelity-model}&quot;">​</a></h3><p>We compare the well output of the proxy models to the high-fidelity model.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_well_results</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([results_hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells, results_proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    names </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;High-fidelity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Proxy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR13/assets/cjnconc.DzVJPZg3.jpeg" alt=""></p><h3 id="Define-mismatch-objective-function" tabindex="-1">Define mismatch objective function <a class="header-anchor" href="#Define-mismatch-objective-function" aria-label="Permalink to &quot;Define mismatch objective function {#Define-mismatch-objective-function}&quot;">​</a></h3><p>We define an objective function that measures the mismatch in well output between the high-fidelity model and the proxy model. The objective function is defined as the sum of the squared differences in production temperature of all wells, weighted by the inverse of the units of the respective quantities. The objective function is also scaled by the total time simulated in the high-fidelity model.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states_hf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> results_hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states_proxy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> results_proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">240-element Vector{OrderedDict{Symbol, Any}}:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.4154615415317053e6, 3.4208279107496417e6, 3.45895459632883e6, 3.5147656442310205e6, 3.547813648664499e6, 3.5777061070152116e6, 3.608763140273741e6, 3.6202737641575006e6, 3.621865693648429e6, 3.624351466300209e6  …  3.314421767717723e6, 3.332375471013702e6, 3.3537775130541828e6, 3.3890844052793817e6, 3.2867439189346237e6, 3.2881698015724183e6, 3.2904115172253507e6, 3.296238760449238e6, 3.3076033269208455e6, 3.3103545331961345e6], :TotalMasses =&gt; [455964.91369901755 1.4185879958666253e6 … 557153.0468179858 101302.68556401896], :TotalThermalEnergy =&gt; [1.664351568722943e12, 5.177441457462648e12, 7.396212896593131e12, 7.581171030473459e12, 8.1359115242469375e12, 8.13594677957191e12, 8.135982272436062e12, 7.396378615065111e12, 6.471807563220518e12, 4.99263235654293e12  …  5.924385985599104e12, 5.92439964864724e12, 4.628370199310313e12, 1.4810583999103667e12, 9.256537850237656e11, 5.183707805139301e12, 4.813491218264015e12, 3.147292999537707e12, 2.0364203101186265e12, 3.702182093050039e11], :FluidEnthalpy =&gt; [1.3019092104649325e6 1.3018074413787012e6 … 1.3029542173666134e6 1.3028482634535716e6], :Temperature =&gt; [323.20013883092275, 323.1585932739092, 323.1524397298706, 323.15662954899886, 323.15847842297615, 323.16096253139347, 323.16348771002293, 323.1654546079377, 323.1640332523926, 323.1716895394497  …  323.64870229732725, 323.65007089605507, 323.6448186693461, 323.6402866575394, 323.6344067431488, 323.63803442533384, 323.64209549011156, 323.64354558832144, 323.63139210518153, 323.58827262225753]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.955178777197535, 13.844196941371305, 7.341439252170579], :Pressure =&gt; [4.227498372332083e6, 4.265556528869781e6, 4.3605123573188735e6, 4.436431822494731e6], :PhaseMassDensities =&gt; [967.277289205959 967.3143155426347 967.3896762929979 967.4668503709484], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.6205144036778 364.6689056905177 243.13154401605524 243.15093997736219], :TotalThermalEnergy =&gt; [3.9276424802936095e8, 5.0497301028933424e8, 3.366387356791213e8, 3.366247467013507e8], :FluidEnthalpy =&gt; [1.3891936417993677e6 1.3891535014663436e6 1.3891025672252143e6 1.389012699940749e6], :Temperature =&gt; [363.14999963456637, 363.1210191997583, 363.0741304626329, 363.01134714653125]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.04767088281358, -14.59164373837061, -7.060407962340667], :Pressure =&gt; [2.5e6, 2.5389121752763162e6, 2.636004423735947e6, 2.71361478357892e6], :PhaseMassDensities =&gt; [989.0136215529633 989.0323835798229 988.9988176511927 988.9795785003618], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.9939399252957 372.8564244500129 248.5625135953583 248.55767826936534], :TotalThermalEnergy =&gt; [3.768960880511734e8, 4.8457522582718074e8, 3.231232180029447e8, 3.2317382121081924e8], :FluidEnthalpy =&gt; [1.3021966129164307e6 1.302196613304778e6 1.3026329412674007e6 1.3029403446605797e6], :Temperature =&gt; [323.38799283111865, 323.3849678847032, 323.55428799862864, 323.6728280945519]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024955177277781078, -0.007770118305837046, 0.000610583267087866], :Pressure =&gt; [3.362647355436265e6, 3.4014619133878206e6, 3.4984959157587467e6, 3.5761178147292566e6], :PhaseMassDensities =&gt; [989.4865086486498 989.5051220848326 989.437764281153 989.3699555409212], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.1325976637024 373.0346426677419 248.6728329159984 248.6557907207855], :TotalThermalEnergy =&gt; [3.767328765336501e8, 4.843654447598995e8, 3.230182391978605e8, 3.231187974851964e8], :FluidEnthalpy =&gt; [1.3018835500614536e6 1.3018838202742706e6 1.30250459338547e6 1.3030767269982637e6], :Temperature =&gt; [323.1938970234387, 323.1909717784991, 323.4343276342815, 323.65965100653307]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.047670884625234, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 1), :SurfaceTemperature =&gt; [363.14999963456637, 323.38799283111865, 323.1938970234387]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.4147772673772746e6, 3.4200406766044656e6, 3.457897782169788e6, 3.513268903462439e6, 3.545992815933048e6, 3.575422044890708e6, 3.605898778306735e6, 3.6171492463701144e6, 3.618661950525007e6, 3.6211042977975262e6  …  3.3143605640918002e6, 3.3323136470069643e6, 3.353707680278364e6, 3.388997969913123e6, 3.2866780633780863e6, 3.2881044046677933e6, 3.290347067163092e6, 3.2961754924014052e6, 3.3075415998888505e6, 3.310292802464097e6], :TotalMasses =&gt; [455964.5865889737 1.418585720526285e6 … 557154.0288158149 101302.89534600117], :TotalThermalEnergy =&gt; [1.664355362493291e12, 5.177477056238115e12, 7.396260508631344e12, 7.581215665501717e12, 8.135956183756496e12, 8.135990528415928e12, 8.136024838867768e12, 7.396415061476074e12, 6.471841207988851e12, 4.992660189169212e12  …  5.924339537253135e12, 5.924351367323559e12, 4.628332337756709e12, 1.4810465768448066e12, 9.256458821671593e11, 5.183665690539575e12, 4.81345231520682e12, 3.14726679590888e12, 2.0364004472456338e12, 3.702139753557962e11], :FluidEnthalpy =&gt; [1.3019112845677263e6 1.3018140248017516e6 … 1.3029445787540541e6 1.3028369648268253e6], :Temperature =&gt; [323.2010305792629, 323.16131496732004, 323.1549796470398, 323.1589390686409, 323.1606208368733, 323.1630485521353, 323.1655010590632, 323.1673403483185, 323.1660250447367, 323.17383024676275  …  323.645568498657, 323.64681351603343, 323.64154893160065, 323.6370955481428, 323.63099430978946, 323.6347870284266, 323.63886498417935, 323.6402177575465, 323.62749400700005, 323.5837031223076]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.955178762757818, 13.832153558756213, 7.331931008666692], :Pressure =&gt; [4.152471927533631e6, 4.1905286086196317e6, 4.285479959649322e6, 4.361395125876244e6], :PhaseMassDensities =&gt; [967.242538228563 967.2736425837466 967.3420956135978 967.4061827288992], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.6103248849172 364.65357234625657 243.11958568702676 243.13569253587642], :TotalThermalEnergy =&gt; [3.9276312068283564e8, 5.049747193762574e8, 3.366423395420931e8, 3.3663302229193e8], :FluidEnthalpy =&gt; [1.3891620102484052e6 1.3891390345745431e6 1.389108150938995e6 1.3890562793163082e6], :Temperature =&gt; [363.1499998286072, 363.1298676342617, 363.0933019675592, 363.05007818595897]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.048319877527636, -14.591617128969487, -7.060179994502848], :Pressure =&gt; [2.5e6, 2.5389120670857704e6, 2.6360040702206767e6, 2.7136142991265287e6], :PhaseMassDensities =&gt; [989.0107275255889 989.0294898614943 988.9967286358327 988.9783653731176], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.99309135214946 372.85533354390384 248.56198856853365 248.5573733772343], :TotalThermalEnergy =&gt; [3.7689953912593377e8, 4.845796631733726e8, 3.23125352039931e8, 3.2317505983542573e8], :FluidEnthalpy =&gt; [1.3022123239246346e6 1.3022123241693377e6 1.3026442779379482e6 1.302946925672788e6], :Temperature =&gt; [323.3943622757201, 323.39133655519805, 323.55888538088016, 323.6754976074402]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.02495517829350879, -0.007584886375540467, 0.0007551758269232683], :Pressure =&gt; [3.363000378974386e6, 3.40181490224412e6, 3.4988488293319326e6, 3.5764707797354097e6], :PhaseMassDensities =&gt; [989.4856096976355 989.5042527576906 989.437098789763 989.3719317966995], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.1323340774982 373.0343149391303 248.67266565976945 248.65628740803626], :TotalThermalEnergy =&gt; [3.767341182441099e8, 4.8436699585786e8, 3.230190630518915e8, 3.231169132127719e8], :FluidEnthalpy =&gt; [1.3018893694090839e6 1.3018894788319867e6 1.302509139131942e6 1.303066903059101e6], :Temperature =&gt; [323.19622157817207, 323.19323110043115, 323.4361382540552, 323.6556472693372]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.048319878669247, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 2), :SurfaceTemperature =&gt; [363.1499998286072, 323.3943622757201, 323.19622157817207]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.4140339341330845e6, 3.4191941598115126e6, 3.4567891777143017e6, 3.5117436762770284e6, 3.544172655546718e6, 3.573221930369564e6, 3.603240448412698e6, 3.6142881015198706e6, 3.615750308224055e6, 3.618179557374055e6  …  3.3143020628129467e6, 3.3322574251874476e6, 3.35364660964904e6, 3.3889252265183567e6, 3.2866090051988075e6, 3.288036102792459e6, 3.290280213457872e6, 3.296111312239679e6, 3.3074822160998215e6, 3.3102362458674554e6], :TotalMasses =&gt; [455964.2215554234 1.4185834394708253e6 … 557154.9897751025 101303.09282452521], :TotalThermalEnergy =&gt; [1.6643596768670894e12, 5.177512033800938e12, 7.396307343369552e12, 7.581259636020385e12, 8.136000329712432e12, 8.136034201638463e12, 8.136071838954061e12, 7.3964514633393125e12, 6.471874757555214e12, 4.992687925045212e12  …  5.924293810442801e12, 5.924303936654867e12, 4.628295331996885e12, 1.481034949054601e12, 9.256381333081252e11, 5.183624368324164e12, 4.813414108435975e12, 3.1472410226373037e12, 2.0363810147946445e12, 3.702099910756061e11], :FluidEnthalpy =&gt; [1.301913652196419e6 1.3018204745975959e6 … 1.3029351491747578e6 1.3028263327375208e6], :Temperature =&gt; [323.2020455813018, 323.163987331838, 323.15747636379865, 323.16121293283, 323.16273811400555, 323.16513300509513, 323.16773689545994, 323.1692302461356, 323.1680183533157, 323.1759713733587  …  323.6424834366305, 323.64361365234913, 323.6383532925412, 323.63395746272437, 323.627648274647, 323.63160064100543, 323.63569222196185, 323.6369445466647, 323.6236804230459, 323.5794031407853]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.955178757550065, 13.839750142053056, 7.322074455366124], :Pressure =&gt; [4.1159267232008814e6, 4.1539826817751457e6, 4.248931979906506e6, 4.324844951018038e6], :PhaseMassDensities =&gt; [967.2256097580089 967.2536371517276 967.3182414294411 967.3754739338062], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.60536119810246 364.64603047606505 243.11359047665042 243.12797457387123], :TotalThermalEnergy =&gt; [3.927625710789115e8, 5.049756528897485e8, 3.366443328233886e8, 3.366374585647905e8], :FluidEnthalpy =&gt; [1.389146602033526e6 1.3891325426073484e6 1.3891128226964257e6 1.389080837969388e6], :Temperature =&gt; [363.14999989857745, 363.13446638999676, 363.1036514928571, 363.0706707975647]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.047852841589723, -14.590952845185997, -7.059665145683078], :Pressure =&gt; [2.5e6, 2.5389119932892653e6, 2.6360038514303397e6, 2.713614029402861e6], :PhaseMassDensities =&gt; [989.0089605446683 989.0277230633524 988.9957277433755 988.9781417840478], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.99257324628337 372.85466747669625 248.56173701682238 248.55731718317196], :TotalThermalEnergy =&gt; [3.769016461497166e8, 4.845823723610956e8, 3.2312637446142846e8, 3.231752880496102e8], :FluidEnthalpy =&gt; [1.302221916265554e6 1.3022219164344769e6 1.3026497093809487e6 1.3029481381266383e6], :Temperature =&gt; [323.3982512116665, 323.39522502390645, 323.56108803767347, 323.6759894429032]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024955177210594027, -0.007403096559218609, 0.0009178967211394931], :Pressure =&gt; [3.3633218116109516e6, 3.402136198656476e6, 3.499169781749099e6, 3.5767915867877994e6], :PhaseMassDensities =&gt; [989.4821580913977 989.5007588714329 989.4335776484634 989.3717467047705], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.13132201369024 373.03299777504236 248.67178070043832 248.65624088936073], :TotalThermalEnergy =&gt; [3.767384034712304e8, 4.843725714467656e8, 3.2302280380173177e8, 3.231172311247959e8], :FluidEnthalpy =&gt; [1.301909005590263e6 1.3019093470927346e6 1.3025291417296766e6 1.3030687496106902e6], :Temperature =&gt; [323.20413346463596, 323.2012359178036, 323.444202743164, 323.6563690804021]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.047852842377797, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 3), :SurfaceTemperature =&gt; [363.14999989857745, 323.3982512116665, 323.20413346463596]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.4133197288229535e6, 3.4183778188460143e6, 3.4557173886585776e6, 3.5102719499017354e6, 3.542424732011717e6, 3.57114184191273e6, 3.6007676491146106e6, 3.611642634318653e6, 3.6130683813962834e6, 3.6154982500080643e6  …  3.314283944739517e6, 3.3322440900354544e6, 3.353631281850046e6, 3.388902728565461e6, 3.2865760852034683e6, 3.2880040826561335e6, 3.290249961757361e6, 3.2960847439404926e6, 3.307462923461069e6, 3.310222199447647e6], :TotalMasses =&gt; [455963.843168127 1.4185811987595626e6 … 557155.9428738386 101303.28286639243], :TotalThermalEnergy =&gt; [1.6643643734911738e12, 5.177546581055365e12, 7.396353653939933e12, 7.581303175519215e12, 8.136044214721908e12, 8.136078365792595e12, 8.136125915969027e12, 7.396487914100918e12, 6.471908223785095e12, 4.992715571661522e12  …  5.924248684754582e12, 5.924257211945936e12, 4.62825900958252e12, 1.4810234951660303e12, 9.256305104303722e11, 5.183583693704478e12, 4.8133764725598e12, 3.147215604916884e12, 2.0363619340498662e12, 3.702061925644022e11], :FluidEnthalpy =&gt; [1.3019162538943996e6 1.3018268500362919e6 … 1.302925900231111e6 1.3028162065388495e6], :Temperature =&gt; [323.2031529144586, 323.16662733237575, 323.1599457676196, 323.16346549517925, 323.16484444361834, 323.16724456567607, 323.17032422958226, 323.17112808706264, 323.17001212765837, 323.1781115244581  …  323.639439929511, 323.640462475986, 323.6352177883697, 323.6308675470414, 323.62435752609093, 323.628465080276, 323.63256776757373, 323.63371741933605, 323.61993685151066, 323.5753046653922]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.95517875467972, 13.849160077478963, 7.314925993399245], :Pressure =&gt; [4.093320064940989e6, 4.1313755765794166e6, 4.226323663026351e6, 4.302235267447776e6], :PhaseMassDensities =&gt; [967.2151170568703 967.2412830016049 967.3034316585629 967.356455232403], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.6022845774399 364.641373071193 243.10986837525903 243.1231946528625], :TotalThermalEnergy =&gt; [3.927622289822041e8, 5.0497621842900056e8, 3.3664558389599967e8, 3.366402084912204e8], :FluidEnthalpy =&gt; [1.3891370928083798e6 1.3891284635695373e6 1.3891158641262471e6 1.389096086164243e6], :Temperature =&gt; [363.1499999371598, 363.1372794064959, 363.11013339344447, 363.08344173999194]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.048607992079518, -14.591008929495146, -7.059508045564726], :Pressure =&gt; [2.5e6, 2.538911948916747e6, 2.6360037166058747e6, 2.7136138788541667e6], :PhaseMassDensities =&gt; [989.0076623362083 989.0264249919364 988.9951706595532 988.9783205827823], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.9921925916817 372.85417811530135 248.5615970063869 248.55736212019525], :TotalThermalEnergy =&gt; [3.7690319415594375e8, 4.8458436277196026e8, 3.2312694351663375e8, 3.2317510540627855e8], :FluidEnthalpy =&gt; [1.3022289637069826e6 1.3022289638310848e6 1.3026527323977072e6 1.302947167599041e6], :Temperature =&gt; [323.4011084295834, 323.3980819021604, 323.5623139952017, 323.6755957744904]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.02495517512330964, -0.007190080181989941, 0.0011236647190671488], :Pressure =&gt; [3.3636786432770207e6, 3.4024927097341865e6, 3.499525460205467e6, 3.57714675642772e6], :PhaseMassDensities =&gt; [989.4740264541402 989.4925450726128 989.4248113122308 989.3675412469013], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.12893769311574 373.0299012458386 248.66957747983773 248.65518394251697], :TotalThermalEnergy =&gt; [3.767483114680362e8, 4.843854388763654e8, 3.2303193885464066e8, 3.231216829123735e8], :FluidEnthalpy =&gt; [1.3019542158124745e6 1.3019550089320855e6 1.3025777773682433e6 1.3030925509477563e6], :Temperature =&gt; [323.22238061059903, 323.21966360182165, 323.46384577538277, 323.6659732859343]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.048607992658518, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 4), :SurfaceTemperature =&gt; [363.1499999371598, 323.4011084295834, 323.22238061059903]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.4125983265403067e6, 3.417554443912869e6, 3.4546423515976253e6, 3.5088079731988925e6, 3.5406975703129154e6, 3.5691153309211847e6, 3.5983916141403546e6, 3.609113748986707e6, 3.6105118384754183e6, 3.612950278037459e6  …  3.314270473481489e6, 3.3322358836599966e6, 3.3536215437711817e6, 3.388886511728365e6, 3.286546845479358e6, 3.287975786490891e6, 3.2902235223595537e6, 3.2960622243434447e6, 3.3074482122182054e6, 3.3102132070893217e6], :TotalMasses =&gt; [455963.4465981058 1.4185789763750134e6 … 557156.8801496093 101303.46452578316], :TotalThermalEnergy =&gt; [1.664369403871767e12, 5.177580675604018e12, 7.39639940620748e12, 7.581346247472871e12, 8.136087862733753e12, 8.136123548587446e12, 8.136190349500436e12, 7.396524414090295e12, 6.471941511562098e12, 4.992743045307049e12  …  5.924204121472421e12, 5.924211153227809e12, 4.628223322486737e12, 1.4810122117046443e12, 9.256230070900769e11, 5.183543629251671e12, 4.813339373623178e12, 3.147190522100511e12, 2.036343190734401e12, 3.702025655073162e11], :FluidEnthalpy =&gt; [1.3019190516100845e6 1.3018331373328206e6 … 1.3029168158552158e6 1.3028065384475496e6], :Temperature =&gt; [323.2043400417046, 323.16923230233783, 323.1623850042371, 323.16569367673486, 323.16693969647105, 323.16940741212426, 323.1734215290066, 323.17303154427947, 323.17199805896047, 323.18024102134166  …  323.6364344757682, 323.63735635049807, 323.6321372725272, 323.62782376770724, 323.62111847349075, 323.6253766497494, 323.62948798528737, 323.63053291790584, 323.61625960561855, 323.5713913142125]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.955178753083633, 13.85869651153583, 7.309731521130471], :Pressure =&gt; [4.0784237542300704e6, 4.116478973112218e6, 4.211426314823183e6, 4.287337034152763e6], :PhaseMassDensities =&gt; [967.2082030550662 967.2332314771925 967.2938136336188 967.3442448792615], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.6002572862276 364.6383377179997 243.10745110193852 243.12012585640431], :TotalThermalEnergy =&gt; [3.927620035152496e8, 5.0497654288621926e8, 3.366463579249489e8, 3.366419052661718e8], :FluidEnthalpy =&gt; [1.3891308265659653e6 1.3891255156226149e6 1.3891174592632577e6 1.389105198094698e6], :Temperature =&gt; [363.1499999585936, 363.13899863965906, 363.1141942541873, 363.09137590392595]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.049333385181757, -14.591054920739515, -7.059352387925711], :Pressure =&gt; [2.5e6, 2.5389119154403135e6, 2.6360036194248707e6, 2.713613785548106e6], :PhaseMassDensities =&gt; [989.0066474845232 989.0254102465074 988.9948770605922 988.9787347766028], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.99189502162585 372.85379556528716 248.5615232169198 248.5574662184563], :TotalThermalEnergy =&gt; [3.7690440426307666e8, 4.8458591871764004e8, 3.231272434126506e8, 3.231746824064311e8], :FluidEnthalpy =&gt; [1.3022344728660514e6 1.3022344729630623e6 1.302654325539069e6 1.3029449199987547e6], :Temperature =&gt; [323.4033420095574, 323.4003152197265, 323.562960083912, 323.67468407798106]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024955171670421217, -0.006973454574832291, 0.001351878589997321], :Pressure =&gt; [3.3640129941742336e6, 3.4028264353084974e6, 3.499857555338646e6, 3.5774777388356715e6], :PhaseMassDensities =&gt; [989.4581528175468 989.4765361552618 989.4075691147557 989.3564161984268], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.12428329977234 373.02386602618157 248.6652440429642 248.6523879128723], :TotalThermalEnergy =&gt; [3.767674805730857e8, 4.844102970775576e8, 3.230497561496484e8, 3.231332151356178e8], :FluidEnthalpy =&gt; [1.3020415127067585e6 1.3020430504764025e6 1.302672464497842e6 1.30315391731438e6], :Temperature =&gt; [323.2576455604614, 323.2552257209934, 323.5021207954402, 323.6907836143555]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.04933338563438, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 5), :SurfaceTemperature =&gt; [363.1499999585936, 323.4033420095574, 323.2576455604614]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.411864462841472e6, 3.4167183529989514e6, 3.4535569952814532e6, 3.507341781864568e6, 3.5389781340942066e6, 3.5671210512635633e6, 3.5960786072252234e6, 3.6066616566979745e6, 3.608038035901885e6, 3.6104900804575733e6  …  3.3142563731991034e6, 3.3322269658457576e6, 3.3536108323724796e6, 3.38886881980265e6, 3.286516951691723e6, 3.2879468470541285e6, 3.2901964576280857e6, 3.296039091186494e6, 3.3074328703341335e6, 3.310203514300788e6], :TotalMasses =&gt; [455963.0326670416 1.4185767687327473e6 … 557157.8006035968 101303.63813398247], :TotalThermalEnergy =&gt; [1.6643747306493286e12, 5.177614318462083e12, 7.39644460109825e12, 7.581388857975779e12, 8.136131381857382e12, 8.136170505614404e12, 8.136268694825762e12, 7.396561056148123e12, 6.471974582156637e12, 4.992770315620488e12  …  5.924160108552278e12, 5.924165747954307e12, 4.628188247276277e12, 1.4810011018854128e12, 9.256156206914968e11, 5.183504159328357e12, 4.813302797994013e12, 3.1471657670513354e12, 2.0363247793725295e12, 3.7019909821229944e11], :FluidEnthalpy =&gt; [1.3019220218437929e6 1.3018393352288157e6 … 1.3029078920550917e6 1.3027972958362189e6], :Temperature =&gt; [323.20559787866034, 323.17180217584155, 323.16479394435345, 323.16789754560426, 323.1690288404041, 323.1716580317281, 323.1772021682374, 323.174944615064, 323.17397271821915, 323.1823565024431  …  323.6334661313267, 323.6342942837975, 323.6291095582073, 323.62482679797625, 323.61792988788943, 323.6223340348715, 323.6264516325636, 323.6273900197459, 323.61264748032534, 323.56765032666124]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.95517875216119, 13.867015360508473, 7.306127947703775], :Pressure =&gt; [4.067983545768778e6, 4.106038561324965e6, 4.200985416284522e6, 4.276895539523082e6], :PhaseMassDensities =&gt; [967.2033573187452 967.2276831251983 967.287271156247 967.3361008776621], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.598836442129 364.63624603857596 243.10580679803073 243.1180790455567], :TotalThermalEnergy =&gt; [3.9276184547204745e8, 5.0497671366183144e8, 3.3664682981353176e8, 3.366429470956488e8], :FluidEnthalpy =&gt; [1.3891264346795722e6 1.3891231583099351e6 1.3891180019727866e6 1.3891103841805877e6], :Temperature =&gt; [363.1499999709807, 363.14004811213374, 363.11674389720304, 363.09631837456214]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.0499547233784, -14.591046108707497, -7.059174868592059], :Pressure =&gt; [2.5e6, 2.5389118878025236e6, 2.6360035434749005e6, 2.7136137247983674e6], :PhaseMassDensities =&gt; [989.0058046164404 989.0245674656409 988.9947396275261 988.9792842916703], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.991647879796 372.8534778443857 248.56148867622292 248.55760432665625], :TotalThermalEnergy =&gt; [3.769054092842468e8, 4.845872109671863e8, 3.23127383780785e8, 3.2317412122967964e8], :FluidEnthalpy =&gt; [1.3022390483694852e6 1.3022390484500541e6 1.3026550712041974e6 1.3029419382376492e6], :Temperature =&gt; [323.4051970720239, 323.4021700666909, 323.5632624867956, 323.6734745830315]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024955166758026122, -0.006743064822065803, 0.0016075636823143856], :Pressure =&gt; [3.36431362334926e6, 3.403126006093321e6, 3.500154363400087e6, 3.5777725705503e6], :PhaseMassDensities =&gt; [989.431267420478 989.4494587391173 989.3783033311734 989.3352984372057], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.1164000896198 373.01365808078504 248.6578887493079 248.64708044059128], :TotalThermalEnergy =&gt; [3.7679981405201083e8, 4.844521707515365e8, 3.230798816623893e8, 3.2315496766712964e8], :FluidEnthalpy =&gt; [1.302188646391245e6 1.302191242888851e6 1.3028324499600257e6 1.303269515229493e6], :Temperature =&gt; [323.317113913423, 323.3151157212817, 323.566824762698, 323.737552197939]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.04995472375432, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 6), :SurfaceTemperature =&gt; [363.1499999709807, 323.4051970720239, 323.317113913423]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.4111251488315035e6, 3.4158771851013443e6, 3.4524698363651573e6, 3.505882218437203e6, 3.5372741712624673e6, 3.5651605841678046e6, 3.593821267160303e6, 3.604275086591893e6, 3.605633096055409e6, 3.6081006056921384e6  …  3.3142367263277266e6, 3.332211500467046e6, 3.35359234050095e6, 3.388841336617267e6, 3.286483195796147e6, 3.2879139872528557e6, 3.290165344824058e6, 3.296011509559307e6, 3.307412099577946e6, 3.310187422793368e6], :TotalMasses =&gt; [455962.60435553454 1.4185745800011684e6 … 557158.7033421446 101303.80398433804], :TotalThermalEnergy =&gt; [1.6643803223462036e12, 5.177647521244628e12, 7.396489257005449e12, 7.581431038604965e12, 8.136174950786882e12, 8.136220185008791e12, 8.136364588133138e12, 7.396597993583934e12, 6.472007423991186e12, 4.992797370765676e12  …  5.92411663440758e12, 5.924120983313238e12, 4.628153761881516e12, 1.4809901676703506e12, 9.256083488170586e11, 5.18346526946337e12, 4.813266733036777e12, 3.14714133318423e12, 2.0363066944085864e12, 3.7019577979260315e11], :FluidEnthalpy =&gt; [1.3019251477256676e6 1.3018454478940323e6 … 1.3028991249068314e6 1.302788448236607e6], :Temperature =&gt; [323.20691906039804, 323.1743380402561, 323.1671737946515, 323.1700789858807, 323.1711208282064, 323.1740429280281, 323.1818441601953, 323.1768752778832, 323.17593504056157, 323.1844566041918  …  323.6305339918582, 323.63127526592484, 323.62613257019706, 323.62187695911797, 323.61479064529334, 323.6193360381305, 323.6234575748576, 323.62428779286194, 323.6090992652018, 323.5640698126575]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.95517875160025, 13.873027061364278, 7.304076119489752], :Pressure =&gt; [4.060253099818217e6, 4.098307966542519e6, 4.193254472843155e6, 4.2691641805770965e6], :PhaseMassDensities =&gt; [967.1997692973566 967.2236626566132 967.2826162517116 967.330453106667], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.59778437930976 364.6347303576275 243.1046368929194 243.11665960588732], :TotalThermalEnergy =&gt; [3.927617284369169e8, 5.049767933678407e8, 3.36647111901101e8, 3.366435824981546e8], :FluidEnthalpy =&gt; [1.3891231826372521e6 1.3891211585222105e6 1.389117854817265e6 1.389113115620111e6], :Temperature =&gt; [363.14999997851294, 363.14069402863026, 363.11834871157237, 363.0994065936773]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.05041577397669, -14.5909485031925, -7.058957741563404], :Pressure =&gt; [2.5e6, 2.5389118627597694e6, 2.636003478347694e6, 2.7136136810355918e6], :PhaseMassDensities =&gt; [989.0050639751711 989.0238268997857 988.9946915166158 988.9799070100635], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.99143071243344 372.8531986576357 248.56147658463235 248.5577608328586], :TotalThermalEnergy =&gt; [3.769062924021723e8, 4.84588346475778e8, 3.2312743290373516e8, 3.2317348530088884e8], :FluidEnthalpy =&gt; [1.3022430689080998e6 1.3022430689788945e6 1.3026553321366417e6 1.3029385593116346e6], :Temperature =&gt; [323.40682714421234, 323.40379995146355, 323.5633683105125, 323.6721039905491]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.02495516037602749, -0.006477736918907171, 0.0019020552945400752], :Pressure =&gt; [3.364561688501191e6, 3.4033724502956267e6, 3.5003965762572205e6, 3.578011680062081e6], :PhaseMassDensities =&gt; [989.3900692352129 989.4080115996204 989.3334558299848 989.3010318205137], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.10432015077726 372.9980328773104 248.6466173428866 248.63846830049025], :TotalThermalEnergy =&gt; [3.768492381603332e8, 4.845161087676329e8, 3.231259379354462e8, 3.231901551186818e8], :FluidEnthalpy =&gt; [1.3024134869037885e6 1.3024174583620375e6 1.3030769813454899e6 1.3034564190754632e6], :Temperature =&gt; [323.4080326351226, 323.4065808816837, 323.66577008804825, 323.8132064382156]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.05041577430702, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 7), :SurfaceTemperature =&gt; [363.14999997851294, 323.40682714421234, 323.4080326351226]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.4103846674421537e6, 3.4150349973788355e6, 3.4513842049142006e6, 3.5044312142604254e6, 3.5355863038829244e6, 3.5632314331571152e6, 3.5916127571410756e6, 3.601944987426422e6, 3.6032871852740943e6, 3.6057713670289037e6  …  3.3142136533942777e6, 3.3321913488209425e6, 3.353567622337407e6, 3.3888051057731616e6, 3.2864481995557314e6, 3.287879806786654e6, 3.290132738600639e6, 3.295981910541026e6, 3.3073880504592336e6, 3.3101668293398456e6], :TotalMasses =&gt; [455962.1639851035 1.4185724122738284e6 … 557159.5890758502 101303.96264770925], :TotalThermalEnergy =&gt; [1.6643861497514326e12, 5.177680292521967e12, 7.396533386696228e12, 7.581472819227502e12, 8.136218791712764e12, 8.136273682576422e12, 8.136481627420577e12, 7.396635408978241e12, 6.472040029873631e12, 4.992824203685786e12  …  5.924073693749258e12, 5.924076852980868e12, 4.628119851331112e12, 1.4809794121110571e12, 9.256011898684957e11, 5.183426949987631e12, 4.813231170616262e12, 3.147117216947289e12, 2.0362889321622363e12, 3.701926005565006e11], :FluidEnthalpy =&gt; [1.3019284130316984e6 1.3018514780017396e6 … 1.3028905131862224e6 1.3027799703200762e6], :Temperature =&gt; [323.2082966961339, 323.1768406578459, 323.1695253272891, 323.17223961688484, 323.17322656406475, 323.176615738817, 323.1875236675809, 323.1788331453668, 323.17788433365047, 323.18654049723995  …  323.6276377531074, 323.62829891629735, 323.62320505439646, 323.6189750996173, 323.61170012067856, 323.61638197862703, 323.6205052001467, 323.62122584647875, 323.6056142910047, 323.56063936135035]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.95517875125414, 13.877827537692818, 7.302833421383883], :Pressure =&gt; [4.0541946274251128e6, 4.0922493789103376e6, 4.1871956246338096e6, 4.2631050278596375e6], :PhaseMassDensities =&gt; [967.1969573092556 967.2205833363839 967.2791314176138 967.3263503202845], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.59695986133477 364.6335694812502 243.10376105858336 243.11562846320263], :TotalThermalEnergy =&gt; [3.92761636707343e8, 5.049768177461899e8, 3.3664727499557024e8, 3.3664396551257354e8], :FluidEnthalpy =&gt; [1.3891206339166034e6 1.3891193839806034e6 1.3891172664962206e6 1.3891143189860778e6], :Temperature =&gt; [363.1499999831605, 363.14109331701013, 363.11936249775334, 363.1013436243411]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.050897216561047, -14.590866942257641, -7.058750716342684], :Pressure =&gt; [2.5e6, 2.5389118400070383e6, 2.636003420442502e6, 2.7136136474107816e6], :PhaseMassDensities =&gt; [989.0043768124547 989.0231398065441 988.9946858606061 988.9805601020394], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.99122922580153 372.8529396295861 248.56147516312205 248.55792497277488], :TotalThermalEnergy =&gt; [3.7690711174573034e8, 4.8458939998465955e8, 3.231274386586812e8, 3.2317281835311264e8], :FluidEnthalpy =&gt; [1.3022467991179093e6 1.3022467991835903e6 1.3026553626809197e6 1.302935015588564e6], :Temperature =&gt; [323.4083395158272, 323.40531215075674, 323.5633807020165, 323.6706665583815]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024955152547081274, -0.006203234249010095, 0.0022059596752904555], :Pressure =&gt; [3.3647517398165553e6, 3.403560191061944e6, 3.500578295273825e6, 3.578188909301899e6], :PhaseMassDensities =&gt; [989.3313189833179 989.348956786027 989.2697019474379 989.2503273996214], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.0870936772006 372.97576973708505 248.63059424456281 248.62572488959586], :TotalThermalEnergy =&gt; [3.76919593711316e8, 4.846070476206927e8, 3.2319129584811527e8, 3.232421208442769e8], :FluidEnthalpy =&gt; [1.3027335537750165e6 1.302739209912422e6 1.303424013916027e6 1.303732419271835e6], :Temperature =&gt; [323.53752590934613, 323.53674234619507, 323.80626846994664, 323.9249791857566]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.050897216867522, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 8), :SurfaceTemperature =&gt; [363.1499999831605, 323.4083395158272, 323.53752590934613]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.409640714101961e6, 3.414189852063948e6, 3.45029883832356e6, 3.502988081506497e6, 3.533913514242035e6, 3.561329456837694e6, 3.589444882453161e6, 3.5996615884843785e6, 3.6009893553208862e6, 3.603489906531801e6  …  3.3141830673847375e6, 3.332162122350111e6, 3.353531887099601e6, 3.38875467209672e6, 3.286408342839526e6, 3.2878406714186156e6, 3.2900949716376388e6, 3.2959465191239226e6, 3.3073566716594123e6, 3.3101373939205958e6], :TotalMasses =&gt; [455961.7125155376 1.4185702641116832e6 … 557160.4571012162 101304.11439941642], :TotalThermalEnergy =&gt; [1.6643921845479473e12, 5.177712636961789e12, 7.39657699913091e12, 7.581514234476429e12, 8.13626318086514e12, 8.13633222578775e12, 8.136623262815498e12, 7.396673507904342e12, 6.472072392098071e12, 4.992850806105775e12  …  5.924031276051163e12, 5.924033345042532e12, 4.628086497586645e12, 1.4809688360200452e12, 9.255941414269178e11, 5.183389186785555e12, 4.813196098470319e12, 3.147093412053458e12, 2.036271486926273e12, 3.7018955117839764e11], :FluidEnthalpy =&gt; [1.3019318003817447e6 1.3018574259475889e6 … 1.3028820530883633e6 1.3027718361260188e6], :Temperature =&gt; [323.20972394281324, 323.179310338724, 323.17184899303805, 323.1743812423617, 323.1753595590998, 323.17943651362134, 323.194409582509, 323.18082905156916, 323.1798198453681, 323.18860720518063  …  323.6247766029476, 323.6253643215481, 323.6203253338165, 323.616121301972, 323.6086571792348, 323.6134706773739, 323.6175933987979, 323.6182032879381, 323.6021913362305, 323.5573488013879]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.955178751025553, 13.881838768184107, 7.30222346228857], :Pressure =&gt; [4.0492404167561634e6, 4.0872950750350985e6, 4.182241117453558e6, 4.258150288348688e6], :PhaseMassDensities =&gt; [967.1946578552709 967.2181177574074 967.2764060990961 967.323238466734], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.59628562621185 364.6326399798743 243.10307611133263 243.11484636910234], :TotalThermalEnergy =&gt; [3.927615616923349e8, 5.0497680976388425e8, 3.366473642229476e8, 3.3664419233439237e8], :FluidEnthalpy =&gt; [1.389118549716086e6 1.3891177809357257e6 1.3891164252726454e6 1.3891145985990814e6], :Temperature =&gt; [363.1499999862299, 363.14134143821065, 363.1200057560809, 363.1025643732865]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.0512903966106, -14.59073804268091, -7.058522027673173], :Pressure =&gt; [2.5e6, 2.5389118170050555e6, 2.636003362511477e6, 2.7136136136287297e6], :PhaseMassDensities =&gt; [989.0037034052443 989.022466466399 988.9946839296448 988.9812091718942], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.9910317724947 372.8526857863317 248.56147467781855 248.55808810182188], :TotalThermalEnergy =&gt; [3.7690791468016905e8, 4.845904323959008e8, 3.231274406081997e8, 3.231721555066096e8], :FluidEnthalpy =&gt; [1.302250454635699e6 1.3022504547000644e6 1.3026553730089164e6 1.3029314936692112e6], :Temperature =&gt; [323.4098216130453, 323.40679408065193, 323.5633848950077, 323.66923797840127]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024955143410100456, -0.00594727047443111, 0.002505669162634508], :Pressure =&gt; [3.364869462099922e6, 3.4036747981599066e6, 3.5006848008374646e6, 3.578289307361973e6], :PhaseMassDensities =&gt; [989.2520811916685 989.2693645276338 989.1840696648884 989.1802608437988], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.0638599432149 372.94576416257496 248.60907250458143 248.6081152434331], :TotalThermalEnergy =&gt; [3.7701432829552954e8, 4.8472941125830215e8, 3.2327893654773426e8, 3.2331381237422687e8], :FluidEnthalpy =&gt; [1.3031646190826942e6 1.3031722387799313e6 1.3038894813220792e6 1.3041132396213082e6], :Temperature =&gt; [323.7120405669628, 323.7120342883666, 323.99484680018344, 324.07929215854733]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.051290396910936, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 9), :SurfaceTemperature =&gt; [363.1499999862299, 323.4098216130453, 323.7120405669628]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.4088889351399685e6, 3.413337077131481e6, 3.4492082312832633e6, 3.501545778281749e6, 3.532247421672826e6, 3.5594446700883834e6, 3.5873056170454547e6, 3.597411732412804e6, 3.598726252548641e6, 3.601243011330448e6  …  3.3141427664833968e6, 3.332121275779623e6, 3.3534821200267957e6, 3.388686240611268e6, 3.286361964487376e6, 3.2877949034611047e6, 3.290050329123971e6, 3.2959034925115053e6, 3.30731579798012e6, 3.310096624532696e6], :TotalMasses =&gt; [455961.25039671606 1.4185681325008846e6 … 557161.307154553 101304.25955936001], :TotalThermalEnergy =&gt; [1.6643984004177202e12, 5.17774455672579e12, 7.396620098959396e12, 7.581555320881677e12, 8.136308444182244e12, 8.136397149260631e12, 8.13679275924883e12, 7.396712512821322e12, 6.47210450128816e12, 4.992877169262044e12  …  5.923989372573218e12, 5.923990449074346e12, 4.628053684914502e12, 1.480958439910619e12, 9.255872013670206e11, 5.183351967532018e12, 4.813161505977045e12, 3.14706991323591e12, 2.0362543534156226e12, 3.701866230804293e11], :FluidEnthalpy =&gt; [1.3019352930564329e6 1.30186329094985e6 … 1.3028737414990165e6 1.3027640221614526e6], :Temperature =&gt; [323.21119438458686, 323.1817471309003, 323.1741449030242, 323.1765056051603, 323.1775355744251, 323.1825704063939, 323.20266163698915, 323.18287465536105, 323.1817406599228, 323.1906556935845  …  323.62194989667256, 323.6224707147731, 323.61749197467907, 323.6133156093483, 323.60566086170854, 323.6106011421542, 323.61472124598663, 323.6152194022473, 323.5988293092324, 323.55418881448287]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.955178750872594, 13.884772226681587, 7.3019580690517785], :Pressure =&gt; [4.045025107604588e6, 4.083079687311462e6, 4.1780255569809335e6, 4.2539345421507545e6], :PhaseMassDensities =&gt; [967.1927013564007 967.2160573076703 967.2741788501146 967.3207679040298], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.59571195078064 364.6318632086235 243.1025163426096 243.114225448971], :TotalThermalEnergy =&gt; [3.9276149786215794e8, 5.0497678308159125e8, 3.366474076306551e8, 3.366443223905923e8], :FluidEnthalpy =&gt; [1.3891167763458595e6 1.389116308713127e6 1.3891154442286254e6 1.3891143232257923e6], :Temperature =&gt; [363.1499999882837, 363.1414966949208, 363.12041624119803, 363.1033383690029]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.05159724853573, -14.5905629121934, -7.058270785483862], :Pressure =&gt; [2.5e6, 2.538911792211296e6, 2.6360032991496106e6, 2.713613571397769e6], :PhaseMassDensities =&gt; [989.003004214726 989.0217673443706 988.9946464295034 988.981820140688], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.9908267591271 372.8524222235363 248.56146525300505 248.5582416550278], :TotalThermalEnergy =&gt; [3.7690874834923136e8, 4.8459150432686055e8, 3.2312747889212626e8, 3.231715315602139e8], :FluidEnthalpy =&gt; [1.3022542500930442e6 1.3022542501598725e6 1.3026555763601714e6 1.3029281784449324e6], :Temperature =&gt; [323.4113604565658, 323.40833275206256, 323.5634673671381, 323.66789324727813]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.02495513323840787, -0.005685614676280583, 0.002799696052861716], :Pressure =&gt; [3.3649069273997243e6, 3.4037082528881906e6, 3.5007078449314483e6, 3.5783044384204e6], :PhaseMassDensities =&gt; [989.1500368275942 989.1669269130753 989.0741902302435 989.0884132113474], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.03393897292676 372.90714609169316 248.58145679060854 248.5850314156444], :TotalThermalEnergy =&gt; [3.771361228705802e8, 4.8488662934783274e8, 3.233911948038998e8, 3.234076377922702e8], :FluidEnthalpy =&gt; [1.303719028373096e6 1.3037288296142172e6 1.3044859533544695e6 1.304611793961558e6], :Temperature =&gt; [323.9366729371887, 323.93752847581686, 324.236710542286, 324.2814611122058]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.051597248847568, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 10), :SurfaceTemperature =&gt; [363.1499999882837, 323.4113604565658, 323.9366729371887]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ⋮</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.7992585565021555e6, 2.76308649189173e6, 2.716919447590815e6, 2.659340767544973e6, 2.625467418058126e6, 2.596440235019524e6, 2.5670704835667266e6, 2.55703553889966e6, 2.5543730434769467e6, 2.556481566357405e6  …  3.283420474790735e6, 3.256828974724183e6, 3.2195509064824525e6, 3.162970463222463e6, 3.3153203242926155e6, 3.315986593741234e6, 3.3158567864149446e6, 3.307926559424483e6, 3.280450653119744e6, 3.2412465848215967e6], :TotalMasses =&gt; [455784.0839228315 1.417942639476986e6 … 557324.9731076885 101343.2686857071], :TotalThermalEnergy =&gt; [1.6654977782103125e12, 5.182141093953227e12, 7.403677487258668e12, 7.591831249641641e12, 8.154097385545583e12, 8.166855002973314e12, 8.183250906097197e12, 7.427918212816936e12, 6.478957316831066e12, 4.994817389374635e12  …  5.890027548989589e12, 5.885726795739134e12, 4.604537210169104e12, 1.4735528492682976e12, 9.251026046385721e11, 5.180429384488322e12, 4.808659077299914e12, 3.1432743049951104e12, 2.0328616490721252e12, 3.6934804910993646e11], :FluidEnthalpy =&gt; [1.3024305080141865e6 1.3025339440976921e6 … 1.3012217376131983e6 1.3005091174640988e6], :Temperature =&gt; [323.45937638188263, 323.5041383817886, 323.5363736902667, 323.69616315905176, 324.0274448293814, 324.6542505229034, 325.4625451775273, 324.84343099226464, 323.5779150131906, 323.31928909636105  …  321.3382919158791, 321.04953879073406, 321.58985960239335, 321.61542380470746, 323.39727642693623, 323.3861062873011, 323.2417795149209, 323.13388068458187, 322.9329005281198, 322.6482582476757]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-24.955178976816413, -13.87920817237252, -7.314736073551647], :Pressure =&gt; [1.9024808057494513e6, 1.9409623125624168e6, 2.0369803989023736e6, 2.1137477999766795e6], :PhaseMassDensities =&gt; [978.0770585996638 978.0977647057705 978.2490434794333 978.2193623781225], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.78717218119897 368.73417025106966 245.8608006700984 245.85334099571213], :TotalThermalEnergy =&gt; [3.864655273246584e8, 4.968802643346253e8, 3.311886535149139e8, 3.312248322401911e8], :FluidEnthalpy =&gt; [1.3495142090511704e6 1.349514175886786e6 1.3491398450806038e6 1.3494064130321217e6], :Temperature =&gt; [344.06140679759255, 344.05572317271947, 343.8670665057518, 343.98005044293865]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [25.14058335728, 14.607252997380256, 7.05477792755684], :Pressure =&gt; [4.5e6, 4.539422069436153e6, 4.637781350410203e6, 4.7164053699306045e6], :PhaseMassDensities =&gt; [1001.7883063999748 1001.8069754961846 1001.853545600969 1001.8907480672026], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.73967315824336 377.6723321440589 251.7932591066313 251.8026091062005], :TotalThermalEnergy =&gt; [3.470734884806267e8, 4.46230809493486e8, 2.974763530470574e8, 2.974676530997514e8], :FluidEnthalpy =&gt; [1.186060274559672e6 1.186060225152023e6 1.1860601657574105e6 1.1860600496427473e6], :Temperature =&gt; [283.15, 283.1514048186964, 283.1549090043439, 283.15762017459883]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024955337807846693, -0.017879060025567644, -0.012591257820633153], :Pressure =&gt; [2.706897585685983e6, 2.7457962218389795e6, 2.8430522914916133e6, 2.9208667676992686e6], :PhaseMassDensities =&gt; [991.6268840786754 991.6515348049115 991.8202294925022 991.8968054746265], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.7601885182124 373.8438211996985 249.27161173243104 249.29085737586166], :TotalThermalEnergy =&gt; [3.735990648593968e8, 4.803242661445777e8, 3.2005554603150165e8, 3.1999870209736025e8], :FluidEnthalpy =&gt; [1.2876342204682727e6 1.2875949250371617e6 1.286829578296445e6 1.2865806606784032e6], :Temperature =&gt; [317.59574643116287, 317.57815724665085, 317.27562764693084, 317.17461455369147]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [-24.95517875, 25.14058335728, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; InjectorControl{BottomHolePressureTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(BottomHolePressureTarget with value 45.0 [bar], [1.0], 998.20715, ((1, 1.0),), 283.15, missing, 1.0, missing), :WellA =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -0.025 [m^3/s], 1.0)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; InjectorControl{BottomHolePressureTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(BottomHolePressureTarget with value 45.0 [bar], [1.0], 998.20715, ((1, 1.0),), 283.15, missing, 1.0, missing), :WellA =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -0.025 [m^3/s], 1.0)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = 1.0e-20, bhp = 4.5e6), :WellA =&gt; (bhp = 10000.0, rate = -0.025)), 232), :SurfaceTemperature =&gt; [344.06140679759255, 283.15, 317.59574643116287]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.8587516538023977e6, 2.8440678061231063e6, 2.840913173127648e6, 2.8406926263344577e6, 2.840377164937559e6, 2.840337849710841e6, 2.8402820760169197e6, 2.840556344581733e6, 2.8399260808946895e6, 2.842248688727974e6  …  3.013053364451592e6, 3.0129353294964167e6, 3.0104864714734545e6, 3.0077677870203615e6, 3.009242574386164e6, 3.0103588386555305e6, 3.011629238789374e6, 3.011972670558825e6, 3.007731590783876e6, 2.9934661305215764e6], :TotalMasses =&gt; [455795.21508312295 1.4179897084883545e6 … 557263.8199729184 101333.33414835345], :TotalThermalEnergy =&gt; [1.6655134118226235e12, 5.182208715629569e12, 7.403824607306275e12, 7.592051255709831e12, 8.154393371872917e12, 8.167209631513289e12, 8.183659764246043e12, 7.428278606912703e12, 6.479263800393943e12, 4.995034810379177e12  …  5.889705274390049e12, 5.885380094348805e12, 4.604327808911454e12, 1.4735003417970598e12, 9.250603809452765e11, 5.180191373327487e12, 4.808427375581602e12, 3.1431077458129375e12, 2.0327518200360957e12, 3.6932657748876074e11], :FluidEnthalpy =&gt; [1.3024549799637932e6 1.3025675393892229e6 … 1.301099092736679e6 1.300389097837069e6], :Temperature =&gt; [323.4646197603245, 323.5113821625735, 323.54741921085923, 323.7122685278005, 324.0472747927404, 324.6776535589521, 325.48918362122123, 324.8698223380149, 323.60396580867115, 323.343877553326  …  321.3094953213406, 321.01976388500174, 321.5663639716605, 321.59724086411376, 323.3713628120718, 323.36008156643436, 323.21487209422287, 323.1052487517139, 322.90441620459615, 322.618741111283]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-1.212220578645882e-7, -0.004113371033918791, -0.003323307182894007], :Pressure =&gt; [2.7991776112822895e6, 2.837556722054663e6, 2.933522549124523e6, 3.0103031150494437e6], :PhaseMassDensities =&gt; [978.3292127810896 978.441217354424 978.7169690470528 978.6427217966407], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.8611076487666 368.8636488492136 245.9784031921512 245.9597428228357], :TotalThermalEnergy =&gt; [3.865499934867953e8, 4.9690856398272914e8, 3.311339188806878e8, 3.311964684555998e8], :FluidEnthalpy =&gt; [1.3503773948480482e6 1.35003354008612e6 1.349188340134874e6 1.3496234641406755e6], :Temperature =&gt; [344.33124268339475, 344.16533766005125, 343.75800568390895, 343.94898457908056]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [3.393095221720636e-7, 0.0010496725924597577, 0.0007989812229312627], :Pressure =&gt; [2.7979591136176363e6, 2.8372255836153245e6, 2.9353929673394994e6, 3.013930174930427e6], :PhaseMassDensities =&gt; [1001.0275192565458 1001.0052848834832 1001.0521633797342 1001.0894287862783], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.5165987168408 377.37010190334115 251.59184978671541 251.60121560490995], :TotalThermalEnergy =&gt; [3.4680928762288135e8, 4.46438554528717e8, 2.9761273893247557e8, 2.976044862433064e8], :FluidEnthalpy =&gt; [1.1843612715723794e6 1.1858601439743852e6 1.1858511470221584e6 1.1858526549549922e6], :Temperature =&gt; [282.5798344724918, 283.0279648228576, 283.0291579366466, 283.0327069193396]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-1.2579438172910252e-8, 0.0015066004594271058, 0.0011651562066747612], :Pressure =&gt; [2.7980501909417016e6, 2.8369486112497007e6, 2.9342026565508465e6, 3.0120184904532535e6], :PhaseMassDensities =&gt; [991.6550885125703 991.6124038519915 991.8181268324099 991.9335558992077], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.7684584901625 373.82906917799187 249.27108327631112 249.30009376497213], :TotalThermalEnergy =&gt; [3.7360971771449614e8, 4.8046194574925673e8, 3.2010194536250544e8, 3.199972855412942e8], :FluidEnthalpy =&gt; [1.2877261544289072e6 1.288105955050462e6 1.2871103487268905e6 1.2866192046307547e6], :Temperature =&gt; [317.625920010766, 317.7709463863632, 317.37899808843065, 317.1841630810439]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 233), :SurfaceTemperature =&gt; [344.33124268339475, 282.5798344724918, 317.625920010766]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.8580018779778397e6, 2.843380820740428e6, 2.8403496025506975e6, 2.840280754181527e6, 2.840045668820547e6, 2.8400882722219066e6, 2.8401170993951005e6, 2.8404323553022724e6, 2.8398470047435146e6, 2.8422317205260294e6  …  3.0112275650639003e6, 3.011243859218799e6, 3.0089083555279225e6, 3.0063640742672505e6, 3.007197939111986e6, 3.0083165176699124e6, 3.0096123517739237e6, 3.009998199067308e6, 3.0058810429426846e6, 2.9917522210544324e6], :TotalMasses =&gt; [455795.021195079 1.4179890164860075e6 … 557264.8436799434 101333.68357635233], :TotalThermalEnergy =&gt; [1.6655142824721538e12, 5.182213971480164e12, 7.403836022163631e12, 7.592068429887444e12, 8.154431415450444e12, 8.16727233488802e12, 8.183739144072529e12, 7.428327367289348e12, 6.479296792161205e12, 4.995042147109446e12  …  5.889614898853912e12, 5.885238818715723e12, 4.604257467787158e12, 1.473481301988504e12, 9.250594625447676e11, 5.180184314963652e12, 4.808408739435202e12, 3.1430765780683525e12, 2.0327223864341553e12, 3.693180891022975e11], :FluidEnthalpy =&gt; [1.3024553034961298e6 1.302568363291617e6 … 1.3010843455045004e6 1.3003660017762994e6], :Temperature =&gt; [323.46480971344056, 323.511770082999, 323.5480210668369, 323.713162613959, 324.0491341260971, 324.6807391952831, 325.493097860467, 324.87246464559064, 323.6059986312957, 323.3444635004327  …  321.3033915023176, 321.01025654635566, 321.5602878110014, 321.59209922067095, 323.3709149605548, 323.3594861667922, 323.21327474749836, 323.1012440261679, 322.89859883639963, 322.60954803098906]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [3.6451106583885513e-11, -0.004134013016908129, -0.0033368584099679986], :Pressure =&gt; [2.7988665371234384e6, 2.8372453908831985e6, 2.933211724175489e6, 3.009992754163269e6], :PhaseMassDensities =&gt; [978.3291329093563 978.4478378091616 978.7206726145137 978.6508485134748], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.86108422915123 368.86614470184963 245.9793340001774 245.961785289548], :TotalThermalEnergy =&gt; [3.865499590374845e8, 4.9690262741007125e8, 3.3113166171128273e8, 3.311916129471593e8], :FluidEnthalpy =&gt; [1.3503770670388613e6 1.350007993077674e6 1.3491737408451184e6 1.349592198829971e6], :Temperature =&gt; [344.33113615777376, 344.15348670201297, 343.75126734663286, 343.93449200561565]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [3.306257389820837e-10, 0.0010228694828914938, 0.0007874970454087701], :Pressure =&gt; [2.796289149783393e6, 2.835555551439176e6, 2.9337226652139216e6, 3.012259654097953e6], :PhaseMassDensities =&gt; [1001.0267701775848 1001.0025495746586 1001.0493935889804 1001.0866233113942], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.5163790754178 377.3690707162081 251.59115366237268 251.6005105121671], :TotalThermalEnergy =&gt; [3.468090277301295e8, 4.4646479694946843e8, 2.9763050889917666e8, 2.976225474568852e8], :FluidEnthalpy =&gt; [1.184359604146088e6 1.1859312565250897e6 1.1859233899193185e6 1.1859260947980369e6], :Temperature =&gt; [282.5792695765186, 283.04909257945184, 283.0506156404698, 283.0545157155385]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [9.319997292814422e-11, 0.0015264187842431657, 0.0011855065738650065], :Pressure =&gt; [2.797360898767204e6, 2.8362592953422633e6, 2.9335132459929124e6, 3.011329074604545e6], :PhaseMassDensities =&gt; [991.6548759224513 991.6114063991405 991.8171938905048 991.9343538993627], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.76839615548397 373.828693147126 249.2708488024363 249.30029432428609], :TotalThermalEnergy =&gt; [3.7360963614624786e8, 4.804632852149947e8, 3.201027615430713e8, 3.1999597098578113e8], :FluidEnthalpy =&gt; [1.2877254548711951e6 1.2881101386976494e6 1.2871141386066524e6 1.2866122015580784e6], :Temperature =&gt; [317.62569017997845, 317.772612026271, 317.380507660953, 317.18149260120657]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 234), :SurfaceTemperature =&gt; [344.33113615777376, 282.5792695765186, 317.62569017997845]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.8569933066025367e6, 2.8423718536025095e6, 2.8393398412158815e6, 2.8392700018453626e6, 2.839034249964903e6, 2.839076122931263e6, 2.839104180907168e6, 2.839419692057145e6, 2.8388347243303857e6, 2.841219890143105e6  …  3.0102273077901923e6, 3.010242865839157e6, 3.007904779057641e6, 3.005356706110605e6, 3.006197440395418e6, 3.0073160233644485e6, 3.008611974843647e6, 3.00899799928676e6, 3.00488071912016e6, 2.990751356297018e6], :TotalMasses =&gt; [455794.7787569772 1.4179881362074919e6 … 557266.058726431 101334.05849075294], :TotalThermalEnergy =&gt; [1.665515087689061e12, 5.182218980945277e12, 7.4038469747419375e12, 7.592085116229889e12, 8.154469000601759e12, 8.167333966133172e12, 8.183817014089326e12, 7.428375037594516e12, 6.479328862809834e12, 4.995048754102181e12  …  5.8895251417382705e12, 5.885098835350759e12, 4.604187552393168e12, 1.473461647081329e12, 9.250586878849738e11, 5.180178022538621e12, 4.808390829553289e12, 3.1430458736424033e12, 2.0326932854993945e12, 3.6930972482367255e11], :FluidEnthalpy =&gt; [1.3024555220960903e6 1.3025690578898645e6 … 1.301069974884552e6 1.300343416424088e6], :Temperature =&gt; [323.4649774758129, 323.51213093647357, 323.5485868011164, 323.7140160896114, 324.05095419852705, 324.6837534938131, 325.49691757993423, 324.8750264126019, 323.60795131540476, 323.34496604465386  …  321.29735121192505, 321.0008544595796, 321.55426344458243, 321.58680320052304, 323.37055545019086, 323.35897605230826, 323.2117634009603, 323.0973228543596, 322.89286845239315, 322.60050719478824]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.2191909402552758e-10, -0.004132848566152821, -0.0033378953630474944], :Pressure =&gt; [2.7978515884978194e6, 2.8362304993708106e6, 2.9321969118359014e6, 3.008978039418123e6], :PhaseMassDensities =&gt; [978.3288630078798 978.4510196766431 978.719105424326 978.6549036667724], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.861005089905 368.86734423763016 245.97894012232297 245.9628044607327], :TotalThermalEnergy =&gt; [3.865498529903179e8, 4.968994556160501e8, 3.311323353099453e8, 3.31188978630726e8], :FluidEnthalpy =&gt; [1.350376032468744e6 1.3499939669458405e6 1.34917760279428e6 1.3495748595922193e6], :Temperature =&gt; [344.3308048988631, 344.14710541711725, 343.7532107646632, 343.92657913089084]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.9880002259641627e-10, 0.001049446052450234, 0.000806151877954726], :Pressure =&gt; [2.795298581454373e6, 2.834564955583017e6, 2.932731977622252e6, 3.0112688940085727e6], :PhaseMassDensities =&gt; [1001.0263258543152 1001.0015903468426 1001.0484816343055 1001.085686840759], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.5162487930306 377.3687090958409 251.5909244631641 251.60027515142568], :TotalThermalEnergy =&gt; [3.468088734909662e8, 4.464714946014082e8, 2.9763454530095017e8, 2.976267959106585e8], :FluidEnthalpy =&gt; [1.1843586148047077e6 1.185949151657446e6 1.185939524156019e6 1.18594310022081e6], :Temperature =&gt; [282.5789344134182, 283.0543869815341, 283.05538367370735, 283.05954203601704]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.3947215602048377e-10, 0.0014963350043385513, 0.0011658641320338625], :Pressure =&gt; [2.796343180251756e6, 2.835241585573934e6, 2.932495600474286e6, 3.010311483394324e6], :PhaseMassDensities =&gt; [991.6545621823628 991.612166117424 991.8177445946354 991.9351877354069], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.7683041620853 373.8289795541714 249.27098720948038 249.30050389014136], :TotalThermalEnergy =&gt; [3.736095155095863e8, 4.804611543029321e8, 3.2010159500939703e8, 3.199944544019245e8], :FluidEnthalpy =&gt; [1.2877244211097066e6 1.2881024252682924e6 1.2871077181179693e6 1.2866040107908044e6], :Temperature =&gt; [317.6253504972575, 317.76968000533816, 317.3780804141516, 317.17838168957076]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 235), :SurfaceTemperature =&gt; [344.3308048988631, 282.5789344134182, 317.6253504972575]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.856103604692896e6, 2.8414822036004867e6, 2.838450303513087e6, 2.838380614479684e6, 2.8381449429510464e6, 2.838186843285837e6, 2.838214896853989e6, 2.83853042214277e6, 2.83794543410555e6, 2.840330570385385e6  …  3.0093377316057505e6, 3.009353382613034e6, 3.007015315980893e6, 3.004467311758178e6, 3.0053076042700275e6, 3.006426200006051e6, 3.007722184313435e6, 3.008108283921533e6, 3.0039911189442435e6, 2.9898618520721854e6], :TotalMasses =&gt; [455794.5590267375 1.4179873263189653e6 … 557267.2949711174 101334.43367993784], :TotalThermalEnergy =&gt; [1.6655159148328184e12, 5.182224069345957e12, 7.403858034024363e12, 7.592101988316326e12, 8.15450673790987e12, 8.167395716240986e12, 8.183894842290796e12, 7.428422710482786e12, 6.479360997511326e12, 4.9950554468807705e12  …  5.889435564102957e12, 5.884959827423073e12, 4.604117813290339e12, 1.4734420701856914e12, 9.250579306509258e11, 5.180171823500057e12, 4.808373026360291e12, 3.1430152600351255e12, 2.032664301887114e12, 3.693014537532869e11], :FluidEnthalpy =&gt; [1.3024557840796532e6 1.3025697980459593e6 … 1.3010556890632834e6 1.3003211075742352e6], :Temperature =&gt; [323.4651534823049, 323.5125008678632, 323.5491613063817, 323.71488237285763, 324.0527847579441, 324.6867766487574, 325.50073817926574, 324.87759130560664, 323.6099110332681, 323.34547853483446  …  321.2913259418409, 320.9915208041358, 321.5482572653541, 321.58153124853413, 323.3702062481134, 323.3584759236746, 323.2102637077856, 323.0934160272536, 322.88716393284017, 322.591569781948]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [9.627980119712752e-11, -0.0041329288464786364, -0.0033378649341634747], :Pressure =&gt; [2.796962371412278e6, 2.8353413393542822e6, 2.931307832957504e6, 3.0080890571743664e6], :PhaseMassDensities =&gt; [978.3286280312534 978.4541643626413 978.7176154949145 978.6588570932277], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.8609361911596 368.8685297563218 245.9785656622195 245.9637980651734], :TotalThermalEnergy =&gt; [3.865497590641823e8, 4.9689636263692725e8, 3.3113299427582604e8, 3.3118643487447554e8], :FluidEnthalpy =&gt; [1.3503751204624183e6 1.3499803343715558e6 1.3491814272298326e6 1.3495581574374181e6], :Temperature =&gt; [344.33051206596843, 344.14088893610494, 343.7551183323695, 343.91894421633293]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.7682766526738098e-10, 0.0010499705249777946, 0.0008065340886401272], :Pressure =&gt; [2.7944093431193377e6, 2.833675692650039e6, 2.931842633262007e6, 3.010379485605282e6], :PhaseMassDensities =&gt; [1001.0259269779126 1001.0007350752298 1001.0476762450187 1001.0848595806202], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.51613183636084 377.36838666603904 251.59072204675877 251.6000672382757], :TotalThermalEnergy =&gt; [3.468087350724756e8, 4.464774292743361e8, 2.976380507450776e8, 2.9763049067146057e8], :FluidEnthalpy =&gt; [1.184357726818935e6 1.1859650030489815e6 1.1859535230073978e6 1.1859578768514206e6], :Temperature =&gt; [282.5786335793243, 283.05907633370174, 283.05951953716533, 283.06390852905696]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.2501250663108543e-10, 0.001497766711137897, 0.001166965546022734], :Pressure =&gt; [2.7954541736944495e6, 2.834352590415247e6, 2.931606661270907e6, 3.0094225841887305e6], :PhaseMassDensities =&gt; [991.6542872353024 991.6130222324135 991.8180296458743 991.9359223405863], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.7682235433966 373.8293023019188 249.2710588506706 249.30068851656014], :TotalThermalEnergy =&gt; [3.7360941139974463e8, 4.8045893862334085e8, 3.201008170998886e8, 3.1999312193832797e8], :FluidEnthalpy =&gt; [1.2877235236061169e6 1.2880944896810919e6 1.2871033311898115e6 1.2865968170303889e6], :Temperature =&gt; [317.62505591412673, 317.7666539629135, 317.37643348112135, 317.1756491789602]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 236), :SurfaceTemperature =&gt; [344.33051206596843, 282.5786335793243, 317.62505591412673]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.855191061150381e6, 2.840569662277756e6, 2.837537748637212e6, 2.8374680413407898e6, 2.8372323645063196e6, 2.8372742517794846e6, 2.8373022775215073e6, 2.8376178214759133e6, 2.8370328453426454e6, 2.8394179717924823e6  …  3.0084253078000573e6, 3.008440972354369e6, 3.006102859737171e6, 3.003554810678496e6, 3.0043950675466405e6, 3.0055136736148964e6, 3.0068096747938795e6, 3.00719582093284e6, 3.0030786946424614e6, 2.9889494261347624e6], :TotalMasses =&gt; [455794.3353228489 1.41798650340243e6 … 557268.5231463936 101334.80410595481], :TotalThermalEnergy =&gt; [1.665516729996792e12, 5.182229133099855e12, 7.403869054998277e12, 7.592118898466572e12, 8.154544484084987e12, 8.167457462536038e12, 8.183972517498773e12, 7.428470267317859e12, 6.479393086969582e12, 4.995062125285338e12  …  5.889345976078249e12, 5.88482155272702e12, 4.604048099290439e12, 1.4734225239254546e12, 9.25057172047175e11, 5.180165611057e12, 4.808355220444129e12, 3.1429846485463076e12, 2.03263536763908e12, 3.69293257258635e11], :FluidEnthalpy =&gt; [1.3024560331273016e6 1.3025705276487265e6 … 1.3010414212465095e6 1.3002989916400034e6], :Temperature =&gt; [323.46532604265445, 323.5128683260499, 323.54973316919086, 323.7157500850157, 324.05461518605165, 324.68979906710547, 325.5045507009105, 324.88014935291466, 323.6118673861123, 323.34598929050674  …  321.285299402276, 320.98223573291233, 321.54225266660814, 321.57626692471524, 323.36985588260796, 323.3579741894212, 323.20876321406854, 323.08950890484226, 322.88146854027957, 322.5827122434639]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.1337194934445785e-10, -0.004132965311927909, -0.003338057239732218], :Pressure =&gt; [2.796049529350383e6, 2.834428553757122e6, 2.930395133096453e6, 3.0071764553912845e6], :PhaseMassDensities =&gt; [978.3283842587653 978.4572870354419 978.716241351952 978.6627315280123], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.8608647133329 368.8697069762334 245.9782203024246 245.9647718168419], :TotalThermalEnergy =&gt; [3.865496643863198e8, 4.968932801790728e8, 3.311335792440619e8, 3.311839316276481e8], :FluidEnthalpy =&gt; [1.3503741938276333e6 1.349966736633513e6 1.3491847670977344e6 1.349541704905823e6], :Temperature =&gt; [344.3302159280918, 344.1346923305019, 343.75680422132757, 343.9114290790452]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.8369441533005448e-10, 0.0010505154330900154, 0.000806905676468718], :Pressure =&gt; [2.793496766673598e6, 2.8327630911817024e6, 2.9309299492146913e6, 3.009466736629931e6], :PhaseMassDensities =&gt; [1001.0255176338035 1000.9998686221177 1001.0468585532602 1001.0840220666478], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.5160118103992 377.36806002091123 251.59051653840507 251.59985674805625], :TotalThermalEnergy =&gt; [3.468085930024625e8, 4.464833692079609e8, 2.976415696601436e8, 2.9763418068614215e8], :FluidEnthalpy =&gt; [1.1843568154624274e6 1.185980858340673e6 1.185967566684206e6 1.185972623474989e6], :Temperature =&gt; [282.578324828892, 283.06376599598894, 283.063667891821, 283.0682652239755]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.2790435375358e-10, 0.0014993021818411202, 0.0011679899580819507], :Pressure =&gt; [2.7945413763345606e6, 2.8334398040577173e6, 2.9306939293644824e6, 3.0085098908746517e6], :PhaseMassDensities =&gt; [991.6540061179846 991.6138643139425 991.8182980527872 991.9366377613055], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.76814111549385 373.8296197591762 249.27112630868547 249.30086832139818], :TotalThermalEnergy =&gt; [3.7360930280321497e8, 4.804567316179161e8, 3.2010004822466266e8, 3.1999180164565647e8], :FluidEnthalpy =&gt; [1.287722594692983e6 1.2880865715479048e6 1.2870989781176134e6 1.2865896729964968e6], :Temperature =&gt; [317.62475057921006, 317.7636361575515, 317.37480108544315, 317.17293733498565]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 237), :SurfaceTemperature =&gt; [344.3302159280918, 282.578324828892, 317.62475057921006]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.854279210053489e6, 2.8396578240518947e6, 2.8366259243493364e6, 2.83655623574636e6, 2.8363205723510627e6, 2.8363624549511718e6, 2.8363904565830245e6, 2.836706016549855e6, 2.8361210429092464e6, 2.838506147008124e6  …  3.00751358095097e6, 3.007529271773586e6, 3.005191126913536e6, 3.0026430577479266e6, 3.0034832081619664e6, 3.004601824592024e6, 3.005897844488503e6, 3.006284040727998e6, 3.0021669636450023e6, 2.988037709016974e6], :TotalMasses =&gt; [455794.11208325636 1.4179856813178493e6 … 557269.7485489135 101335.17088697065], :TotalThermalEnergy =&gt; [1.665517538673997e12, 5.182234189000024e12, 7.403880062200164e12, 7.592135869435008e12, 8.154582261774211e12, 8.167519223236588e12, 8.184050055887788e12, 7.428517729562604e12, 6.4794251497191e12, 4.995068806137667e12  …  5.88925641402936e12, 5.884684039865736e12, 4.603978438579907e12, 1.4734030155844287e12, 9.250564152813809e11, 5.180159403618042e12, 4.808337430604211e12, 3.142954054376002e12, 2.032606491878941e12, 3.6928513400261707e11], :FluidEnthalpy =&gt; [1.3024562785104928e6 1.302571255933145e6 … 1.301027181818064e6 1.300277071020009e6], :Temperature =&gt; [323.4654970651999, 323.5132351972481, 323.5503043084677, 323.71662102120365, 324.05644718769963, 324.69282223160036, 325.5083565128351, 324.8827023001726, 323.6138221192525, 323.34650026248676  …  321.27927465892986, 320.9730017971368, 321.53625269539657, 321.57101281382467, 323.3695063270312, 323.3574728575038, 323.2072640721681, 323.0856040111308, 322.87578466446985, 322.57393374538606]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.005533720319403e-10, -0.004133021157042996, -0.0033382202729939463], :Pressure =&gt; [2.795137545853923e6, 2.833516626573555e6, 2.929483297367619e6, 3.006264720109841e6], :PhaseMassDensities =&gt; [978.3281421936392 978.460400259089 978.7149932854845 978.6665402897199], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.86079373613086 368.870880633898 245.977906629109 245.9657290630659], :TotalThermalEnergy =&gt; [3.865495687892484e8, 4.9689020620288485e8, 3.311340901739536e8, 3.3118146707918835e8], :FluidEnthalpy =&gt; [1.3503732625089488e6 1.3499531758898844e6 1.3491876330617818e6 1.3495255012816633e6], :Temperature =&gt; [344.3299174785641, 344.1285129776848, 343.7582697875787, 343.9040297696642]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.795741327197725e-10, 0.0010510539176836154, 0.0008072779898684298], :Pressure =&gt; [2.792584969550801e6, 2.831851269004716e6, 2.9300180441910545e6, 3.0085547664841185e6], :PhaseMassDensities =&gt; [1001.0251086408834 1000.9990002069428 1001.0460373643248 1001.0831831003516], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.5158918874116 377.3677326361032 251.59031015111492 251.59964589282805], :TotalThermalEnergy =&gt; [3.4680845102670443e8, 4.46489340335793e8, 2.976451229864984e8, 2.9763788689419436e8], :FluidEnthalpy =&gt; [1.1843559047893167e6 1.1859967994256287e6 1.185981752080516e6 1.1859874369834515e6], :Temperature =&gt; [282.5780163124272, 283.0684813261113, 283.0678585577489, 283.0726419322977]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.2790435375358e-10, 0.0015007706732481437, 0.0011689972784580329], :Pressure =&gt; [2.7936294705232074e6, 2.832527909107155e6, 2.929782088698395e6, 3.0075980887110117e6], :PhaseMassDensities =&gt; [991.6537238440405 991.6147003341093 991.8185691229925 991.9373482270236], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.7680583484506 373.82993493135393 249.27119443605872 249.30104688090864], :TotalThermalEnergy =&gt; [3.73609196363438e8, 4.804545363853049e8, 3.200992764991072e8, 3.1999048787247163e8], :FluidEnthalpy =&gt; [1.2877216755977569e6 1.288078693693075e6 1.2870946110555248e6 1.2865825624491984e6], :Temperature =&gt; [317.624448998715, 317.7606339493288, 317.3731632179551, 317.1702384155138]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 238), :SurfaceTemperature =&gt; [344.3299174785641, 282.5780163124272, 317.624448998715]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.853367180014842e6, 2.838745804612041e6, 2.835713913587388e6, 2.8356442370768692e6, 2.8354085839366107e6, 2.83545046040821e6, 2.8354784375717836e6, 2.835794014369635e6, 2.8352090448688674e6, 2.837594129078077e6  …  3.006601687987927e6, 3.0066174040385606e6, 3.004279224050326e6, 3.001731128961551e6, 3.002571183428999e6, 3.00368981030024e6, 3.0049858490396193e6, 3.0053720952264452e6, 3.001255066743718e6, 2.9871258246049886e6], :TotalMasses =&gt; [455793.8891480589 1.4179848595559634e6 … 557270.9711249999 101335.53417723614], :TotalThermalEnergy =&gt; [1.6655183405730088e12, 5.1822392362138125e12, 7.403891055348158e12, 7.59215289917741e12, 8.154620069804461e12, 8.1675809970995205e12, 8.184127456543631e12, 7.428565098831678e12, 6.479457186091326e12, 4.995075489164492e12  …  5.8891668778015e12, 5.884547274045912e12, 4.603908830697246e12, 1.4733835439876086e12, 9.250556601527183e11, 5.1801532001628955e12, 4.808319655534757e12, 3.1429234761989956e12, 2.0325776714869023e12, 3.6927708013423956e11], :FluidEnthalpy =&gt; [1.302456519833852e6 1.3025719825144382e6 … 1.3010129690479173e6 1.3002553352224487e6], :Temperature =&gt; [323.46566645816523, 323.5136013950929, 323.55087468602727, 323.7174950498575, 324.05828068109554, 324.6958460569009, 325.512155546279, 324.8852502109934, 323.61577522856635, 323.34701140455894  …  321.27325167832043, 320.9638179807702, 321.530257288328, 321.5657685761862, 323.3691574734837, 323.356971828057, 323.205766152353, 323.0817011563952, 322.8701116716333, 322.5652301121841]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.0909873522805803e-10, -0.004133095662213795, -0.003338404230933553], :Pressure =&gt; [2.7942253513116525e6, 2.832604488188835e6, 2.928571255967209e6, 3.0053527814628645e6], :PhaseMassDensities =&gt; [978.3279012595699 978.4635044313686 978.7138670423426 978.6702860157965], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.860723090572 368.8720508792775 245.9776235733345 245.96667046670785], :TotalThermalEnergy =&gt; [3.865494723604784e8, 4.968871399661672e8, 3.3113452931132704e8, 3.3117903942197967e8], :FluidEnthalpy =&gt; [1.3503723265135894e6 1.349939648485891e6 1.3491900390193244e6 1.3495095344817576e6], :Temperature =&gt; [344.3296168798568, 344.12234933289585, 343.7595216398764, 343.8967408167025]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.8232114379281458e-10, 0.0010516369003110316, 0.000807676522175667], :Pressure =&gt; [2.79167300275299e6, 2.8309392771011177e6, 2.9291059691256774e6, 3.0076426260624e6], :PhaseMassDensities =&gt; [1001.0246994781653 1000.9981293307874 1001.0452122092664 1001.0823421304555], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.51577191463656 377.36740432352735 251.59010276702938 251.59943453404023], :TotalThermalEnergy =&gt; [3.4680830999035925e8, 4.464953434586159e8, 2.976487109908164e8, 2.976416102931357e8], :FluidEnthalpy =&gt; [1.184354997347409e6 1.186012828069253e6 1.185996079864294e6 1.186002321046778e6], :Temperature =&gt; [282.57770874994657, 283.07322281377196, 283.07209169791855, 283.0770397105157]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.307960357278925e-10, 0.0015022111014121782, 0.001169981373367207], :Pressure =&gt; [2.7927173582396577e6, 2.8316158075786624e6, 2.9288700412477255e6, 3.006686079649327e6], :PhaseMassDensities =&gt; [991.6534426868313 991.6155298466256 991.8188424864104 991.9380535071025], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.76797590885116 373.8302476502052 249.27126313977914 249.3012241371258], :TotalThermalEnergy =&gt; [3.7360908820898324e8, 4.804523529568717e8, 3.200985018506043e8, 3.19989180374853e8], :FluidEnthalpy =&gt; [1.2877207489465852e6 1.2880708556726996e6 1.2870902290854447e6 1.2865754836020719e6], :Temperature =&gt; [317.624144498386, 317.75764723220396, 317.37151958834147, 317.1675517934134]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 239), :SurfaceTemperature =&gt; [344.3296168798568, 282.57770874994657, 317.624144498386]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.85245343422497e6, 2.837832069731815e6, 2.8348001878708974e6, 2.8347305238549956e6, 2.834494881083286e6, 2.8345367513650986e6, 2.834564703907342e6, 2.834880297482464e6, 2.8342953321024976e6, 2.836680396196962e6  …  3.0056880757359336e6, 3.0057038151071547e6, 3.0033655998529703e6, 3.0008174788178434e6, 3.0016574432606027e6, 3.002776080603082e6, 3.0040721379828383e6, 3.0044584331881064e6, 3.000341451009554e6, 2.98621221930673e6], :TotalMasses =&gt; [455793.6662327939 1.4179840372332002e6 … 557272.1906233036 101335.8940820293], :TotalThermalEnergy =&gt; [1.6655191352287478e12, 5.1822442732973125e12, 7.403902033216986e12, 7.5921699846841875e12, 8.154657905576665e12, 8.167642780911542e12, 8.184204716287713e12, 7.428612375117736e12, 6.47948919515049e12, 4.995082173514373e12  …  5.889077368605361e12, 5.884411243271559e12, 4.603839276184553e12, 1.4733641082189053e12, 9.250549063803163e11, 5.180146999264158e12, 4.808301893821788e12, 3.14289291308112e12, 2.032548903900083e12, 3.692690921781221e11], :FluidEnthalpy =&gt; [1.302456756428996e6 1.3025727067251543e6 … 1.3009987813005932e6 1.3002337745870557e6], :Temperature =&gt; [323.4658340714198, 323.51396676980335, 323.55144419746284, 323.7183719746062, 324.0601155012489, 324.6988703478213, 325.5159476084495, 324.8877930483703, 323.6177266183523, 323.3475226103127  …  321.26723049996855, 320.95468343685286, 321.52426645062053, 321.5605339250439, 323.3688091616946, 323.3564709520057, 323.20426929802585, 323.0778001826374, 322.8644490194083, 322.5565975558107]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.0909873522805803e-10, -0.004133183038768401, -0.0033385984458770904], :Pressure =&gt; [2.7933114389976906e6, 2.8316906317771575e6, 2.9276575018340447e6, 3.004439132298645e6], :PhaseMassDensities =&gt; [978.3276567287364 978.4665991855168 978.7128581889704 978.6739708319118], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.8606513903868 368.87321757410507 245.9773700208271 245.96759656200686], :TotalThermalEnergy =&gt; [3.8654937789672315e8, 4.96884081238353e8, 3.311348989002207e8, 3.311766470420761e8], :FluidEnthalpy =&gt; [1.3503714005765726e6 1.3499261527617963e6 1.349191998662804e6 1.3494937934676008e6], :Temperature =&gt; [344.32932122448744, 344.11620084509104, 343.76056635682306, 343.88955729946537]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.8232114379281458e-10, 0.0010521726236676701, 0.0008080465526143908], :Pressure =&gt; [2.790759305045644e6, 2.8300255542118596e6, 2.9281921626905226e6, 3.0067287539807837e6], :PhaseMassDensities =&gt; [1001.0242896368659 1000.9972552519401 1001.0443824234271 1001.0814983955589], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.5156517428911 377.3670748035651 251.58989421910164 251.59922248033203], :TotalThermalEnergy =&gt; [3.4680816765504164e8, 4.465013788366726e8, 2.9765233316109896e8, 2.9764535123115814e8], :FluidEnthalpy =&gt; [1.1843540845529148e6 1.1860289442806318e6 1.18601054722878e6 1.1860172763915125e6], :Temperature =&gt; [282.57739952105504, 283.07799040122126, 283.07636641597367, 283.0814587143551]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.2790443576715116e-10, 0.001503614216475563, 0.0011709406780768777], :Pressure =&gt; [2.7918035281211752e6, 2.8307019880694035e6, 2.92795627556168e6, 3.0057723521947637e6], :PhaseMassDensities =&gt; [991.6531610952148 991.6163523580951 991.8191176583985 991.9387529634994], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.7678933418768 373.83055772972403 249.27133229804284 249.30139992969205], :TotalThermalEnergy =&gt; [3.7360897971520144e8, 4.804501811530633e8, 3.200977241487451e8, 3.1998787921182877e8], :FluidEnthalpy =&gt; [1.2877198199596943e6 1.2880630561229356e6 1.2870858307892594e6 1.2865684359954908e6], :Temperature =&gt; [317.6238391946433, 317.7546755681488, 317.3698697371377, 317.16487737951854]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 240), :SurfaceTemperature =&gt; [344.32932122448744, 282.57739952105504, 317.6238391946433]))</span></span></code></pre></div><p>We calibrate against the first two years. Since we have defined report steps of 1/4 month, this corresponts to the first 12_4_2 steps. To see the effect of more or less data used for calibration, and to exclude data from one or more of the wells and WellObs, you can change num_years_cal and wells_cal below.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">num_years_cal </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_steps </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 12</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">num_years_cal</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells_cal </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:WellA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:WellObs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:WellB</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">objective </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (model, state, dt, step_no, forces) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    well_mismatch_thermal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, wells_cal,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        states_hf, state, dt, step_no, forces;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        scale</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dt[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_steps]),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        w_bhp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        w_temp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">si_unit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Kelvin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        w_energy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">#1 (generic function with 1 method)</span></span></code></pre></div><h3 id="Compute-mismatch-for-initial-proxy-model" tabindex="-1">Compute mismatch for initial proxy model <a class="header-anchor" href="#Compute-mismatch-for-initial-proxy-model" aria-label="Permalink to &quot;Compute mismatch for initial proxy model {#Compute-mismatch-for-initial-proxy-model}&quot;">​</a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obj0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Jutul</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">evaluate_objective</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    objective, proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model, states_proxy[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_steps],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dt[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_steps], proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">forces[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_steps])</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Initial proxy mismatch: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$obj0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Initial proxy mismatch: 16.914477121189023</span></span></code></pre></div><h2 id="Set-up-optimization" tabindex="-1">Set up optimization <a class="header-anchor" href="#Set-up-optimization" aria-label="Permalink to &quot;Set up optimization {#Set-up-optimization}&quot;">​</a></h2><p>We start by declaring the parameters to be optimized and their bounds</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">parameters </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_parameters</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">opt_config </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> optimization_config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model, parameters,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    use_scaling </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rel_min </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rel_max </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Dict{Symbol, Jutul.OptimizationConfig} with 5 entries:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  :WellObs   =&gt; OptimizationConfig(Dict{Symbol, Any}(:MaterialHeatCapacities=&gt;O…</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  :WellB     =&gt; OptimizationConfig(Dict{Symbol, Any}(:MaterialHeatCapacities=&gt;O…</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  :Reservoir =&gt; OptimizationConfig(Dict{Symbol, Any}(:RockDensity=&gt;OrderedDict{…</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  :WellA     =&gt; OptimizationConfig(Dict{Symbol, Any}(:MaterialHeatCapacities=&gt;O…</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  :Facility  =&gt; OptimizationConfig(Dict{Symbol, Any}(), false)</span></span></code></pre></div><p>We will only cosider a subset of all the model parameters</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> well_symbols</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (k, v) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> opt_config</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (ki, vi) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ki </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Volumetric properties</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            :FluidVolume</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:BulkVolume</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:active</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Reservoir</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_max</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        elseif</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ki </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Rock density and heat capacity</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            :RockDensity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:RockHeatCapacity</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:active</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Reservoir</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_max</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        elseif</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ki </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Conductive properties</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            :Transmissibilities</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            :RockThermalConductivities</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:FluidThermalConductivities</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:active</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Reservoir</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_max</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        elseif</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ki </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Well properties</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            :WellIndices</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:WellIndicesThermal</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:active</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wells</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_max</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        else</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:active</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><h3 id="Calibrate-proxy-model" tabindex="-1">Calibrate proxy model <a class="header-anchor" href="#Calibrate-proxy-model" aria-label="Permalink to &quot;Calibrate proxy model {#Calibrate-proxy-model}&quot;">​</a></h3><p>Setting up the calibration requires a few steps, which has been conveniently implemented in the <code>calibrate_case</code> utility function. We use the LBFGS optimization algorithm, which has a number parameters that can be set, including the maximum number of function evaluations (maxfun), and the maximum number of iterations (maxiter), both we set to 200 here. Increasing these numbers will likely give a better match.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">proxy_cal </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> calibrate_case</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(objective, proxy, n_steps, opt_config;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    lbfgs_args </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (maxfun </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, maxiter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul case with 240 time-steps (5 years) and forces for each step.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Model:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">MultiModel with 5 models and 18 cross-terms. 1161 equations, 1161 degrees of freedom and 8549 parameters.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  models:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    1) Reservoir (1122x1122)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       SinglePhaseSystem{AqueousPhase, Tuple{Float64}}(AqueousPhase(), (998.20715,))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       ∈ MinimalTPFATopology (561 cells, 1406 faces)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    2) WellA (11x11)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       SinglePhaseSystem{AqueousPhase, Tuple{Float64}}(AqueousPhase(), (998.20715,))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       ∈ MultiSegmentWell [WellA] (4 nodes, 3 segments, 3 perforations)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    3) WellB (11x11)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       SinglePhaseSystem{AqueousPhase, Tuple{Float64}}(AqueousPhase(), (998.20715,))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       ∈ MultiSegmentWell [WellB] (4 nodes, 3 segments, 3 perforations)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    4) WellObs (11x11)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       SinglePhaseSystem{AqueousPhase, Tuple{Float64}}(AqueousPhase(), (998.20715,))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       ∈ MultiSegmentWell [WellObs] (4 nodes, 3 segments, 3 perforations)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    5) Facility (6x6)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.PredictionMode()</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       ∈ WellGroup([:WellA, :WellB, :WellObs], true, true)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  cross_terms:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    1) WellA &lt;-&gt; Reservoir (Eqs: mass_conservation &lt;-&gt; mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    2) WellA &lt;-&gt; Reservoir (Eqs: energy_conservation &lt;-&gt; energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    3) WellB &lt;-&gt; Reservoir (Eqs: mass_conservation &lt;-&gt; mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    4) WellB &lt;-&gt; Reservoir (Eqs: energy_conservation &lt;-&gt; energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    5) WellObs &lt;-&gt; Reservoir (Eqs: mass_conservation &lt;-&gt; mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    6) WellObs &lt;-&gt; Reservoir (Eqs: energy_conservation &lt;-&gt; energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    7) WellA  -&gt; Facility (Eq: control_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    8) Facility  -&gt; WellA (Eq: mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    9) Facility  -&gt; WellA (Eq: energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    10) WellA  -&gt; Facility (Eq: temperature_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellTemperatureCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    11) WellB  -&gt; Facility (Eq: control_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    12) Facility  -&gt; WellB (Eq: mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    13) Facility  -&gt; WellB (Eq: energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    14) WellB  -&gt; Facility (Eq: temperature_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellTemperatureCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    15) WellObs  -&gt; Facility (Eq: control_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    16) Facility  -&gt; WellObs (Eq: mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    17) Facility  -&gt; WellObs (Eq: energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    18) WellObs  -&gt; Facility (Eq: temperature_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellTemperatureCT</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Model storage will be optimized for runtime performance.</span></span></code></pre></div><h3 id="Simulate-the-full-schedule-using-the-calibrated-proxy" tabindex="-1">Simulate the full schedule using the calibrated proxy <a class="header-anchor" href="#Simulate-the-full-schedule-using-the-calibrated-proxy" aria-label="Permalink to &quot;Simulate the full schedule using the calibrated proxy {#Simulate-the-full-schedule-using-the-calibrated-proxy}&quot;">​</a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">results_proxy_cal </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> simulate_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(proxy_cal)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states_proxy_cal </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> results_proxy_cal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obj </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Jutul</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">evaluate_objective</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    objective, proxy_cal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model, states_proxy_cal[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_steps],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    proxy_cal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dt[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_steps], proxy_cal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">forces[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_steps])</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Final proxy mismatch: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$obj</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul: Simulating 5 years as 240 report steps</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">╭────────────────┬───────────┬───────────────┬──────────╮</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Iteration type </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">  Avg/step </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">  Avg/ministep </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">    Total </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">                │</span><span style="--shiki-light:#959da5;--shiki-dark:#959da5;"> 240 steps </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#959da5;--shiki-dark:#959da5;"> 244 ministeps </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#959da5;--shiki-dark:#959da5;"> (wasted) </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">├────────────────┼───────────┼───────────────┼──────────┤</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Newton         </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│   2.63333 │       2.59016 │  632 (0) │</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Linearization  </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│      3.65 │       3.59016 │  876 (0) │</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Linear solver  </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│   9.47083 │       9.31557 │ 2273 (0) │</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Precond apply  </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│   18.9417 │       18.6311 │ 4546 (0) │</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">╰────────────────┴───────────┴───────────────┴──────────╯</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">╭───────────────┬────────┬────────────┬────────╮</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Timing type   </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">   Each </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">   Relative </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;">  Total </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">               │</span><span style="--shiki-light:#959da5;--shiki-dark:#959da5;">     ms </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#959da5;--shiki-dark:#959da5;"> Percentage </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#959da5;--shiki-dark:#959da5;">      s </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">├───────────────┼────────┼────────────┼────────┤</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Properties    </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│ 0.1812 │     6.61 % │ 0.1145 │</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Equations     </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│ 0.3581 │    18.10 % │ 0.3137 │</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Assembly      </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│ 0.1948 │     9.85 % │ 0.1707 │</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Linear solve  </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│ 0.1704 │     6.22 % │ 0.1077 │</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Linear setup  </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│ 0.8087 │    29.49 % │ 0.5111 │</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Precond apply </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│ 0.0494 │    12.96 % │ 0.2247 │</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Update        </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│ 0.0915 │     3.34 % │ 0.0579 │</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Convergence   </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│ 0.1331 │     6.73 % │ 0.1166 │</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Input/Output  </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│ 0.0550 │     0.77 % │ 0.0134 │</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Other         </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│ 0.1626 │     5.93 % │ 0.1028 │</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">├───────────────┼────────┼────────────┼────────┤</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│</span><span style="--shiki-light:#24292e;--shiki-light-font-weight:bold;--shiki-dark:#e1e4e8;--shiki-dark-font-weight:bold;"> Total         </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">│ 2.7421 │   100.00 % │ 1.7330 │</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">╰───────────────┴────────┴────────────┴────────╯</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Final proxy mismatch: 0.3947937057805287</span></span></code></pre></div><h3 id="Plot-the-calibrated-results" tabindex="-1">Plot the calibrated results <a class="header-anchor" href="#Plot-the-calibrated-results" aria-label="Permalink to &quot;Plot the calibrated results {#Plot-the-calibrated-results}&quot;">​</a></h3><p>Finally, we plot the resulting prduction temperatures for the high-fidelity and proxy model. The calibrated proxy does a good job of reproducing the temperatures used for calibration, but the prediction for the remaining three years of storage are not perfect, with the calibrated proxy model being slightly worse that the initial proxy model for WellA in the final year.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">800</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), fontsize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">time_tot </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> results_hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">time</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">si_unit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:year</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (wno, well) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> enumerate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">well_symbols</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[wno, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], xlabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Time (years)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ylabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Temperature (°C)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Well: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$well</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    plot_well_data!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, time_tot, states_hf,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        vcat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([states_proxy], [states_proxy_cal], [states_proxy_cal]);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        wells </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [well],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        field </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        nan_ix </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            missing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            n_steps</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dt),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_steps</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        names</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">vcat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;High-fidelity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;Proxy (initial)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;Proxy (calibration)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;Proxy (prediction)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        legend </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wno </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        )</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR13/assets/uipztky.W-5okZTg.jpeg" alt=""></p><h2 id="Example-on-GitHub" tabindex="-1">Example on GitHub <a class="header-anchor" href="#Example-on-GitHub" aria-label="Permalink to &quot;Example on GitHub {#Example-on-GitHub}&quot;">​</a></h2><p>If you would like to run this example yourself, it can be downloaded from the Fimbul.jl GitHub repository <a href="https://github.com/sintefmath/Fimbul.jl/blob/main/examples/storage/egg_htates.jl" target="_blank" rel="noreferrer">as a script</a>, or as a <a href="https://github.com/sintefmath/Fimbul.jl/blob/gh-pages/dev/final_site/notebooks/storage/egg_htates.ipynb" target="_blank" rel="noreferrer">Jupyter Notebook</a></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">This example took 390.299863074 seconds to complete.</span></span></code></pre></div><hr><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl" target="_blank" rel="noreferrer">Literate.jl</a>.</em></p></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-4f9813fa><!--[--><!--]--><div class="edit-info" data-v-4f9813fa><div class="edit-link" data-v-4f9813fa><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://https://github.com/sintefmath/Fimbul.jl/edit/main/docs/src/examples/storage/egg_htates.md" target="_blank" rel="noreferrer" data-v-4f9813fa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-4f9813fa></span> Edit this page<!--]--></a></div><!----></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-4f9813fa><span class="visually-hidden" id="doc-footer-aria-label" data-v-4f9813fa>Pager</span><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link prev" href="/Fimbul.jl/previews/PR13/examples/storage/btes" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Previous page</span><span class="title" data-v-4f9813fa>Borehole Thermal Energy Storage (BTES)</span><!--]--></a></div><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link next" href="/Fimbul.jl/previews/PR13/examples/production/doublet" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Next page</span><span class="title" data-v-4f9813fa>Simulation of geothermal energy production from doublet</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860>Made with <a href="https://luxdl.github.io/DocumenterVitepress.jl/dev/" target="_blank"><strong>DocumenterVitepress.jl</strong></a><br></p><p class="copyright" data-v-c970a860>© Copyright 2025.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"examples_analytical_analytical_1d.md\":\"BKUwJUaZ\",\"examples_production_doublet.md\":\"C75co2Mz\",\"examples_storage_btes.md\":\"N2M6sViZ\",\"examples_storage_egg_htates.md\":\"DVtbfeVL\",\"index.md\":\"ClaO-aiH\",\"man_cases_cases.md\":\"gZ24-UED\",\"man_cases_utils.md\":\"BJDeLwd5\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Fimbul.jl\",\"description\":\"Documentation for Fimbul.jl\",\"base\":\"/Fimbul.jl/previews/PR13/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"logo\":{\"src\":\"/logo.png\",\"width\":24,\"height\":24},\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"text\":\"Manual\",\"collapsed\":false,\"items\":[{\"text\":\"Introduction\",\"collapsed\":false,\"items\":[{\"text\":\"Fimbul.jl\",\"link\":\"/index\"}]},{\"text\":\"Cases\",\"collapsed\":false,\"items\":[{\"text\":\"Setup functions\",\"link\":\"/man/cases/cases\"},{\"text\":\"Utilities\",\"link\":\"/man/cases/utils\"}]}]},{\"text\":\"Examples\",\"collapsed\":false,\"items\":[{\"text\":\"Storage\",\"collapsed\":false,\"items\":[{\"text\":\"Borehole Thermal Energy Storage (BTES)\",\"link\":\"/examples/storage/btes\"},{\"text\":\"Digital twinning of a high-temperature aquifer thermal energy storage system\",\"link\":\"/examples/storage/egg_htates\"}]},{\"text\":\"Production\",\"collapsed\":false,\"items\":[{\"text\":\"Simulation of geothermal energy production from doublet\",\"link\":\"/examples/production/doublet\"}]},{\"text\":\"Analytical\",\"collapsed\":false,\"items\":[{\"text\":\"Heat equation in 1D\",\"link\":\"/examples/analytical/analytical_1d\"}]}]},{\"component\":\"VersionPicker\"}],\"sidebar\":[{\"text\":\"Manual\",\"collapsed\":false,\"items\":[{\"text\":\"Introduction\",\"collapsed\":false,\"items\":[{\"text\":\"Fimbul.jl\",\"link\":\"/index\"}]},{\"text\":\"Cases\",\"collapsed\":false,\"items\":[{\"text\":\"Setup functions\",\"link\":\"/man/cases/cases\"},{\"text\":\"Utilities\",\"link\":\"/man/cases/utils\"}]}]},{\"text\":\"Examples\",\"collapsed\":false,\"items\":[{\"text\":\"Storage\",\"collapsed\":false,\"items\":[{\"text\":\"Borehole Thermal Energy Storage (BTES)\",\"link\":\"/examples/storage/btes\"},{\"text\":\"Digital twinning of a high-temperature aquifer thermal energy storage system\",\"link\":\"/examples/storage/egg_htates\"}]},{\"text\":\"Production\",\"collapsed\":false,\"items\":[{\"text\":\"Simulation of geothermal energy production from doublet\",\"link\":\"/examples/production/doublet\"}]},{\"text\":\"Analytical\",\"collapsed\":false,\"items\":[{\"text\":\"Heat equation in 1D\",\"link\":\"/examples/analytical/analytical_1d\"}]}]}],\"editLink\":{\"pattern\":\"https://https://github.com/sintefmath/Fimbul.jl/edit/main/docs/src/:path\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/sintefmath/Fimbul.jl\"}],\"footer\":{\"message\":\"Made with <a href=\\\"https://luxdl.github.io/DocumenterVitepress.jl/dev/\\\" target=\\\"_blank\\\"><strong>DocumenterVitepress.jl</strong></a><br>\",\"copyright\":\"© Copyright 2025.\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>