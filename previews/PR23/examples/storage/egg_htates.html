<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Digital twinning of a high-temperature aquifer thermal energy storage system | Fimbul.jl</title>
    <meta name="description" content="Documentation for Fimbul.jl">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/Fimbul.jl/previews/PR23/assets/style.mH-_3x4P.css" as="style">
    <link rel="preload stylesheet" href="/Fimbul.jl/previews/PR23/vp-icons.css" as="style">
    
    <script type="module" src="/Fimbul.jl/previews/PR23/assets/app.DqXQyhGC.js"></script>
    <link rel="preload" href="/Fimbul.jl/previews/PR23/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/Fimbul.jl/previews/PR23/assets/chunks/theme.DHiH5MZg.js">
    <link rel="modulepreload" href="/Fimbul.jl/previews/PR23/assets/chunks/framework.BQfdjCaB.js">
    <link rel="modulepreload" href="/Fimbul.jl/previews/PR23/assets/examples_storage_egg_htates.md.D1HtPjR2.lean.js">
    <script src="/Fimbul.jl/versions.js"></script>
    <script src="/Fimbul.jl/previews/PR23/siteinfo.js"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-492508fc></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-492508fc>Skip to content</a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle has-sidebar" data-v-822684d1 data-v-0f4f798b><a class="title" href="/Fimbul.jl/previews/PR23/" data-v-0f4f798b><!--[--><!--]--><!--[--><img class="VPImage logo" src="/Fimbul.jl/previews/PR23/logo.png" width="24" height="24" alt data-v-35a7d0b8><!--]--><span data-v-0f4f798b>Fimbul.jl</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Manual</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Introduction</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR23/index" data-v-acbfed09><!--[--><span data-v-acbfed09>Fimbul.jl</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Cases</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR23/man/cases/cases" data-v-acbfed09><!--[--><span data-v-acbfed09>Setup functions</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR23/man/cases/utils" data-v-acbfed09><!--[--><span data-v-acbfed09>Utilities</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>References</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR23/extras/refs" data-v-acbfed09><!--[--><span data-v-acbfed09>Bibliography</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup active" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Examples</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Storage</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR23/examples/storage/btes" data-v-acbfed09><!--[--><span data-v-acbfed09>Borehole Thermal Energy Storage (BTES)</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link active" href="/Fimbul.jl/previews/PR23/examples/storage/egg_htates" data-v-acbfed09><!--[--><span data-v-acbfed09>Digital twinning of a high-temperature aquifer thermal energy storage system</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Production</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR23/examples/production/doublet" data-v-acbfed09><!--[--><span data-v-acbfed09>Geothermal energy production from a well doublet</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Analytical</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR23/examples/analytical/analytical_1d" data-v-acbfed09><!--[--><span data-v-acbfed09>Heat equation in 1D</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><!----><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/sintefmath/Fimbul.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-04f5c5e9><span class="vpi-more-horizontal icon" data-v-04f5c5e9></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/sintefmath/Fimbul.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--[--><!--[--><div class="VPFlyout VPNolebaseEnhancedReadabilitiesMenu VPNolebaseEnhancedReadabilitiesMenuFlyout" aria-label="Enhanced Readability" role="menuitem" data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><span class="i-icon-park-outline:book-open option-icon" data-v-04f5c5e9></span><!----><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--]--></div></div></div><!--]--><!--]--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-168ddf5d><button data-v-168ddf5d>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-18756405><div class="curtain" data-v-18756405></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18756405><span class="visually-hidden" id="sidebar-aria-label" data-v-18756405> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Manual</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Introduction</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR23/index" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Fimbul.jl</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Cases</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR23/man/cases/cases" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Setup functions</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR23/man/cases/utils" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Utilities</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>References</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR23/extras/refs" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Bibliography</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible has-active" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Examples</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><section class="VPSidebarItem level-1 collapsible has-active" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Storage</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR23/examples/storage/btes" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Borehole Thermal Energy Storage (BTES)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR23/examples/storage/egg_htates" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Digital twinning of a high-temperature aquifer thermal energy storage system</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Production</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR23/examples/production/doublet" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Geothermal energy production from a well doublet</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Analytical</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR23/examples/analytical/analytical_1d" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Heat equation in 1D</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _Fimbul_jl_previews_PR23_examples_storage_egg_htates" data-v-83890dd9><div><h1 id="Digital-twinning-of-a-high-temperature-aquifer-thermal-energy-storage-system" tabindex="-1">Digital twinning of a high-temperature aquifer thermal energy storage system <a class="header-anchor" href="#Digital-twinning-of-a-high-temperature-aquifer-thermal-energy-storage-system" aria-label="Permalink to &quot;Digital twinning of a high-temperature aquifer thermal energy storage system {#Digital-twinning-of-a-high-temperature-aquifer-thermal-energy-storage-system}&quot;">​</a></h1><p>This script was prepared for the <a href="https://dte_aicomas_2025.iacm.info" target="_blank" rel="noreferrer">2025 DTE &amp; AICOMAS conference</a>:</p><p>Ø. Klemetsdal, O. Andersen, S. Krogstad, O. Møyner, &quot;Predictive Digital Twins for Underground Thermal Energy Storage using Differentiable Programming&quot;</p><p>The example demonstrates digital twinning of high-temperature aquifer thermal energy storage (HT-ATES). We first set up and simulate a high-fidelity model of the system, before we construct reduced-order models at a lower resolution and calibrate using adjoint-based optimization so that its output matches that of the high-fidelity model.</p><p>Add modules to namespace</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Jutul, JutulDarcy </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Jutul and JutulDarcy modules</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Fimbul </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Fimbul module</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> HYPRE </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Iterative linear solvers</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GLMakie </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Visualization</span></span></code></pre></div><h1 id="Set-up-model" tabindex="-1">Set up model <a class="header-anchor" href="#Set-up-model" aria-label="Permalink to &quot;Set up model {#Set-up-model}&quot;">​</a></h1><p>We use the first realization of the EGG benchmark model [?], and place a well doublet near the center of the domain. The fluid model is a single-phase water system with PVT formulations taken from the <a href="https://webbook.nist.gov/chemistry/fluid/" target="_blank" rel="noreferrer">NIST</a> database, which can be conveniently set up with the :geothermal keyword.</p><p>The HT-ATES system is operated by charging the aquifer through the main well (labelled &quot;Hot&quot; in this setup) with water at 25 l/s and 90°C from June to September while a supporting well (labelled &quot;Cold&quot;) is used to extract water at a constant BHP of 25 bar. The system is then discharged from December to March by producing hot water from the main well at a rate of 25 l/s with the supporting well injecting water at 10°C at a BHP of 45 bar. For the remaining months, the system is left to rest with no external forces applied. This cycle of charge – rest – discharge – rest is repeated for a total of 5 years.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hifi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> egg_ates</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    use_bc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, report_interval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> si_unit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:year</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul case with 240 time-steps (5 years) and forces for each step.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Model:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">MultiModel with 5 models and 18 cross-terms. 37181 equations, 37181 degrees of freedom and 301469 parameters.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  models:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    1) Reservoir (37106x37106)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       SinglePhaseSystem{AqueousPhase, Tuple{Float64}}(AqueousPhase(), (998.20715,))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       ∈ MinimalTPFATopology (18553 cells, 52113 faces)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    2) WellA (23x23)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       SinglePhaseSystem{AqueousPhase, Tuple{Float64}}(AqueousPhase(), (998.20715,))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       ∈ MultiSegmentWell [WellA] (8 nodes, 7 segments, 7 perforations)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    3) WellB (23x23)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       SinglePhaseSystem{AqueousPhase, Tuple{Float64}}(AqueousPhase(), (998.20715,))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       ∈ MultiSegmentWell [WellB] (8 nodes, 7 segments, 7 perforations)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    4) WellObs (23x23)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       SinglePhaseSystem{AqueousPhase, Tuple{Float64}}(AqueousPhase(), (998.20715,))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       ∈ MultiSegmentWell [WellObs] (8 nodes, 7 segments, 7 perforations)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    5) Facility (6x6)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.PredictionMode()</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       ∈ WellGroup([:WellA, :WellB, :WellObs], true, true)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  cross_terms:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    1) WellA &lt;-&gt; Reservoir (Eqs: mass_conservation &lt;-&gt; mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    2) WellA &lt;-&gt; Reservoir (Eqs: energy_conservation &lt;-&gt; energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    3) WellB &lt;-&gt; Reservoir (Eqs: mass_conservation &lt;-&gt; mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    4) WellB &lt;-&gt; Reservoir (Eqs: energy_conservation &lt;-&gt; energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    5) WellObs &lt;-&gt; Reservoir (Eqs: mass_conservation &lt;-&gt; mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    6) WellObs &lt;-&gt; Reservoir (Eqs: energy_conservation &lt;-&gt; energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    7) WellA  -&gt; Facility (Eq: control_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    8) Facility  -&gt; WellA (Eq: mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    9) Facility  -&gt; WellA (Eq: energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    10) WellA  -&gt; Facility (Eq: temperature_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellTemperatureCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    11) WellB  -&gt; Facility (Eq: control_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    12) Facility  -&gt; WellB (Eq: mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    13) Facility  -&gt; WellB (Eq: energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    14) WellB  -&gt; Facility (Eq: temperature_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellTemperatureCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    15) WellObs  -&gt; Facility (Eq: control_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    16) Facility  -&gt; WellObs (Eq: mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    17) Facility  -&gt; WellObs (Eq: energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    18) WellObs  -&gt; Facility (Eq: temperature_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellTemperatureCT</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Model storage will be optimized for runtime performance.</span></span></code></pre></div><h2 id="Visualize-the-model" tabindex="-1">Visualize the model <a class="header-anchor" href="#Visualize-the-model" aria-label="Permalink to &quot;Visualize the model {#Visualize-the-model}&quot;">​</a></h2><p>We visualize the model interactively using <code>plot_reservoir</code>.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">reservoir_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data_domain)</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR23/assets/wxuqsvi.BCUOuk8a.jpeg" alt=""></p><h2 id="Simulate-high-fidelity-model" tabindex="-1">Simulate high-fidelity model <a class="header-anchor" href="#Simulate-high-fidelity-model" aria-label="Permalink to &quot;Simulate high-fidelity model {#Simulate-high-fidelity-model}&quot;">​</a></h2><p>We set up a simulator for the high-fidelity model and simulate the system.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">results_hifi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> simulate_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">ReservoirSimResult with 240 entries:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  wells (3 present):</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :WellObs</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :WellB</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :WellA</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    Results per well:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :lrat =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :wrat =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :temperature =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :control =&gt; Vector{Symbol} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :Aqueous_mass_rate =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :bhp =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :wcut =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :mass_rate =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :rate =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  states (Vector with 240 entries, reservoir variables for each state)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Pressure =&gt; Vector{Float64} of size (18553,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :TotalMasses =&gt; Matrix{Float64} of size (1, 18553)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :TotalThermalEnergy =&gt; Vector{Float64} of size (18553,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :FluidEnthalpy =&gt; Matrix{Float64} of size (1, 18553)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Temperature =&gt; Vector{Float64} of size (18553,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :PhaseMassDensities =&gt; Matrix{Float64} of size (1, 18553)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :RockInternalEnergy =&gt; Vector{Float64} of size (18553,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :FluidInternalEnergy =&gt; Matrix{Float64} of size (1, 18553)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :PhaseViscosities =&gt; Matrix{Float64} of size (1, 18553)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  time (report time for each state)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     Vector{Float64} of length 240</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  result (extended states, reports)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     SimResult with 240 entries</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  extra</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     Dict{Any, Any} with keys :simulator, :config</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Completed at Aug. 22 2025 9:08 after 41 seconds, 688 milliseconds, 613.4 microseconds.</span></span></code></pre></div><h3 id="Visualize-the-reservoir-states" tabindex="-1">Visualize the reservoir states <a class="header-anchor" href="#Visualize-the-reservoir-states" aria-label="Permalink to &quot;Visualize the reservoir states {#Visualize-the-reservoir-states}&quot;">​</a></h3><p>We visualize the results of the high-fidelity simulation interactively using <code>plot_reservoir</code>. We see that a hot thermal plume develops around the main well, while a cold plume develops around the supporting well. After a few cycles, the plumes start to interact slightly.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi, results_hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, step </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dt),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :seaborn_icefire_gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR23/assets/vpbiomu.D9XDVvCm.jpeg" alt=""></p><h3 id="Inspect-well-output" tabindex="-1">Inspect well output <a class="header-anchor" href="#Inspect-well-output" aria-label="Permalink to &quot;Inspect well output {#Inspect-well-output}&quot;">​</a></h3><p>We can also inspect the well output using <code>plot_well_results</code>.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_well_results</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(results_hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells)</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR23/assets/vmodrfk.CU94UCzY.jpeg" alt=""></p><h2 id="Construct-proxy-model" tabindex="-1">Construct proxy model <a class="header-anchor" href="#Construct-proxy-model" aria-label="Permalink to &quot;Construct proxy model {#Construct-proxy-model}&quot;">​</a></h2><p>The high-fidelity model is posed on a logically Cartesian mesh with 60×60×7 cells. We construct a proxy model by coarsening the high-fidelity model to 15×15×3 cells using the <code>coarsen_reservoir_case</code> function.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">coarsening </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">proxy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JutulDarcy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">coarsen_reservoir_case</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi, coarsening,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    method</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:ijk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    setup_arg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (block_backend </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">results_proxy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> simulate_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(proxy, info_level</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(proxy, results_proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, step </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dt),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :seaborn_icefire_gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR23/assets/jqtalqb.DUiwPG_D.jpeg" alt=""></p><h3 id="Compare-proxy-models-to-high-fidelity-model" tabindex="-1">Compare proxy models to high-fidelity model <a class="header-anchor" href="#Compare-proxy-models-to-high-fidelity-model" aria-label="Permalink to &quot;Compare proxy models to high-fidelity model {#Compare-proxy-models-to-high-fidelity-model}&quot;">​</a></h3><p>We compare the well output of the proxy models to the high-fidelity model.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_well_results</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([results_hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells, results_proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    names </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;High-fidelity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Proxy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR23/assets/djmyyry.CglbO74u.jpeg" alt=""></p><h3 id="Define-mismatch-objective-function" tabindex="-1">Define mismatch objective function <a class="header-anchor" href="#Define-mismatch-objective-function" aria-label="Permalink to &quot;Define mismatch objective function {#Define-mismatch-objective-function}&quot;">​</a></h3><p>We define an objective function that measures the mismatch in well output between the high-fidelity model and the proxy model. The objective function is defined as the sum of the squared differences in production temperature of all wells, weighted by the inverse of the units of the respective quantities. The objective function is also scaled by the total time simulated in the high-fidelity model.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states_hf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> results_hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states_proxy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> results_proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">240-element Vector{OrderedDict{Symbol, Any}}:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.4526569050960406e6, 3.4580050943704504e6, 3.4960555673543913e6, 3.5517121768362676e6, 3.5846252349965717e6, 3.6142761201824374e6, 3.645004259885819e6, 3.6563452926190454e6, 3.6578821366068106e6, 3.6603289064871026e6  …  3.3513904473462254e6, 3.369385517011502e6, 3.390840176691416e6, 3.4262275950744203e6, 3.3236369324504375e6, 3.3250645366113414e6, 3.3273100886223456e6, 3.3331551383141065e6, 3.344562390384856e6, 3.347351641385101e6], :TotalMasses =&gt; [455965.3920601961 1.4185888653219333e6 … 557151.797718458 101302.42970290758], :TotalThermalEnergy =&gt; [1.6875515822155366e12, 5.249529495278126e12, 7.499163609104232e12, 7.686696100699586e12, 8.249155739225506e12, 8.249192832951277e12, 8.249230089286145e12, 7.499334299454156e12, 6.5618895988189e12, 5.06214289928651e12  …  6.008278539737383e12, 6.008291541756475e12, 4.693895966202825e12, 1.5020221843685864e12, 9.387562325297539e11, 5.257090352812366e12, 4.881641684219599e12, 3.191854269042907e12, 2.0652407504549048e12, 3.754512378600459e11], :FluidEnthalpy =&gt; [1.3525778825232284e6 1.3524055241470572e6 … 1.354423492197975e6 1.3542425005669226e6], :Temperature =&gt; [323.23430929927156, 323.1936958847315, 323.18671858334284, 323.18970394899014, 323.1908364985404, 323.19269619755147, 323.19457179673947, 323.1962439125181, 323.19482191760113, 323.20245515402246  …  323.6898057506131, 323.6907412772878, 323.6850754067859, 323.67993882112427, 323.67603077484625, 323.67962191081915, 323.6836593333059, 323.68495990112206, 323.6724975445264, 323.6300333031594]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.955178779006324, 13.611766855978628, 7.1690662112896435], :Pressure =&gt; [4.242512923054496e6, 4.255615641802568e6, 4.336953320802253e6, 4.405697451192024e6], :PhaseMassDensities =&gt; [967.2842437277694 967.2941482690937 967.3393454326248 967.381662973258], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.6225535759765 364.6613028075098 243.11889449115947 243.12953004914118], :TotalThermalEnergy =&gt; [4.321858677932566e8, 5.5565998490772e8, 3.704292760907748e8, 3.704150151932188e8], :FluidEnthalpy =&gt; [1.5281924236587686e6 1.5281695916670715e6 1.5281382063030559e6 1.5280837652993253e6], :Temperature =&gt; [363.14999954129195, 363.14426940978785, 363.1330285366264, 363.11737239778694]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.128137366977935, -14.430857144408979, -6.935336068731667], :Pressure =&gt; [2.5e6, 2.5640405904415096e6, 2.6755612785662054e6, 2.7601063888810226e6], :PhaseMassDensities =&gt; [988.9965150302548 989.0269959517316 988.9988509292457 988.9821603834905], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.98892403086256 372.85439336207315 248.56252195904523 248.55832716737092], :TotalThermalEnergy =&gt; [3.916606671315297e8, 5.035551213005771e8, 3.3585587688181794e8, 3.359621262096333e8], :FluidEnthalpy =&gt; [1.3531334230393092e6 1.3531334236969452e6 1.353898070079223e6 1.3544338684710215e6], :Temperature =&gt; [323.42564245726953, 323.4215381925504, 323.59305087260094, 323.71279044855896]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024955177928198402, -0.007323840896420173, 0.0009342920511472863], :Pressure =&gt; [3.4005361515034684e6, 3.43937549970287e6, 3.5364166409821454e6, 3.61403800873207e6], :PhaseMassDensities =&gt; [989.4824014551373 989.500820238148 989.4382958420113 989.3796985230044], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.13139337166564 373.0330209097489 248.67296651181337 248.65823939926042], :TotalThermalEnergy =&gt; [3.9143117684280723e8, 5.032634780792042e8, 3.3571776710416716e8, 3.359019571663499e8], :FluidEnthalpy =&gt; [1.352588086242248e6 1.3525882798928227e6 1.3536114128888384e6 1.3545107727003146e6], :Temperature =&gt; [323.24007169824466, 323.2375992172532, 323.470324227903, 323.6753732595077]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.12813736875225, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 1), :SurfaceTemperature =&gt; [363.14999954129195, 323.42564245726953, 323.24007169824466]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.451457166483713e6, 3.4566346360158175e6, 3.494249156442104e6, 3.549209606051649e6, 3.581626639970433e6, 3.61062811886611e6, 3.640569332699665e6, 3.651559641824222e6, 3.6530057161349915e6, 3.655423391903639e6  …  3.3513067318835855e6, 3.369305862573295e6, 3.3907526276370445e6, 3.4261209335581856e6, 3.3235355267025717e6, 3.324964340477358e6, 3.3272123524721186e6, 3.3330618128103735e6, 3.3444771466099885e6, 3.3472713532889797e6], :TotalMasses =&gt; [455965.2544301354 1.4185864326610467e6 … 557152.6561334354 101302.57723300504], :TotalThermalEnergy =&gt; [1.687549064945692e12, 5.249566838862769e12, 7.499213201762497e12, 7.686740594233909e12, 8.249198823890666e12, 8.249235116512326e12, 8.249276761842732e12, 7.499367376299016e12, 6.561921389808053e12, 5.062169473252419e12  …  6.008231728817666e12, 6.008241375215297e12, 4.693857425996243e12, 1.502010529316642e12, 9.387482416833014e11, 5.257047755473927e12, 4.881602354687377e12, 3.191827260613043e12, 2.0652198061584072e12, 3.75447638564125e11], :FluidEnthalpy =&gt; [1.352575330313138e6 1.352415381061708e6 … 1.3544087512725932e6 1.3542285680973202e6], :Temperature =&gt; [323.2337908064036, 323.19608748960496, 323.1889357280991, 323.1916340662009, 323.1925696012284, 323.194389014293, 323.1964361072336, 323.19768225501093, 323.19640612835275, 323.20417604737685  …  323.68716401419977, 323.68791029823774, 323.68229147325235, 323.67730765841975, 323.67314452371306, 323.6768743802808, 323.6809274613574, 323.6820907806213, 323.6690593497187, 323.6267836369918]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.955178760451496, 13.608860339259438, 7.142557618905469], :Pressure =&gt; [4.176567350259255e6, 4.1896688342778007e6, 4.2710060638383385e6, 4.339773615598843e6], :PhaseMassDensities =&gt; [967.2536987740853 967.2615683025389 967.3041748547205 967.3418058262665], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.61359732778067 364.64902044947985 243.11005516082614 243.11951285552666], :TotalThermalEnergy =&gt; [4.3218701093124646e8, 5.556653098837644e8, 3.7043610037855154e8, 3.704277761175165e8], :FluidEnthalpy =&gt; [1.5281765349874517e6 1.528167488662311e6 1.528153662894247e6 1.5281310653621266e6], :Temperature =&gt; [363.1499998347426, 363.14730926503285, 363.1399397376812, 363.1313041429462]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.127890261735793, -14.430317981477952, -6.934897771148331], :Pressure =&gt; [2.5e6, 2.5640402380683785e6, 2.675560161176119e6, 2.7601047156396527e6], :PhaseMassDensities =&gt; [988.9938994889869 989.0243803522571 988.9970182572565 988.9810602818787], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.98815711410754 372.85340730430187 248.56206135833662 248.5580506816796], :TotalThermalEnergy =&gt; [3.9166677209076786e8, 5.035629708140558e8, 3.358595426083658e8, 3.359643257361243e8], :FluidEnthalpy =&gt; [1.3531580540449447e6 1.353158054418256e6 1.3539153255368904e6 1.354444222541377e6], :Temperature =&gt; [323.43139898374795, 323.42729451914215, 323.59708332289046, 323.71521003887165]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024955177011264002, -0.006902000128675265, 0.0012829939396990099], :Pressure =&gt; [3.401105427272133e6, 3.4399446775007052e6, 3.536985090255872e6, 3.61460606287489e6], :PhaseMassDensities =&gt; [989.4799301438931 989.4982964810167 989.4345662058854 989.3822435570844], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.13066874536236 373.03206947572534 248.6720291520171 248.65887903608993], :TotalThermalEnergy =&gt; [3.914375232972492e8, 5.03271795583063e8, 3.357257260208471e8, 3.3589734985145855e8], :FluidEnthalpy =&gt; [1.3526139142450325e6 1.3526146019657652e6 1.3536490954722604e6 1.3544893339231818e6], :Temperature =&gt; [323.2460689115976, 323.2437117719433, 323.4790901906213, 323.6703284650983]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.127890262742987, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 2), :SurfaceTemperature =&gt; [363.1499998347426, 323.43139898374795, 323.2460689115976]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.45020436647661e6, 3.4552092108091023e6, 3.492397125188865e6, 3.5466969859784804e6, 3.578665663880618e6, 3.6071535362968612e6, 3.6364950173987043e6, 3.6472221278052223e6, 3.6486194750139466e6, 3.6510501976197055e6  …  3.3512573831481747e6, 3.3692648571892693e6, 3.3907083143636105e6, 3.4260645192397246e6, 3.3234602048469824e6, 3.324890610271116e6, 3.327141744477021e6, 3.332997686052847e6, 3.3444257573844744e6, 3.347229090265049e6], :TotalMasses =&gt; [455965.03863070905 1.4185839972045175e6 … 557153.5038264043 101302.71887102276], :TotalThermalEnergy =&gt; [1.6875481530984211e12, 5.24960342294044e12, 7.49926176228664e12, 7.686784329201074e12, 8.249241766635477e12, 8.249280479519777e12, 8.249353307678836e12, 7.499401284415396e12, 6.561953372059449e12, 5.062196179275626e12  …  6.00818550702825e12, 6.008192073195359e12, 4.693819769867406e12, 1.5019988278463184e12, 9.387403875241375e11, 5.25700586028473e12, 4.8815636351174795e12, 3.191800613298032e12, 2.0651993170281865e12, 3.754442203886156e11], :FluidEnthalpy =&gt; [1.3525741389466731e6 1.3524250104929742e6 … 1.3543943411683168e6 1.354215347835681e6], :Temperature =&gt; [323.23359367608754, 323.19842951316923, 323.1911057847594, 323.1935306805521, 323.19429731628674, 323.1962101298858, 323.1995298588821, 323.19916317563184, 323.19800574876695, 323.2059117907076  …  323.684555900843, 323.6851285263014, 323.679571865823, 323.67466658787384, 323.6703079190269, 323.6741724191106, 323.6782382476727, 323.67926033766366, 323.66569623731544, 323.62369788253665]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.95517875542967, 13.623758043213725, 7.132679503786409], :Pressure =&gt; [4.1502835803371374e6, 4.163384574012909e6, 4.244705777504635e6, 4.313481992427623e6], :PhaseMassDensities =&gt; [967.2415245697575 967.2486739293757 967.29024227819 967.3261314793215], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.6100276646319 364.6441593853196 243.10655352242026 243.11557346246968], :TotalThermalEnergy =&gt; [4.321874662516398e8, 5.556672594206969e8, 3.7043870303621644e8, 3.704325848365217e8], :FluidEnthalpy =&gt; [1.5281702009095654e6 1.52816603278946e6 1.5281591901673495e6 1.5281484267439486e6], :Temperature =&gt; [363.1499999141508, 363.1483848478859, 363.1425556043018, 363.13652886711185]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.127820323090557, -14.429921034863499, -6.93453964590113], :Pressure =&gt; [2.5e6, 2.564040107302919e6, 2.675559511613961e6, 2.7601036664713016e6], :PhaseMassDensities =&gt; [988.9923715192276 989.0228523794167 988.9961750400234 988.9808968165858], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.9877090899743 372.8528312721118 248.56184943473144 248.55800959837052], :TotalThermalEnergy =&gt; [3.9167033852453583e8, 5.035675563969587e8, 3.3586122909765685e8, 3.3596465187585115e8], :FluidEnthalpy =&gt; [1.3531724432107664e6 1.3531724434633513e6 1.353923264215572e6 1.3544457574792104e6], :Temperature =&gt; [323.43476188170183, 323.4306573061119, 323.59893853096156, 323.715568782463]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.02495516981252335, -0.0064302652521550955, 0.0017325195713565537], :Pressure =&gt; [3.4016470966972383e6, 3.4404855552566047e6, 3.5375233852250976e6, 3.6151425379226157e6], :PhaseMassDensities =&gt; [989.4598908653072 989.4779722826376 989.4118382897907 989.3700348259399], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.1247929219927 373.02440743344715 248.66631700367833 248.65581064728406], :TotalThermalEnergy =&gt; [3.9148489161155903e8, 5.0333355519067013e8, 3.357717061243584e8, 3.359222599428285e8], :FluidEnthalpy =&gt; [1.3528051245858283e6 1.3528084962593887e6 1.353865641230744e6 1.3546067694340963e6], :Temperature =&gt; [323.2907055118929, 323.28897473820206, 323.529641250096, 323.6977253823685]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.127820323772028, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 3), :SurfaceTemperature =&gt; [363.1499999141508, 323.43476188170183, 323.2907055118929]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.4490080817025043e6, 3.453842631786082e6, 3.4906166205359967e6, 3.544286050181126e6, 3.5758376954187197e6, 3.603879729613045e6, 3.632704758354832e6, 3.643205834993591e6, 3.6445693290223936e6, 3.647024622826303e6  …  3.3512591138302656e6, 3.369275768961496e6, 3.390716848744412e6, 3.426062303174393e6, 3.323434876930937e6, 3.324866881245455e6, 3.327121173979593e6, 3.332983843109332e6, 3.3444253760521747e6, 3.3472386242513033e6], :TotalMasses =&gt; [455964.78683466767 1.4185816202935558e6 … 557154.3487502801 101302.85720683225], :TotalThermalEnergy =&gt; [1.6875483715543516e12, 5.249639496907007e12, 7.499309658893081e12, 7.686827660358963e12, 8.249285316129137e12, 8.2493321612209795e12, 8.249472719812558e12, 7.499436401995628e12, 6.561985451766875e12, 5.062222926658398e12  …  6.008139777973727e12, 6.008143478920084e12, 4.693782778087201e12, 1.5019871597004773e12, 9.387326451003174e11, 5.256964538708503e12, 4.881525415019525e12, 3.1917742656903057e12, 2.0651791949539136e12, 3.754409364443065e11], :FluidEnthalpy =&gt; [1.3525739363030875e6 1.352434518372361e6 … 1.354380205586284e6 1.3542026631129943e6], :Temperature =&gt; [323.2336238708755, 323.20073932856855, 323.19324670332844, 323.1954106825752, 323.1960514411123, 323.1982927271035, 323.2043851498259, 323.20070230358, 323.19961419928177, 323.2076542332757  …  323.68197616017443, 323.6823872661243, 323.67690082604105, 323.6720336479937, 323.6675122203717, 323.6715080044162, 323.6755842778121, 323.6764622880567, 323.66239393988957, 323.6207338717751]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.9551787531123, 13.637110955531373, 7.128802931866027], :Pressure =&gt; [4.1352176545097814e6, 4.1483183687321157e6, 4.229625644763554e6, 4.298405068925807e6], :PhaseMassDensities =&gt; [967.23454628986 967.2413651389484 967.2824171875703 967.3174789641614], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.60798152609823 364.641404036242 243.10458686264388 243.11339884822473], :TotalThermalEnergy =&gt; [4.321877271668213e8, 5.55668220864045e8, 3.7043998856885225e8, 3.704349178221402e8], :FluidEnthalpy =&gt; [1.5281665698514546e6 1.5281646403218007e6 1.5281612503963015e6 1.5281561057727293e6], :Temperature =&gt; [363.14999995079256, 363.14887841111425, 363.1438109981337, 363.1390229178765]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.12966697470324, -14.430639892279974, -6.934721271206769], :Pressure =&gt; [2.5e6, 2.5640419248258774e6, 2.6755619751655343e6, 2.7601062980942996e6], :PhaseMassDensities =&gt; [988.9912104585619 989.0216922254781 988.995659527217 988.9810420466133], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.98736864920625 372.85239390438096 248.56171987223178 248.5580460986575], :TotalThermalEnergy =&gt; [3.916730485486553e8, 5.035710405940718e8, 3.3586226262044966e8, 3.359643635830354e8], :FluidEnthalpy =&gt; [1.353183377132475e6 1.3531833773243933e6 1.3539281304501393e6 1.3544444013811843e6], :Temperature =&gt; [323.4373172519976, 323.43321247648487, 323.60007554726326, 323.71525172682595]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024955156884147223, -0.005919677655656777, 0.0022568455353971033], :Pressure =&gt; [3.4021681791800824e6, 3.441004704516871e6, 3.538036958609236e6, 3.6156519661513446e6], :PhaseMassDensities =&gt; [989.4108640614786 989.4284329518331 989.358075971081 989.3314902031036], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.11041751229726 373.0057315457209 248.65280505923846 248.64612332696905], :TotalThermalEnergy =&gt; [3.9159996437092334e8, 5.034830490883568e8, 3.358798085985381e8, 3.359998803754913e8], :FluidEnthalpy =&gt; [1.3532693363772803e6 1.3532775360009854e6 1.3543744828926853e6 1.3549722325042696e6], :Temperature =&gt; [323.3991224036544, 323.3985178945854, 323.64847388215264, 323.7830599070866]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.129666975221074, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 4), :SurfaceTemperature =&gt; [363.14999995079256, 323.4373172519976, 323.3991224036544]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.4477957701189956e6, 3.4524611331642456e6, 3.48882990544806e6, 3.5418908025087514e6, 3.5730477833744683e6, 3.600687311162454e6, 3.629045602385999e6, 3.639342460981358e6, 3.640678986000321e6, 3.6431616900633317e6  …  3.351239071144715e6, 3.3692615191100505e6, 3.3906961093023196e6, 3.426024140133684e6, 3.3233935373698836e6, 3.324826938576172e6, 3.3270839447248895e6, 3.332951970680753e6, 3.3444036222302085e6, 3.347223508061163e6], :TotalMasses =&gt; [455964.49061601673 1.41857925739174e6 … 557155.1740905023 101302.98937171658], :TotalThermalEnergy =&gt; [1.687549570587754e12, 5.249675012951802e12, 7.499356832760047e12, 7.686870581651043e12, 8.24933018048902e12, 8.249394380574488e12, 8.249651286576668e12, 7.499473213777043e12, 6.562017454154318e12, 5.062249570958817e12  …  6.008094473587562e12, 6.00809551648512e12, 4.693746354998975e12, 1.5019755491360408e12, 9.387250033634307e11, 5.256923727930029e12, 4.881487636354268e12, 3.1917481825620273e12, 2.06515941302056e12, 3.754377729853735e11], :FluidEnthalpy =&gt; [1.352574570192538e6 1.3524438674498477e6 … 1.3543663019927433e6 1.3541904358678176e6], :Temperature =&gt; [323.2338505378951, 323.2030130132077, 323.19535494336026, 323.19727282504397, 323.1978599395224, 323.20080850319596, 323.2116683927449, 323.2023196082324, 323.2012204745338, 323.2093916292465  …  323.67942013421373, 323.6796813700354, 323.6742705241238, 323.6694132994494, 323.6647526972802, 323.6688763425972, 323.6729607729301, 323.67369212374194, 323.65914722703684, 323.6178783374041]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.955178752065, 13.645982334744044, 7.127589079469832], :Pressure =&gt; [4.1252214535536617e6, 4.138321983669097e6, 4.21962001814125e6, 4.2884002388680065e6], :PhaseMassDensities =&gt; [967.2299162252496 967.2365826291282 967.2773785329263 967.312046122654], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.60662392024807 364.63960107251603 243.10332051061079 243.1120334262273], :TotalThermalEnergy =&gt; [4.3218790024878365e8, 5.556687320861541e8, 3.704406478750415e8, 3.7043607575262606e8], :FluidEnthalpy =&gt; [1.528164160495289e6 1.5281632633433796e6 1.5281615786848995e6 1.5281591085874771e6], :Temperature =&gt; [363.1499999673519, 363.1491060212828, 363.14441495384773, 363.1402164644804]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.13097724542051, -14.431058410761906, -6.93475848777848], :Pressure =&gt; [2.5e6, 2.5640432075468283e6, 2.675563614247758e6, 2.760107970439251e6], :PhaseMassDensities =&gt; [988.9902115142593 989.0206939248465 988.9952801247327 988.981315567858], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.98707574343854 372.8520175539093 248.5616245179872 248.55811484204415], :TotalThermalEnergy =&gt; [3.9167538017302763e8, 5.035740383397323e8, 3.35863023112642e8, 3.3596381779195243e8], :FluidEnthalpy =&gt; [1.3531927843778885e6 1.3531927845430002e6 1.3539317110790252e6 1.3544418326464142e6], :Temperature =&gt; [323.439515821525, 323.4354108979432, 323.6009121874565, 323.71465137097346]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024955137994504273, -0.005357223210438961, 0.0028467757813171466], :Pressure =&gt; [3.402524494441058e6, 3.4413574205402182e6, 3.5383797427459313e6, 3.6159872000249177e6], :PhaseMassDensities =&gt; [989.3194836009208 989.3363045622167 989.2591227753421 989.2530026440941], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.08362336183075 372.97099996108017 248.62793540861585 248.62639725186642], :TotalThermalEnergy =&gt; [3.9181379985964394e8, 5.0376023317794305e8, 3.360782299267367e8, 3.3615731474883646e8], :FluidEnthalpy =&gt; [1.3541318451433147e6 1.3541470902926389e6 1.35530836950148e6 1.3557132918320962e6], :Temperature =&gt; [323.60059663621166, 323.601634961163, 323.8666029063959, 323.956137037537]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.130977245866035, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 5), :SurfaceTemperature =&gt; [363.1499999673519, 323.439515821525, 323.60059663621166]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.446559003464135e6, 3.451055846014911e6, 3.4870265959255947e6, 3.5394972416137024e6, 3.570277462597565e6, 3.597545792659295e6, 3.625471996903555e6, 3.6355799503283366e6, 3.63689357376095e6, 3.63940386453159e6  …  3.351192706743745e6, 3.369216592076218e6, 3.3906391446113246e6, 3.425940620939076e6, 3.3233330939272875e6, 3.324767642604073e6, 3.3270268109136913e6, 3.3328984955286444e6, 3.344356094908441e6, 3.3471784255945715e6], :TotalMasses =&gt; [455964.1532334027 1.418576902714643e6 … 557155.9789924448 101303.11550660549], :TotalThermalEnergy =&gt; [1.6875516318761729e12, 5.249709975563014e12, 7.499403305185701e12, 7.686913217006318e12, 8.249377507720215e12, 8.249472371558406e12, 8.249904892563539e12, 7.499512470533508e12, 6.562049328962088e12, 5.062276067368251e12  …  6.008049588828965e12, 6.008048174885363e12, 4.693710466723842e12, 1.501964031740583e12, 9.387174603631395e11, 5.256883416226606e12, 4.881450288943624e12, 3.1917223605818984e12, 2.0651399655981277e12, 3.754347209499398e11], :FluidEnthalpy =&gt; [1.3525759362939708e6 1.3524530560707976e6 … 1.3543526249952666e6 1.3541786293520445e6], :Temperature =&gt; [323.2342498519519, 323.2052507552855, 323.19743134743953, 323.19912240377056, 323.1997696916981, 323.20397180590834, 323.22203066646136, 323.20404837675807, 323.20282136242537, 323.211120333002  …  323.67688748739874, 323.67701015509357, 323.6716784354485, 323.6668134666876, 323.66202861071014, 323.66627664246465, 323.6703669897624, 323.67094945071193, 323.6559551251172, 323.6151230399495]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.955178751528837, 13.652385032643801, 7.127563254246485], :Pressure =&gt; [4.1178207072751443e6, 4.130921101914046e6, 4.212212464776654e6, 4.280992419354113e6], :PhaseMassDensities =&gt; [967.2264883321656 967.2330841365358 967.2737522630871 967.3082313284399], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.60561880949996 364.6382821718808 243.10240912959586 243.11107466386906], :TotalThermalEnergy =&gt; [4.321880283734751e8, 5.556690304816034e8, 3.704410045532278e8, 3.704366705747351e8], :FluidEnthalpy =&gt; [1.5281623766334797e6 1.5281619574581627e6 1.5281611167167025e6 1.5281599237516196e6], :Temperature =&gt; [363.1499999758291, 363.1492113977015, 363.14470665331277, 363.14078970352955]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.13183005869726, -14.43121883504966, -6.934667328395196], :Pressure =&gt; [2.5e6, 2.564044028796691e6, 2.6755645296965567e6, 2.7601087891695565e6], :PhaseMassDensities =&gt; [988.9892155192283 989.0196983509622 988.9948852518938 988.9815815204054], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.98678370244244 372.85164223139725 248.56152527561844 248.55818168320968], :TotalThermalEnergy =&gt; [3.916777049089308e8, 5.0357702729873693e8, 3.3586381393258524e8, 3.3596328640759885e8], :FluidEnthalpy =&gt; [1.3532021638524875e6 1.3532021640171064e6 1.353935434170963e6 1.3544393313766883e6], :Temperature =&gt; [323.4417079000204, 323.4376028642664, 323.601782166069, 323.7140668351316]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.02495511356611139, -0.004825372106507781, 0.0034221383038711257], :Pressure =&gt; [3.4026803385785134e6, 3.4415075125955716e6, 3.538514403762466e6, 3.616109985643595e6], :PhaseMassDensities =&gt; [989.1733307040763 989.1891845106803 989.1023855449332 989.1216675669809], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.0407690942415 372.91553700830787 248.58854304608812 248.59338914679304], :TotalThermalEnergy =&gt; [3.921553100590365e8, 5.0420223124537414e8, 3.3639208932218844e8, 3.3642032222125727e8], :FluidEnthalpy =&gt; [1.3555095349935072e6 1.35553389131216e6 1.3567858391933022e6 1.3569514094652932e6], :Temperature =&gt; [323.9224264888848, 323.9255881627881, 324.2117088979317, 324.2453223526338]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.13183005914147, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 6), :SurfaceTemperature =&gt; [363.1499999758291, 323.4417079000204, 323.9224264888848]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.4453071125247646e6, 3.449636567010198e6, 3.485216571016274e6, 3.5371138246247442e6, 3.567532637454449e6, 3.594454551823334e6, 3.6219755490123807e6, 3.631907101979976e6, 3.6332008893778436e6, 3.6357382260365444e6  …  3.351114372302854e6, 3.3691340305135213e6, 3.390537609086024e6, 3.425801258794676e6, 3.3232503914936306e6, 3.324685745116303e6, 3.3269463345696516e6, 3.3328193362138057e6, 3.3442771936994623e6, 3.347096493027404e6], :TotalMasses =&gt; [455963.780825634 1.418574561623056e6 … 557156.7623235281 101303.23564929584], :TotalThermalEnergy =&gt; [1.6875544542838667e12, 5.249744404286389e12, 7.499449125412154e12, 7.686955774875864e12, 8.24942884316138e12, 8.24957214392575e12, 8.250248299621637e12, 7.499555075142093e12, 6.562081071224436e12, 5.062302406011463e12  …  6.008005117473136e12, 6.008001440896613e12, 4.693675084777402e12, 1.5019526376221838e12, 9.387100141482859e11, 5.256843592302292e12, 4.881413362657123e12, 3.19169679631657e12, 2.0651208465947058e12, 3.7543177204920825e11], :FluidEnthalpy =&gt; [1.3525779508323725e6 1.3524620928228984e6 … 1.3543391684855225e6 1.3541672092930018e6], :Temperature =&gt; [323.23480163676726, 323.20745392628606, 323.1994782500013, 323.2009686913968, 323.2018441543888, 323.20802914720633, 323.23607743389283, 323.20592922126986, 323.20441646875025, 323.2128395381863  …  323.6743778050049, 323.6743727969612, 323.6691224092446, 323.66424082554545, 323.6593392206101, 323.66370813911874, 323.66780218618476, 323.66823385840377, 323.6528165711964, 323.6124604201065]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.955178751251438, 13.656230206657906, 7.128043598974967], :Pressure =&gt; [4.111774335721701e6, 4.1248746200177004e6, 4.206161904894194e6, 4.274941150754532e6], :PhaseMassDensities =&gt; [967.2236824103907 967.2302486209878 967.2708529616314 967.3052410694772], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.60479607026474 364.63721320770304 243.10168045566354 243.1103231298219], :TotalThermalEnergy =&gt; [4.321881342948592e8, 5.55669231188413e8, 3.704412167246672e8, 3.704369973535251e8], :FluidEnthalpy =&gt; [1.528160932059156e6 1.5281607364835707e6 1.5281603147109398e6 1.528159736154995e6], :Temperature =&gt; [363.1499999801998, 363.1492635301935, 363.14485129330114, 363.1410697879535]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.132397519877358, -14.43121556331606, -6.934485567989949], :Pressure =&gt; [2.5e6, 2.564044555484118e6, 2.675564967365567e6, 2.76010902583401e6], :PhaseMassDensities =&gt; [988.9880508751016 989.0185339898862 988.9943063115235 988.9816955938793], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.9864422109488 372.8512032776129 248.5613797720333 248.55821035300067], :TotalThermalEnergy =&gt; [3.916804232801281e8, 5.0358052242969e8, 3.3586497260781294e8, 3.3596305838524044e8], :FluidEnthalpy =&gt; [1.3532131315315324e6 1.3532131317240214e6 1.3539408887097451e6 1.3544382580089234e6], :Temperature =&gt; [323.44427115713125, 323.4401660246463, 323.60305679179856, 323.71381600116024]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.02495508480871875, -0.004355517179705941, 0.003942336316385526], :Pressure =&gt; [3.4026003671190403e6, 3.441419256409304e6, 3.5384041193948737e6, 3.61598249938828e6], :PhaseMassDensities =&gt; [988.9626990482851 988.9774146610365 988.8744893162873 988.924297677208], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.97900866707977 372.83570165584075 248.53126647667253 248.543784683133], :TotalThermalEnergy =&gt; [3.926470062332274e8, 5.048378407561685e8, 3.3683969491497827e8, 3.3680776118577385e8], :FluidEnthalpy =&gt; [1.3574937805976358e6 1.357528860575261e6 1.358899415972001e6 1.3587809372934983e6], :Temperature =&gt; [324.3859405723065, 324.39159970169453, 324.7047408289422, 324.67206740798355]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.132397520396786, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 7), :SurfaceTemperature =&gt; [363.1499999801998, 323.44427115713125, 324.3859405723065]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.444031670872747e6, 3.4481944904541e6, 3.4833896029865965e6, 3.5347269786388846e6, 3.5647962427152605e6, 3.5913899581981646e6, 3.61852767329919e6, 3.6282943245694004e6, 3.6295712253348883e6, 3.6321355826669605e6  …  3.3510055062981076e6, 3.369015317531146e6, 3.390392685949122e6, 3.4256065755244372e6, 3.3231464754668237e6, 3.32458231769581e6, 3.3268436357435854e6, 3.3327157296254216e6, 3.344168367928088e6, 3.3469792279453203e6], :TotalMasses =&gt; [455963.3756350964 1.4185722283293763e6 … 557157.5246180522 101303.35017189971], :TotalThermalEnergy =&gt; [1.6875579437011787e12, 5.249778304635676e12, 7.499494327792146e12, 7.686998506923623e12, 8.24948607128757e12, 8.249700208043711e12, 8.250694665962016e12, 7.499601988129277e12, 6.562112660889467e12, 5.062328564423772e12  …  6.007961059781737e12, 6.00795530849192e12, 4.693640193388009e12, 1.5019413969903464e12, 9.38702663392774e11, 5.25680424846356e12, 4.881376851006697e12, 3.191671488970486e12, 2.0651020518451172e12, 3.754289190514066e11], :FluidEnthalpy =&gt; [1.3525805302726221e6 1.3524709763551196e6 … 1.354325930009745e6 1.3541561482441768e6], :Temperature =&gt; [323.2354869230154, 323.2096227812559, 323.2014970845008, 323.2028226118004, 323.204160434139, 323.21324731442536, 323.2543481733766, 323.20800514761976, 323.2060044236359, 323.2145474131423  …  323.6718911178218, 323.67176897212164, 323.6666013197659, 323.66170219843326, 323.6566840597986, 323.66117034844353, 323.6652659241702, 323.66554527609765, 323.6497308977626, 323.6098839672005]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.95517875109517, 13.658855384074696, 7.128743908847061], :Pressure =&gt; [4.1064838193791304e6, 4.1195840073744105e6, 4.200868456544883e6, 4.269646808034617e6], :PhaseMassDensities =&gt; [967.2212268635795 967.2277806364366 967.2683526418756 967.302696179852], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.60407606633464 364.6362827994468 243.10105205676945 243.10968352929783], :TotalThermalEnergy =&gt; [4.3218822705951357e8, 5.556693820483618e8, 3.7044135663069546e8, 3.7043719314503837e8], :FluidEnthalpy =&gt; [1.5281596689818192e6 1.5281595796029128e6 1.5281593678273554e6 1.528159088668758e6], :Temperature =&gt; [363.1499999826712, 363.1492896320671, 363.1449237715476, 363.1412082678241]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.1329654225115, -14.431213660033384, -6.934283557954644], :Pressure =&gt; [2.5e6, 2.5640450671581742e6, 2.675565352074761e6, 2.7601091598211788e6], :PhaseMassDensities =&gt; [988.9864938379742 989.0169772366423 988.9933196844593 988.9814697555514], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.985985663818 372.8506163954664 248.56113180560635 248.55815359363814], :TotalThermalEnergy =&gt; [3.916840575176927e8, 5.035851951654551e8, 3.3586694690161926e8, 3.359635103344358e8], :FluidEnthalpy =&gt; [1.3532277944578365e6 1.353227794715173e6 1.3539501826905133e6 1.354440385719942e6], :Temperature =&gt; [323.44769802925157, 323.44359278622244, 323.6052286475252, 323.71431318427557]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024955050156953637, -0.0038887988064156462, 0.00441133661826023], :Pressure =&gt; [3.402277238149363e6, 3.4410847909504287e6, 3.5380400057240487e6, 3.615595334999557e6], :PhaseMassDensities =&gt; [988.6743724903204 988.687743573711 988.5690249763375 988.6540872382158], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.894466904755 372.7264982286529 248.45449491456694 248.47587339272812], :TotalThermalEnergy =&gt; [3.933002525091494e8, 5.0568143238714224e8, 3.374323160981656e8, 3.373320108508784e8], :FluidEnthalpy =&gt; [1.360142732315533e6 1.3601895577600887e6 1.3617041730466872e6 1.3612617774591567e6], :Temperature =&gt; [325.0034033296696, 325.01177977660643, 325.35841879459974, 325.2502490551018]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.132965423205935, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 8), :SurfaceTemperature =&gt; [363.1499999826712, 323.44769802925157, 325.0034033296696]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.4426986444360698e6, 3.44669446598431e6, 3.4815084143197443e6, 3.5322963462993344e6, 3.562025558859215e6, 3.5883063706737887e6, 3.615078840362639e6, 3.624690047268901e6, 3.6259518208478596e6, 3.628541815040136e6  …  3.3508486092424286e6, 3.3688419063466988e6, 3.390184179682835e6, 3.425333567252933e6, 3.323005182289752e6, 3.324441169867729e6, 3.3267024425035105e6, 3.332571132395934e6, 3.344012308791871e6, 3.3468083476475202e6], :TotalMasses =&gt; [455962.93454407575 1.4185698813300184e6 … 557158.2620217516 101303.45859169248], :TotalThermalEnergy =&gt; [1.6875620099839175e12, 5.249811660527602e12, 7.499538925610796e12, 7.687041712315542e12, 8.249551397168031e12, 8.24986339299269e12, 8.251255251059265e12, 7.49965420180144e12, 6.562144057162758e12, 5.06235450104502e12  …  6.007917398348441e12, 6.007909752822641e12, 4.693605766707385e12, 1.5019303350143623e12, 9.38695404298146e11, 5.256765362932417e12, 4.881340734645105e12, 3.191646429105886e12, 2.0650835709450244e12, 3.7542615382730286e11], :FluidEnthalpy =&gt; [1.3525835861315068e6 1.3524796907650335e6 … 1.3543128966087282e6 1.3541454088294504e6], :Temperature =&gt; [323.2362872451902, 323.2117558830357, 323.20348802559744, 323.20469687482023, 323.206808496356, 323.21990592144994, 323.27730424270493, 323.21032034773236, 323.2075825272352, 323.2162405683035  …  323.66942624719024, 323.66919707024624, 323.6641130734184, 323.6592030059801, 323.6540615750806, 323.65866168431313, 323.6627566774658, 323.6628825156036, 323.6466962025462, 323.60738613771883]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.955178751007377, 13.660693353397132, 7.129486495280375], :Pressure =&gt; [4.1016174019300593e6, 4.1147175014455654e6, 4.195999912998126e6, 4.264777346219595e6], :PhaseMassDensities =&gt; [967.2189681591462 967.2255156557978 967.2660725842986 967.3003937643848], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.60341377960424 364.63542892186257 243.10047901579875 243.10910486917646], :TotalThermalEnergy =&gt; [4.321883123817515e8, 5.556695069967134e8, 3.704414605941776e8, 3.7043732491224813e8], :FluidEnthalpy =&gt; [1.528158507126928e6 1.5281584693982562e6 1.5281583643861338e6 1.5281582340018635e6], :Temperature =&gt; [363.14999998406046, 363.14930215028454, 363.14496120969824, 363.1412785009751]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.133175615822783, -14.431005057659137, -6.9339478548299045], :Pressure =&gt; [2.5e6, 2.5640451905060476e6, 2.6755650697701066e6, 2.7601084409521236e6], :PhaseMassDensities =&gt; [988.984241459247 989.0147249727481 988.9916201878023 988.9806473309935], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.9853252318815 372.8497673119819 248.56070467550933 248.55794689580222], :TotalThermalEnergy =&gt; [3.916893147130787e8, 5.035919547153521e8, 3.358703468624544e8, 3.3596515513432825e8], :FluidEnthalpy =&gt; [1.353249005566481e6 1.3532490059387346e6 1.353966187644966e6 1.3544481286995634e6], :Temperature =&gt; [323.4526552738347, 323.4485499153533, 323.60896881067737, 323.7161225672449]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.02495501659491473, -0.00346042862657838, 0.004796196119499196], :Pressure =&gt; [3.401656746933172e6, 3.4404500118081197e6, 3.537368146134233e6, 3.614894600852954e6], :PhaseMassDensities =&gt; [988.3107943737841 988.3228427610727 988.1864327477301 988.3103934107512], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.7878602330295 372.58893386318005 248.35833899978988 248.38949371245235], :TotalThermalEnergy =&gt; [3.941226047136531e8, 5.0674260831151366e8, 3.381738886612902e8, 3.3799825340099216e8], :FluidEnthalpy =&gt; [1.3634802446459762e6 1.3635392284515079e6 1.3652165963473131e6 1.3644167087801637e6], :Temperature =&gt; [325.78124769000516, 325.79244693075594, 326.1769405493251, 325.98546733253045]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.133175616827337, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 9), :SurfaceTemperature =&gt; [363.14999998406046, 323.4526552738347, 325.78124769000516]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.4413128166946e6, 3.4451423750892715e6, 3.4795808429561364e6, 3.529831788066178e6, 3.5592307262321147e6, 3.585212032914934e6, 3.611634969788024e6, 3.6210993998044487e6, 3.622347839738723e6, 3.6249624292807104e6  …  3.3506409368523997e6, 3.368611138674842e6, 3.3899095938075776e6, 3.4249800651096073e6, 3.3228236659941566e6, 3.3242594690605975e6, 3.3265199613021216e6, 3.3323827273971573e6, 3.343806124602725e6, 3.346581047104174e6], :TotalMasses =&gt; [455962.4615272919 1.4185675234682506e6 … 557158.9740656196 101303.56104977908], :TotalThermalEnergy =&gt; [1.6875665815725435e12, 5.249844492629746e12, 7.499582999247401e12, 7.687085836915895e12, 8.249627419033535e12, 8.250068756075848e12, 8.251939375560809e12, 7.499712811268742e12, 6.562175280313621e12, 5.062380220716523e12  …  6.007874129320269e12, 6.007864763713878e12, 4.69357179765093e12, 1.501919486508731e12, 9.386882350080316e11, 5.256726925324174e12, 4.881305004548344e12, 3.191621614050455e12, 2.065065397992776e12, 3.7542347000617566e11], :FluidEnthalpy =&gt; [1.3525870585401477e6 1.352488243672842e6 … 1.3543000631921066e6 1.3541349655186138e6], :Temperature =&gt; [323.2371883067345, 323.2138546308989, 323.205454789556, 323.20661122064575, 323.20989503712264, 323.2282945630846, 323.3053278556528, 323.2129242931326, 323.20915188302797, 323.21791938938037  …  323.6669829447574, 323.6666564872606, 323.6616571303553, 323.65675107938364, 323.6514710640627, 323.65618144521017, 323.66027378797196, 323.660245261328, 323.6437114842355, 323.6049611495549]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.955178750949447, 13.66204430100408, 7.130195702213106], :Pressure =&gt; [4.0970308338423646e6, 4.110130850006279e6, 4.191411718267222e6, 4.260188277923923e6], :PhaseMassDensities =&gt; [967.2168393445709 967.2233829657634 967.2639338328045 967.2982433886405], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.6027895785694 364.6346249166612 243.0999414889202 243.10856442080518], :TotalThermalEnergy =&gt; [4.321883927923612e8, 5.556696176739727e8, 3.704415459214242e8, 3.704374245039909e8], :FluidEnthalpy =&gt; [1.5281574120626918e6 1.5281574003767972e6 1.52815735087019e6 1.528157296658135e6], :Temperature =&gt; [363.14999998497717, 363.1493078863933, 363.14498153580774, 363.14131561408277]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.133360933677253, -14.430776701311569, -6.933551026102193], :Pressure =&gt; [2.5e6, 2.5640452454563812e6, 2.6755645899985395e6, 2.7601073822698775e6], :PhaseMassDensities =&gt; [988.9808900383277 989.0113736603694 988.9888014818004 988.9788842826395], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.9843425439432 372.84850389698005 248.55999625742388 248.55750379342163], :TotalThermalEnergy =&gt; [3.916971370993803e8, 5.036020125342495e8, 3.3587598584390265e8, 3.3596868153217e8], :FluidEnthalpy =&gt; [1.3532805666076625e6 1.3532805671615517e6 1.3539927326848048e6 1.3544647296506234e6], :Temperature =&gt; [323.4600313926891, 323.45592587313394, 323.615172059742, 323.72000185212914]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024954981607230343, -0.003179227132199756, 0.005053628840969035], :Pressure =&gt; [3.400747086994155e6, 3.4395229836169938e6, 3.5363962102065715e6, 3.613887580584441e6], :PhaseMassDensities =&gt; [987.8687681693434 987.8793373481424 987.7198110338064 987.8891755500663], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.6582513805501 372.4217362615293 248.24106417191243 248.28363011751728], :TotalThermalEnergy =&gt; [3.9511213218324983e8, 5.0801862897060907e8, 3.3905807366416883e8, 3.388019943452175e8], :FluidEnthalpy =&gt; [1.3675056084935502e6 1.3675767255147798e6 1.3694223721869062e6 1.3682346403520498e6], :Temperature =&gt; [326.7186421993504, 326.7326270336403, 327.155358374447, 326.8741240576482]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.13336093517198, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 10), :SurfaceTemperature =&gt; [363.14999998497717, 323.4600313926891, 326.7186421993504]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ⋮</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.755577892001943e6, 2.7198582373311114e6, 2.6747524832259077e6, 2.618674817273792e6, 2.585779737627181e6, 2.557671485461973e6, 2.5294317218785784e6, 2.5198752413078113e6, 2.517325185137377e6, 2.5194319176912582e6  …  3.2439231928317877e6, 3.2168906864956846e6, 3.1788868543398087e6, 3.1212243551698844e6, 3.2763481748619894e6, 3.277007923412726e6, 3.276855100457955e6, 3.2688076910260865e6, 3.2409869528838983e6, 3.201365761318266e6], :TotalMasses =&gt; [455646.28734826366 1.4174955471677857e6 … 557392.2490090135 101360.65226943721], :TotalThermalEnergy =&gt; [1.6917799413819521e12, 5.264460266124529e12, 7.521003675222407e12, 7.716522238204116e12, 8.296746320497607e12, 8.325477500921841e12, 8.360322912625338e12, 7.58566271798199e12, 6.5808214931143955e12, 5.065265247879221e12  …  5.946390631183806e12, 5.939678117004162e12, 4.648496731005837e12, 1.4878945392060127e12, 9.380959371129585e11, 5.252983216944197e12, 4.872734503863775e12, 3.184991050025707e12, 2.0589027574358975e12, 3.739025702368727e11], :FluidEnthalpy =&gt; [1.3559812112255658e6 1.3562856023000018e6 … 1.3499384088930252e6 1.3482154321068916e6], :Temperature =&gt; [324.07464887926085, 324.1480899818577, 324.1632155109733, 324.4927436532606, 325.13329652411306, 326.31369878031603, 327.74693913108223, 327.0846233811038, 324.1585267825409, 323.39820840509503  …  320.2007284558261, 319.8226749142216, 320.407328593679, 320.49123191506015, 323.4371034342907, 323.41428659954744, 323.06468593881493, 322.95548425330827, 322.63131202928435, 322.2308953081002]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-24.95517900588424, -13.673391389165769, -7.1661519346272815], :Pressure =&gt; [1.838683734304254e6, 1.9021045046925268e6, 2.0117573950427966e6, 2.0956633666706367e6], :PhaseMassDensities =&gt; [977.6663103313122 977.6974382988358 977.9160138345395 977.8706241600684], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.66673449858166 368.583250751182 245.77710119123233 245.76569352180294], :TotalThermalEnergy =&gt; [4.13789263557254e8, 5.3200779102693963e8, 3.5441577516309786e8, 3.545405416405347e8], :FluidEnthalpy =&gt; [1.4453312642329647e6 1.4453311875833455e6 1.4440783263498137e6 1.444738825030539e6], :Temperature =&gt; [344.7258898708331, 344.72188680848217, 344.43031482501135, 344.57520825682116]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [25.2091503946736, 14.55771880998444, 7.010405363800513], :Pressure =&gt; [4.5e6, 4.514213329750277e6, 4.598012689890617e6, 4.669624452439166e6], :PhaseMassDensities =&gt; [1001.7883063999748 1001.795071680257 1001.834957422489 1001.8690234168637], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.73967315824336 377.66784451117877 251.78858738783478 251.79714910604798], :TotalThermalEnergy =&gt; [3.4756334759743816e8, 4.468648289440962e8, 2.979007283877413e8, 2.978928949020069e8], :FluidEnthalpy =&gt; [1.187727938690787e6 1.1877279302311281e6 1.1877279193679774e6 1.187727901581742e6], :Temperature =&gt; [283.15, 283.1501457082382, 283.1510155637606, 283.15169686030634]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024955431236216654, -0.01835001454628008, -0.013053881356116806], :Pressure =&gt; [2.665123150936284e6, 2.704010008460966e6, 2.8011950414355574e6, 2.8789538121135337e6], :PhaseMassDensities =&gt; [990.6885983584214 990.7169076129437 990.9318760906492 991.0322816961577], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.485068775812 373.4914750492827 249.0483441707468 249.07357885175838], :TotalThermalEnergy =&gt; [3.877634730928989e8, 4.985158285308289e8, 3.319729695479084e8, 3.3182947058060896e8], :FluidEnthalpy =&gt; [1.3375728041815811e6 1.3374742120211774e6 1.3357928066403917e6 1.335159803482119e6], :Temperature =&gt; [319.7702341077675, 319.7446233464771, 319.3435511972998, 319.1899869851562]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [-24.95517875, 25.2091503946736, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; InjectorControl{BottomHolePressureTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(BottomHolePressureTarget with value 45.0 [bar], [1.0], 998.20715, ((1, 1.0),), 283.15, missing, 1.0, missing), :WellA =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -0.025 [m^3/s], 1.0)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; InjectorControl{BottomHolePressureTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(BottomHolePressureTarget with value 45.0 [bar], [1.0], 998.20715, ((1, 1.0),), 283.15, missing, 1.0, missing), :WellA =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -0.025 [m^3/s], 1.0)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = 1.0e-20, bhp = 4.5e6), :WellA =&gt; (bhp = 10000.0, rate = -0.025)), 232), :SurfaceTemperature =&gt; [344.7258898708331, 283.15, 319.7702341077675]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.818203335767857e6, 2.8035285350698764e6, 2.8003864306447254e6, 2.8001820886321366e6, 2.7998803212728454e6, 2.7998624643570073e6, 2.79982554673724e6, 2.800097124656852e6, 2.799442729039157e6, 2.801734925042117e6  …  2.972571400701136e6, 2.972451343349944e6, 2.9699967521788767e6, 2.967265992798186e6, 2.968734066039789e6, 2.969854413151418e6, 2.971132233634172e6, 2.9714802801380507e6, 2.9672388632361777e6, 2.952963125924416e6], :TotalMasses =&gt; [455658.3971910125 1.4175452355866602e6 … 557329.8647157914 101350.60346527466], :TotalThermalEnergy =&gt; [1.6917946246766743e12, 5.264536737627264e12, 7.521170976916244e12, 7.716764631016145e12, 8.297082788806846e12, 8.325871023241117e12, 8.360769855442922e12, 7.586066270776015e12, 6.581184117195176e12, 5.065503983204257e12  …  5.946044061967721e12, 5.939284199510518e12, 4.64826484772098e12, 1.4878363648643203e12, 9.380504381790695e11, 5.252724625188979e12, 4.872474331824915e12, 3.184795421530217e12, 2.0587713175067852e12, 3.73874131975826e11], :FluidEnthalpy =&gt; [1.3560141857265197e6 1.3563339238147344e6 … 1.349757099082677e6 1.3480253146851207e6], :Temperature =&gt; [324.0782944930841, 324.1539543580074, 324.17216777868873, 324.5054320809792, 325.1494435960946, 326.3324148301601, 327.7680618814167, 327.10577010566675, 324.1803874239134, 323.4173962931644  …  320.1778422545208, 319.7974248034869, 320.3880188702562, 320.47621496689175, 323.4171849484842, 323.39412636284175, 323.0431164138679, 322.93129131134884, 322.60656491764144, 322.20233326567524]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-1.4573767402340787e-7, -0.0031869928921854024, -0.0025753040981861446], :Pressure =&gt; [2.7586619858024833e6, 2.7970256810477814e6, 2.8929556163061075e6, 2.969709582209938e6], :PhaseMassDensities =&gt; [977.993077889316 978.0110161999835 978.3501864083358 978.2657422606836], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.7625477508163 368.70146683485086 245.88622066069064 245.8649975315784], :TotalThermalEnergy =&gt; [4.13927587030479e8, 5.321902655554528e8, 3.543459379877439e8, 3.545255649401306e8], :FluidEnthalpy =&gt; [1.4462713915213835e6 1.44627772699934e6 1.4440541486325616e6 1.444987850777911e6], :Temperature =&gt; [344.8812912430673, 344.88029141685274, 344.368801737378, 344.57632695169735]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [3.516662744963896e-7, 0.0009837635644629858, 0.0007484703096861584], :Pressure =&gt; [2.757417652104827e6, 2.7966831510361587e6, 2.8948474171961215e6, 2.973382174433071e6], :PhaseMassDensities =&gt; [1000.9998133255142 1000.9834981193181 1001.0304331511281 1001.0677734341205], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.5084749135644 377.3618884867516 251.58638838459143 251.59577302128997], :TotalThermalEnergy =&gt; [3.4728914914567506e8, 4.4704089511444163e8, 2.98015746790867e8, 2.980086431770895e8], :FluidEnthalpy =&gt; [1.185988467051255e6 1.187441640225889e6 1.1874382522019378e6 1.1874441769713277e6], :Temperature =&gt; [282.6701857339688, 283.0539715971946, 283.0544787926068, 283.0571609617076]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-1.532928189210982e-8, 0.0013630570190218952, 0.0010485375924921417], :Pressure =&gt; [2.7575980028479337e6, 2.7964581047188328e6, 2.8936143156420696e6, 2.971357711390925e6], :PhaseMassDensities =&gt; [990.7229691056132 990.590825899033 990.8722380030952 991.059516496329], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.4951468052538 373.4439433629418 249.03335548452807 249.0804237036096], :TotalThermalEnergy =&gt; [3.8777696922784543e8, 4.990484721368437e8, 3.321858470437586e8, 3.3185622667421114e8], :FluidEnthalpy =&gt; [1.3376662001639758e6 1.3391640723955932e6 1.3368212904417508e6 1.3353237696213804e6], :Temperature =&gt; [319.7863430555869, 320.1357153434539, 319.5793241300573, 319.22271168754907]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 233), :SurfaceTemperature =&gt; [344.8812912430673, 282.6701857339688, 319.7863430555869]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.8175512949147476e6, 2.802938254692206e6, 2.799916868235468e6, 2.7998600702063744e6, 2.7996358526723264e6, 2.7996966332930643e6, 2.7997406156996125e6, 2.800051246746608e6, 2.7994403644300466e6, 2.8017943161533526e6  …  2.9708064362476864e6, 2.970827142683581e6, 2.9684909522858984e6, 2.9659421309544668e6, 2.9667399706249572e6, 2.967862671569076e6, 2.9691667168397624e6, 2.9695593614763245e6, 2.965447823450193e6, 2.951315312360012e6], :TotalMasses =&gt; [455658.3419017301 1.4175445523540492e6 … 557331.3747633059 101351.14812846539], :TotalThermalEnergy =&gt; [1.6917927865124634e12, 5.264544117577689e12, 7.521191454172545e12, 7.716791211161847e12, 8.297145852644867e12, 8.325955260402793e12, 8.360865995651801e12, 7.586135253350494e12, 6.581254994095508e12, 5.065521540275752e12  …  5.945943157732922e12, 5.939103823536082e12, 4.648178124847508e12, 1.4878134474969385e12, 9.380490692933936e11, 5.252712756044301e12, 4.872440827810918e12, 3.1847438361169023e12, 2.0587247637862764e12, 3.7385893846089465e11], :FluidEnthalpy =&gt; [1.3560123952442529e6 1.3563357688782092e6 … 1.3497238314609365e6 1.3479662945485434e6], :Temperature =&gt; [324.07791839493234, 324.1544237431961, 324.17308701880745, 324.50660023753915, 325.1520319065388, 326.3358752133558, 327.7720170397861, 327.10889135913936, 324.18404434867057, 323.418570975931  …  320.17214139621433, 319.78725401719646, 320.3817483068564, 320.47103521213825, 323.4166679589659, 323.39333837181204, 323.0407676459553, 322.925791740226, 322.59890542670934, 322.1886143092345]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [3.5391503277121546e-11, -0.0032092897434374975, -0.002590224843155525], :Pressure =&gt; [2.7584345880403775e6, 2.796798352419581e6, 2.892728634732298e6, 2.969483003340798e6], :PhaseMassDensities =&gt; [977.9929985356728 978.0146278836576 978.3531978897249 978.2726164883684], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.7625244831128 368.70282840751855 245.8869775285153 245.86672521343388], :TotalThermalEnergy =&gt; [4.139275506761044e8, 5.321819196757795e8, 3.543411774906129e8, 3.545151050761947e8], :FluidEnthalpy =&gt; [1.4462711495808887e6 1.4462495178510265e6 1.444030111158092e6 1.444934922555531e6], :Temperature =&gt; [344.8812507497134, 344.8738989016999, 344.36334307188076, 344.56431841220126]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [3.228033153009694e-10, 0.0009604766858208677, 0.0007384806576925775], :Pressure =&gt; [2.7558226848888625e6, 2.7950881149367695e6, 2.8932521309453812e6, 2.9717866831777673e6], :PhaseMassDensities =&gt; [1000.9990895465924 1000.9806920079875 1001.0276630071542 1001.0650629089585], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.5082626905003 377.3608306077026 251.5856921714748 251.59509179201507], :TotalThermalEnergy =&gt; [3.472888978240215e8, 4.470722018535386e8, 2.980362206635766e8, 2.9802848881401783e8], :FluidEnthalpy =&gt; [1.185986874944933e6 1.1875263379255296e6 1.1875213238720724e6 1.1875246776195366e6], :Temperature =&gt; [282.66974000165413, 283.0762839859665, 283.0763511161447, 283.07834696194936]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [9.928159849595754e-11, 0.0013594435041083153, 0.0010547229259590416], :Pressure =&gt; [2.756999695622414e6, 2.7958596588410656e6, 2.893015297052852e6, 2.9707584992529443e6], :PhaseMassDensities =&gt; [990.7227464999573 990.583979995092 990.8673301623495 991.0596478809521], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.4950815338665 373.44136251795845 249.03212200961357 249.0804567241669], :TotalThermalEnergy =&gt; [3.8777688247692853e8, 4.990696288950227e8, 3.321958079664203e8, 3.318553931790689e8], :FluidEnthalpy =&gt; [1.3376655981832866e6 1.339229376688915e6 1.336867305824442e6 1.3353196416912854e6], :Temperature =&gt; [319.7862393686893, 320.1510915818087, 319.590169777283, 319.2217796666795]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 234), :SurfaceTemperature =&gt; [344.8812507497134, 282.66974000165413, 319.7862393686893]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.8166987695154035e6, 2.8020852957336204e6, 2.799063065719346e6, 2.7990051825504065e6, 2.7987802636076314e6, 2.7988404311911105e6, 2.798883393262028e6, 2.7991943188203406e6, 2.798583899772839e6, 2.8009383377819434e6  …  2.969960375516853e6, 2.9699801756770667e6, 2.9676413401250993e6, 2.965088627184504e6, 2.9658944405614845e6, 2.9670171387929046e6, 2.9683213253126526e6, 2.9687138171661794e6, 2.96460177348206e6, 2.9504684441088038e6], :TotalMasses =&gt; [455658.243609647 1.4175437085016659e6 … 557333.0998659369 101351.71899011465], :TotalThermalEnergy =&gt; [1.691791002163287e12, 5.264551367553344e12, 7.521211768867306e12, 7.716817953554846e12, 8.297209807034735e12, 8.326038127533441e12, 8.36095961654535e12, 7.586203063584578e12, 6.581324960860713e12, 5.065538412773063e12  …  5.94584277763521e12, 5.938924882972711e12, 4.648091709366714e12, 1.4877892406267012e12, 9.38047865795003e11, 5.25270160385116e12, 4.872408301059512e12, 3.184692766248092e12, 2.0586786750484055e12, 3.738439893331816e11], :FluidEnthalpy =&gt; [1.3560105857797314e6 1.35633749263597e6 … 1.349691197043888e6 1.3479084750972483e6], :Temperature =&gt; [324.0775508547331, 324.1548818187183, 324.1739946409317, 324.50776966540855, 325.1546501831594, 326.33927206072434, 327.7758607569704, 327.1119512391178, 324.1876448094962, 323.4196894584248  …  320.1664815430757, 319.77717387085596, 320.3755122688572, 320.4655707742331, 323.41622377723377, 323.39260968059085, 323.03849963452893, 322.92035934656974, 322.5913332684742, 322.17512520264785]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.3563054027836187e-10, -0.00320934081346971, -0.002591839169751303], :Pressure =&gt; [2.75757658628218e6, 2.7959403798351483e6, 2.8918706252122135e6, 2.968625019966824e6], :PhaseMassDensities =&gt; [977.9926944301112 978.0164194434491 978.3506520092889 978.275787750887], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.762435314705 368.7035038096481 245.88633767897332 245.86752223863638], :TotalThermalEnergy =&gt; [4.139274217144764e8, 5.321770418312857e8, 3.54344494825342e8, 3.545097822489033e8], :FluidEnthalpy =&gt; [1.44627027227216e6 1.44623276158894e6 1.4440464831755857e6 1.444907712326539e6], :Temperature =&gt; [344.8811060405665, 344.8701476929915, 344.367125654771, 344.55819203412557]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.6880190043768681e-10, 0.0009855211992242175, 0.000756818863307285], :Pressure =&gt; [2.754988604626526e6, 2.79425401063719e6, 2.8924179204019e6, 2.970952389968373e6], :PhaseMassDensities =&gt; [1000.9987110650118 1000.9798448627304 1001.0268538544301 1001.0642319186018], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.5081517139047 377.3605112414646 251.5854888092145 251.5948829413591], :TotalThermalEnergy =&gt; [3.472887662084432e8, 4.470791561202989e8, 2.980404652463824e8, 2.980329482280729e8], :FluidEnthalpy =&gt; [1.1859860417009587e6 1.1875449383684946e6 1.1875383217516777e6 1.187542554567418e6], :Temperature =&gt; [282.6695067315129, 283.08117727404033, 283.08081947670473, 283.08304508800074]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.4275136574225597e-10, 0.0013375838822038421, 0.0010401922953960877], :Pressure =&gt; [2.7561386750594275e6, 2.794998648818762e6, 2.8921544089680826e6, 2.9698977381007113e6], :PhaseMassDensities =&gt; [990.7224264283548 990.5848374929365 990.8685137495429 991.0613297875746], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.4949876839709 373.4416857870299 249.03241947752008 249.08087943340607], :TotalThermalEnergy =&gt; [3.877767569373664e8, 4.990656857888318e8, 3.321924797553819e8, 3.3185099624168974e8], :FluidEnthalpy =&gt; [1.3376647291004758e6 1.339216789366883e6 1.3368514755524637e6 1.3352988543782902e6], :Temperature =&gt; [319.7860895014474, 320.1481895799871, 319.586505733157, 319.2169511210946]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 235), :SurfaceTemperature =&gt; [344.8811060405665, 282.6695067315129, 319.7860895014474]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.815832405659472e6, 2.801218940549784e6, 2.798196723425729e6, 2.7981388615910737e6, 2.797913958193965e6, 2.797974112943378e6, 2.7980170453986195e6, 2.798327985783071e6, 2.797717588401537e6, 2.800072014321572e6  …  2.9690941833652444e6, 2.9691140086754714e6, 2.966775126986624e6, 2.964222387519421e6, 2.9650281509724627e6, 2.9661508594452273e6, 2.9674550622527953e6, 2.9678476042751647e6, 2.9637356013155244e6, 2.9496022908744346e6], :TotalMasses =&gt; [455658.1390737576 1.4175428538149083e6 … 557334.8136452761 101352.28070347883], :TotalThermalEnergy =&gt; [1.6917892995035745e12, 5.264558673809283e12, 7.521232097369475e12, 7.716844881531672e12, 8.297273866206033e12, 8.326121117093583e12, 8.361053194046072e12, 7.586270606121241e12, 6.5813948134596455e12, 5.06555528774808e12  …  5.945742447183261e12, 5.938746917009113e12, 4.64800536781726e12, 1.4877650583979153e12, 9.380466604585784e11, 5.252690435360735e12, 4.872375826847297e12, 3.184641768303294e12, 2.0586327369544087e12, 3.7382924331537164e11], :FluidEnthalpy =&gt; [1.3560088419627752e6 1.3563392275712034e6 … 1.3496586619829608e6 1.3478514315877552e6], :Temperature =&gt; [324.0771995502337, 324.155343375076, 324.1749027475639, 324.508947149122, 325.1572726520934, 326.34267383937095, 327.7797026032564, 327.11499891270074, 324.1912392762156, 323.4208079898519  …  320.1608242373642, 319.76714834671105, 320.36928135751026, 320.46011173539665, 323.4157786950635, 323.39187970172657, 323.0362350305679, 322.91493435664347, 322.5837856060764, 322.16181904987155]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.3695661724927873e-10, -0.0032098720646291223, -0.002592193769789779], :Pressure =&gt; [2.7567101953981207e6, 2.795074015572965e6, 2.8910042120357174e6, 2.967758618119988e6], :PhaseMassDensities =&gt; [977.992387351302 978.0180838601883 978.3479791823983 978.2787403628911], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.76234527449543 368.70413127997614 245.8856659243074 245.86826431097083], :TotalThermalEnergy =&gt; [4.13927291491836e8, 5.3217244154880714e8, 3.543480007069503e8, 3.545047817882312e8], :FluidEnthalpy =&gt; [1.44626938638445e6 1.446216937621262e6 1.4440638008714893e6 1.4448821277426032e6], :Temperature =&gt; [344.88095991651153, 344.8666087625838, 344.371124092687, 344.5524354611475]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.7531550713578743e-10, 0.0009860481366098597, 0.000757177826996775], :Pressure =&gt; [2.7541223402248747e6, 2.7933877231768453e6, 2.8915515576161207e6, 2.970085967614935e6], :PhaseMassDensities =&gt; [1000.9983179785819 1000.979062282107 1001.0261109650087 1001.0634654020705], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.5080364549436 377.36021621552015 251.5853021007386 251.5946902947428], :TotalThermalEnergy =&gt; [3.4728862951408637e8, 4.47084902301697e8, 2.980438886892163e8, 2.9803660572080296e8], :FluidEnthalpy =&gt; [1.1859851763044614e6 1.187560228680082e6 1.187551945065752e6 1.1875571356108119e6], :Temperature =&gt; [282.6692644582273, 283.085197252978, 283.08439798687823, 283.08687445583007]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.4365419541990122e-10, 0.0013397745244452786, 0.0010417035683181171], :Pressure =&gt; [2.7552722091714484e6, 2.7941322010679324e6, 2.891288060411594e6, 2.969031474447355e6], :PhaseMassDensities =&gt; [990.7221043325048 990.5860843260167 990.8693345878177 991.0627118989067], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.494893240535 373.4421558320273 249.0326257766796 249.08122679587066], :TotalThermalEnergy =&gt; [3.877766306040188e8, 4.99060484938288e8, 3.321899235229622e8, 3.318472366401699e8], :FluidEnthalpy =&gt; [1.3376638545213758e6 1.339200302246437e6 1.3368392291213511e6 1.335281024250824e6], :Temperature =&gt; [319.78593868640786, 320.14437194919145, 319.58368379217586, 319.2128174883999]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 236), :SurfaceTemperature =&gt; [344.88095991651153, 282.6692644582273, 319.78593868640786]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.814969922637711e6, 2.8003564691888364e6, 2.7973342635942055e6, 2.797276419185772e6, 2.797051529065916e6, 2.797111666959235e6, 2.7971545638287878e6, 2.7974655156167024e6, 2.7968551361115337e6, 2.7992095429306463e6  …  2.9682317919879546e6, 2.9682516522883885e6, 2.965912729736054e6, 2.9633599692111216e6, 2.9641656402529874e6, 2.9652883597781183e6, 2.9665925820206483e6, 2.966985178817442e6, 2.9628732282018214e6, 2.948739946402791e6], :TotalMasses =&gt; [455658.03181945067 1.4175419986932562e6 … 557336.5220160914 101352.834668316], :TotalThermalEnergy =&gt; [1.6917876803305193e12, 5.264566048864289e12, 7.521252460119796e12, 7.716872011225031e12, 8.297338050072456e12, 8.326204248492607e12, 8.361146747368975e12, 7.586337905535222e12, 6.581464572364453e12, 5.065572177879654e12  …  5.945642182602924e12, 5.938569923570598e12, 4.647919111588006e12, 1.4877409037775317e12, 9.380454566659004e11, 5.252679269532967e12, 4.87234342064323e12, 3.1845908499427676e12, 2.058586950061296e12, 3.738146916424339e11], :FluidEnthalpy =&gt; [1.3560071710985948e6 1.35634098275929e6 … 1.3496262344295892e6 1.3477951377511427e6], :Temperature =&gt; [324.076865039974, 324.15580941223527, 324.17581244443437, 324.51013356886784, 325.1599002896895, 326.3460814935758, 327.783543500191, 327.11803562811826, 324.194828957676, 323.4219275797063  …  320.1551706918677, 319.75717761913387, 320.36305664722147, 320.45465896964356, 323.4153342132119, 323.3911499374365, 323.03397519215275, 322.90951786654443, 322.5762628099249, 322.14868821844334]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.3634338550478862e-10, -0.003210439942720198, -0.0025925956485163813], :Pressure =&gt; [2.7558476819875343e6, 2.794211528538499e6, 2.8901416796706514e6, 2.966896097396716e6], :PhaseMassDensities =&gt; [977.9920816467873 978.0197343725432 978.3453926004811 978.2816134819941], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.76225563725006 368.7047535084748 245.8850158453675 245.8689864045602], :TotalThermalEnergy =&gt; [4.1392716185219806e8, 5.32167876361698e8, 3.5435137722438323e8, 3.544999030986524e8], :FluidEnthalpy =&gt; [1.446268504461638e6 1.4462012334178316e6 1.4440804692107793e6 1.4448571599543034e6], :Temperature =&gt; [344.88081444669604, 344.863096785601, 344.3749744234438, 344.5468187446122]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.745422189782811e-10, 0.0009865612292880989, 0.0007575317107530817], :Pressure =&gt; [2.753259897599807e6, 2.792525257591673e6, 2.8906890170156094e6, 2.9692233677319186e6], :PhaseMassDensities =&gt; [1000.9979266257261 1000.9782829953556 1001.0253708259081 1001.062703277426], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.507921704293 377.3599224313362 251.58511608349372 251.59449875192806], :TotalThermalEnergy =&gt; [3.472884934227984e8, 4.4709062567564857e8, 2.9804730243651867e8, 2.980402369666277e8], :FluidEnthalpy =&gt; [1.1859843147260027e6 1.1875754584863146e6 1.1875655304176973e6 1.1875716109625497e6], :Temperature =&gt; [282.6690232518797, 283.0892013782002, 283.08796658697315, 283.0906760766205]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.4301338293501775e-10, 0.0013419193654837778, 0.0010431728786649294], :Pressure =&gt; [2.7544096065587783e6, 2.7932696169242375e6, 2.890425575660225e6, 2.9681690732858134e6], :PhaseMassDensities =&gt; [990.7217836728155 990.5873466413573 990.8701430476596 991.0640718389474], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.4947992182034 373.44263171369937 249.0328289647996 249.08156858608194], :TotalThermalEnergy =&gt; [3.8777650483392423e8, 4.9905523969986933e8, 3.321873973619823e8, 3.318435280988e8], :FluidEnthalpy =&gt; [1.3376629838410162e6 1.3391836792759148e6 1.336827124063143e6 1.3352634329355354e6], :Temperature =&gt; [319.7857885436318, 320.1405221604477, 319.58089480986433, 319.2087396991435]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 237), :SurfaceTemperature =&gt; [344.88081444669604, 282.6690232518797, 319.7857885436318]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.8141094456182066e6, 2.7994960046699047e6, 2.7964738124943133e6, 2.79641598799647e6, 2.79619111266997e6, 2.796251235610012e6, 2.7962940993943815e6, 2.7966050642349334e6, 2.7959947041566186e6, 2.798349093282062e6  …  2.9673714242318277e6, 2.967391318562942e6, 2.965052354668466e6, 2.962499571926017e6, 2.9633051536159203e6, 2.9644278843523734e6, 2.965732126213414e6, 2.966124777725425e6, 2.9620128787410287e6, 2.947879624534025e6], :TotalMasses =&gt; [455657.9215966272 1.4175411420952152e6 … 557338.2247157714 101353.3811551855], :TotalThermalEnergy =&gt; [1.6917861415279565e12, 5.264573489261084e12, 7.521272854967971e12, 7.716899336650784e12, 8.297402353419508e12, 8.326287515631143e12, 8.361240270301057e12, 7.586404963842599e12, 6.581534236870098e12, 5.065589082026796e12  …  5.945541983583083e12, 5.93839389025085e12, 4.647832941652095e12, 1.4877167770514385e12, 9.380442540749832e11, 5.252668104783739e12, 4.87231108031424e12, 3.184540009495085e12, 2.058541310127871e12, 3.738003256969192e11], :FluidEnthalpy =&gt; [1.3560055699016e6 1.3563427566355118e6 … 1.34959391082881e6 1.3477395598242506e6], :Temperature =&gt; [324.07654667778394, 324.1562796863087, 324.17672361359683, 324.51132864025516, 325.1625328615217, 326.3494947532123, 327.7873831734776, 327.12106145763545, 324.1984137970022, 323.42304813084695  …  320.1495208668238, 319.74726096694724, 320.35683818577064, 320.44921251901724, 323.4148901881972, 323.3904202655611, 323.0317199509232, 322.90410967839097, 322.5687641632719, 322.1357249154762]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.3602532655214324e-10, -0.003211031625066581, -0.002593021673848275], :Pressure =&gt; [2.754987181114944e6, 2.7933510539224064e6, 2.8892811640377287e6, 2.966035594295781e6], :PhaseMassDensities =&gt; [977.991776655599 978.0213780724935 978.3429003218789 978.2844143758203], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.7621662091629 368.70537316875743 245.8843894674357 245.86969034595765], :TotalThermalEnergy =&gt; [4.139270325152019e8, 5.321633284773294e8, 3.5435461079509115e8, 3.544951340512253e8], :FluidEnthalpy =&gt; [1.4462676245966004e6 1.446185588326815e6 1.444096419144351e6 1.4448327469808923e6], :Temperature =&gt; [344.88066931653134, 344.85959810511804, 344.37866104473056, 344.54132792426554]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.7413540280284382e-10, 0.000987071921304946, 0.0007578844875633802], :Pressure =&gt; [2.752399465949113e6, 2.791664802976849e6, 2.889828487221148e6, 2.96836277854815e6], :PhaseMassDensities =&gt; [1000.9975361847694 1000.9775025915183 1001.024628404385 1001.0619406844696], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.50780722102513 377.35962822602073 251.5849294926135 251.5943070914137], :TotalThermalEnergy =&gt; [3.4728835764871055e8, 4.4709638038755816e8, 2.9805074881053686e8, 2.980438824907165e8], :FluidEnthalpy =&gt; [1.1859834551561428e6 1.1875907746959517e6 1.1875792501909619e6 1.1875861456516064e6], :Temperature =&gt; [282.66878260592875, 283.09322836559863, 283.0915706876234, 283.0944934043347]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.4267991984478266e-10, 0.0013440279797907195, 0.0010446179067251276], :Pressure =&gt; [2.753549016430556e6, 2.7924090451740767e6, 2.889565103109688e6, 2.967308684117392e6], :PhaseMassDensities =&gt; [990.7214637612335 990.5886035732741 990.8709522222027 991.0654251501487], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.49470541522834 373.44310556586845 249.03303233254363 249.0819087102842], :TotalThermalEnergy =&gt; [3.877763793573535e8, 4.9905001451961565e8, 3.3218487152129686e8, 3.3183983560809827e8], :FluidEnthalpy =&gt; [1.3376621151917656e6 1.3391671193685036e6 1.3368150213773546e6 1.3352459170688973e6], :Temperature =&gt; [319.78563875108983, 320.1366870507733, 319.57810625454243, 319.20467949894567]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 238), :SurfaceTemperature =&gt; [344.88066931653134, 282.66878260592875, 319.78563875108983]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.813252461250288e6, 2.798639032056964e6, 2.795616851663495e6, 2.7955590448939605e6, 2.7953341830778336e6, 2.7953942895219177e6, 2.795437118310228e6, 2.7957480951031465e6, 2.7951377533631693e6, 2.797492123992623e6  …  2.966514535633639e6, 2.9665344650517036e6, 2.9641954607633427e6, 2.9616426567900777e6, 2.9624481456193724e6, 2.96357088745675e6, 2.964875148841589e6, 2.965267854951159e6, 2.961156008182359e6, 2.9470227824989134e6], :TotalMasses =&gt; [455657.8087976341 1.4175402849875828e6 … 557339.9222322248 101353.92055451787], :TotalThermalEnergy =&gt; [1.6917846809478477e12, 5.264580994336438e12, 7.52129328359648e12, 7.716926855807166e12, 8.297466775145145e12, 8.326370916446849e12, 8.361333760887074e12, 7.586471786569348e12, 6.581603809627387e12, 5.06560600159457e12  …  5.945441852910088e12, 5.938218807826433e12, 4.647746861292563e12, 1.4876926792104814e12, 9.380430528112142e11, 5.252656942148177e12, 4.872278806194874e12, 3.1844892469953813e12, 2.0584958141380103e12, 3.737861375127915e11], :FluidEnthalpy =&gt; [1.3560040370106406e6 1.3563445494997976e6 … 1.3495616895340327e6 1.3476846676033945e6], :Temperature =&gt; [324.07624404929163, 324.1567541710746, 324.1776363475082, 324.51253229135386, 325.1651703382968, 326.3529135489326, 327.7912215574126, 327.1240766662948, 324.20199394719435, 323.42416975383617  …  320.14387493728, 319.7373978892379, 320.3506262278206, 320.4437726248963, 323.41444668187444, 323.38969076943175, 323.02946934686537, 322.8987098127134, 322.5612891881044, 322.1229219738813]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.354747383375302e-10, -0.003211651792985488, -0.0025934749899827634], :Pressure =&gt; [2.7541301644534483e6, 2.7924940634362977e6, 2.8884241368586253e6, 2.9651785806188206e6], :PhaseMassDensities =&gt; [977.9914728994313 978.0230164019586 978.3405010144575 978.287146334747], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.7620771432027 368.7059908044148 245.88378645571018 245.87037696212516], :TotalThermalEnergy =&gt; [4.1392690370189995e8, 5.3215879611086786e8, 3.5435770445075023e8, 3.5449047068387914e8], :FluidEnthalpy =&gt; [1.4462667482935006e6 1.446169996879447e6 1.444111666462458e6 1.4448088693427162e6], :Temperature =&gt; [344.8805247740817, 344.8561113855008, 344.3821874584837, 344.53595848195204]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.734301863025572e-10, 0.0009875776191619217, 0.0007582346896712614], :Pressure =&gt; [2.751542523151855e6, 2.790807837234831e6, 2.88897144618938e6, 2.9675056780606583e6], :PhaseMassDensities =&gt; [1000.9971473263463 1000.9767215927282 1001.0238842303086 1001.061178085281], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.50769320178034 377.35933379641335 251.58474246126858 251.59411542933302], :TotalThermalEnergy =&gt; [3.472882224249536e8, 4.471021689776327e8, 2.9805422942429626e8, 2.980475445875612e8], :FluidEnthalpy =&gt; [1.1859825990710158e6 1.1876061848977557e6 1.1875931116452173e6 1.1876007497261988e6], :Temperature =&gt; [282.6685429336571, 283.0972802375748, 283.0952122237605, 283.09832910740147]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.4210145747575356e-10, 0.0013460998034390988, 0.0010460384939023452], :Pressure =&gt; [2.7526919158299123e6, 2.7915519628636856e6, 2.888708119844877e6, 2.9664517841308867e6], :PhaseMassDensities =&gt; [990.721145146897 990.5898547309287 990.8717632791725 991.066773309526], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.4946119926255 373.443577241192 249.03323617339305 249.08224753969182], :TotalThermalEnergy =&gt; [3.877762543894914e8, 4.990448126933243e8, 3.3218234486012703e8, 3.318361573638258e8], :FluidEnthalpy =&gt; [1.3376612500638172e6 1.339150633368557e6 1.3368029163984694e6 1.335228468907277e6], :Temperature =&gt; [319.7854895657129, 320.1328690739104, 319.57531693752276, 319.2006349765521]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 239), :SurfaceTemperature =&gt; [344.8805247740817, 282.6685429336571, 319.7854895657129]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.812396632879414e6, 2.797783216186426e6, 2.794761048926809e6, 2.7947032613553214e6, 2.7944784138122485e6, 2.794538504559092e6, 2.794581299289285e6, 2.794892288652363e6, 2.7942819658675306e6, 2.7966363188737943e6  …  2.965658809071772e6, 2.9656787737299376e6, 2.963339729458261e6, 2.960786904237727e6, 2.961592298782153e6, 2.9627150518382047e6, 2.964019332823526e6, 2.964412093765739e6, 2.9603002996038883e6, 2.9461671025344953e6], :TotalMasses =&gt; [455657.6930759365 1.4175394260506094e6 … 557341.6141622652 101354.45307749917], :TotalThermalEnergy =&gt; [1.6917832955355645e12, 5.264588560360872e12, 7.521313743266646e12, 7.716954562295574e12, 8.297531309427879e12, 8.326454444193416e12, 8.361427212327811e12, 7.58653837469692e12, 6.5816732892900625e12, 5.06562293501934e12  …  5.945341789880511e12, 5.938044663919351e12, 4.647660871003827e12, 1.4876686103643555e12, 9.380418524563787e11, 5.252645779608846e12, 4.872246595812017e12, 3.184438560647375e12, 2.0584504579970542e12, 3.73772119340562e11], :FluidEnthalpy =&gt; [1.3560025690427958e6 1.3563463595632762e6 … 1.349529566917576e6 1.3476304304959807e6], :Temperature =&gt; [324.075956515514, 324.157232599985, 324.17855049655515, 324.513744214414, 325.167812455637, 326.3563375791402, 327.79505834882684, 327.1270812746688, 324.20556931296784, 323.42529231774125  …  320.1382328346183, 319.72758765969525, 320.3444207801157, 320.43833928316553, 323.4140035168234, 323.38896129254044, 323.02722318156776, 322.89331805195974, 322.5538371853908, 322.110272377315]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.352915023449767e-10, -0.003212292863522969, -0.002593949149333781], :Pressure =&gt; [2.753274306141489e6, 2.7916382311865813e6, 2.887568272034292e6, 2.9643227301893095e6], :PhaseMassDensities =&gt; [977.9911695537934 978.0246485521658 978.3381914514723 978.2898107748271], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.7619881976162 368.7066061105469 245.88320599922162 245.87104660895565], :TotalThermalEnergy =&gt; [4.139267750629231e8, 5.3215427877791524e8, 3.543606615636196e8, 3.544859093386338e8], :FluidEnthalpy =&gt; [1.4462658731750855e6 1.4461544565791602e6 1.444126227255865e6 1.4447855076835116e6], :Temperature =&gt; [344.8803804272867, 344.85263620760014, 344.38555747753685, 344.5307061692395]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.7319648339327118e-10, 0.000988080235452649, 0.0007585832889785254], :Pressure =&gt; [2.7506867355201053e6, 2.789952026635341e6, 2.88811556008264e6, 2.966649732345581e6], :PhaseMassDensities =&gt; [1000.9967589914932 1000.975938898722 1001.023137252909 1001.0604143580388], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.50757933605433 377.35903872772457 251.5845547253717 251.59392348374152], :TotalThermalEnergy =&gt; [3.4728808738329834e8, 4.471079916228265e8, 2.980577438957453e8, 2.9805122359229386e8], :FluidEnthalpy =&gt; [1.1859817441393456e6 1.1876216885348707e6 1.1876071121774453e6 1.1876154235179515e6], :Temperature =&gt; [282.6683035824078, 283.10135681491533, 283.0988904771094, 283.1021832406243]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.4190927241274782e-10, 0.0013481390786721677, 0.001047438007479972], :Pressure =&gt; [2.7518359743000795e6, 2.790696039499685e6, 2.8878522952684397e6, 2.9655960426446223e6], :PhaseMassDensities =&gt; [990.7208269634347 990.5910991140682 990.8725751848726 991.0681152869428], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.4945186963616 373.44404636258355 249.0334402275517 249.08258481540335], :TotalThermalEnergy =&gt; [3.877761295906941e8, 4.9903963421347076e8, 3.321798174459642e8, 3.3183249342663467e8], :FluidEnthalpy =&gt; [1.3376603861054678e6 1.3391342202549244e6 1.336790808440074e6 1.335211087729787e6], :Temperature =&gt; [319.78534058200233, 320.1290681374512, 319.57252684412276, 319.1966061086732]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 240), :SurfaceTemperature =&gt; [344.8803804272867, 282.6683035824078, 319.78534058200233]))</span></span></code></pre></div><p>We calibrate against the first two years. Since we have defined report steps of 1/4 month, this corresponds to the first 12_4_2 steps. To see the effect of more or less data used for calibration, and to exclude data from one or more of the wells and WellObs, you can change num_years_cal and wells_cal below.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">num_years_cal </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_steps </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 12</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">num_years_cal</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells_cal </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:WellA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:WellObs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:WellB</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">objective </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (model, state, dt, step_no, forces) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    well_mismatch_thermal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, wells_cal,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        states_hf, state, dt, step_no, forces;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        scale</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dt[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_steps]),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        w_bhp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        w_temp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">si_unit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Kelvin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        w_energy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">#1 (generic function with 1 method)</span></span></code></pre></div><h3 id="Compute-mismatch-for-initial-proxy-model" tabindex="-1">Compute mismatch for initial proxy model <a class="header-anchor" href="#Compute-mismatch-for-initial-proxy-model" aria-label="Permalink to &quot;Compute mismatch for initial proxy model {#Compute-mismatch-for-initial-proxy-model}&quot;">​</a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obj0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Jutul</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">evaluate_objective</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    objective, proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model, states_proxy[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_steps],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dt[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_steps], proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">forces[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_steps])</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Initial proxy mismatch: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$obj0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Initial proxy mismatch: 37.09217241637894</span></span></code></pre></div><h2 id="Set-up-optimization" tabindex="-1">Set up optimization <a class="header-anchor" href="#Set-up-optimization" aria-label="Permalink to &quot;Set up optimization {#Set-up-optimization}&quot;">​</a></h2><p>We start by declaring the parameters to be optimized and their bounds</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">parameters </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_parameters</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">opt_config </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> optimization_config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model, parameters,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    use_scaling </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rel_min </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rel_max </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Dict{Symbol, Jutul.OptimizationConfig} with 5 entries:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  :WellObs   =&gt; OptimizationConfig(Dict{Symbol, Any}(:MaterialHeatCapacities=&gt;O…</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  :WellB     =&gt; OptimizationConfig(Dict{Symbol, Any}(:MaterialHeatCapacities=&gt;O…</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  :Reservoir =&gt; OptimizationConfig(Dict{Symbol, Any}(:RockDensity=&gt;OrderedDict{…</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  :WellA     =&gt; OptimizationConfig(Dict{Symbol, Any}(:MaterialHeatCapacities=&gt;O…</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  :Facility  =&gt; OptimizationConfig(Dict{Symbol, Any}(), false)</span></span></code></pre></div><p>We will only consider a subset of all the model parameters</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> well_symbols</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (k, v) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> opt_config</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (ki, vi) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ki </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Volumetric properties</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            :FluidVolume</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:BulkVolume</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:active</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Reservoir</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_max</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        elseif</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ki </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Rock density and heat capacity</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            :RockDensity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:RockHeatCapacity</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:active</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Reservoir</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_max</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        elseif</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ki </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Conductive properties</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            :Transmissibilities</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            :RockThermalConductivities</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:FluidThermalConductivities</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:active</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Reservoir</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_max</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        elseif</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ki </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Well properties</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            :WellIndices</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:WellIndicesThermal</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:active</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wells</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_max</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        else</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:active</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><h3 id="Calibrate-proxy-model" tabindex="-1">Calibrate proxy model <a class="header-anchor" href="#Calibrate-proxy-model" aria-label="Permalink to &quot;Calibrate proxy model {#Calibrate-proxy-model}&quot;">​</a></h3><p>Setting up the calibration requires a few steps, which has been conveniently implemented in the <code>calibrate_case</code> utility function. We use the LBFGS optimization algorithm, which has a number of parameters that can be set, including the maximum number of function evaluations (maxfun), and the maximum number of iterations (maxiter), both we set to 200 here. Increasing these numbers will likely give a better match.</p><div class="language-@example vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">@example</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>proxy_cal = calibrate_case(objective, proxy, n_steps, opt_config;</span></span>
<span class="line"><span>    lbfgs_args = (maxfun = 200, maxiter = 200, factr = 1e-6))</span></span></code></pre></div><h3 id="Simulate-the-full-schedule-using-the-calibrated-proxy" tabindex="-1">Simulate the full schedule using the calibrated proxy <a class="header-anchor" href="#Simulate-the-full-schedule-using-the-calibrated-proxy" aria-label="Permalink to &quot;Simulate the full schedule using the calibrated proxy {#Simulate-the-full-schedule-using-the-calibrated-proxy}&quot;">​</a></h3><div class="language-@example vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">@example</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>results_proxy_cal = simulate_reservoir(proxy_cal)</span></span>
<span class="line"><span>states_proxy_cal = results_proxy_cal.result.states</span></span>
<span class="line"><span>obj = Jutul.evaluate_objective(</span></span>
<span class="line"><span>    objective, proxy_cal.model, states_proxy_cal[1:n_steps],</span></span>
<span class="line"><span>    proxy_cal.dt[1:n_steps], proxy_cal.forces[1:n_steps])</span></span>
<span class="line"><span>println(&quot;Final proxy mismatch: $obj&quot;)</span></span></code></pre></div><h3 id="Plot-the-calibrated-results" tabindex="-1">Plot the calibrated results <a class="header-anchor" href="#Plot-the-calibrated-results" aria-label="Permalink to &quot;Plot the calibrated results {#Plot-the-calibrated-results}&quot;">​</a></h3><p>Finally, we plot the resulting production temperatures for the high-fidelity and proxy model. The calibrated proxy does a good job of reproducing the temperatures used for calibration, but the prediction for the remaining three years of storage are not perfect, with the calibrated proxy model showing mismatch comparable to the initial proxy model for WellA in the final year. The match in the observation well is almost perfect.</p><div class="language-@example vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">@example</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>fig = Figure(size = (800, 1200), fontsize = 20)</span></span>
<span class="line"><span>time_tot = results_hifi.wells.time/si_unit(:year)</span></span>
<span class="line"><span>for (wno, well) in enumerate(well_symbols(hifi.model))</span></span>
<span class="line"><span>    ax = Axis(fig[wno, 1], xlabel = &quot;Time (years)&quot;, ylabel = &quot;Temperature (°C)&quot;,</span></span>
<span class="line"><span>        title = &quot;Well: $well&quot;)</span></span>
<span class="line"><span>    plot_well_data!(ax, time_tot, states_hf,</span></span>
<span class="line"><span>        vcat([states_proxy], [states_proxy_cal], [states_proxy_cal]);</span></span>
<span class="line"><span>        wells = [well],</span></span>
<span class="line"><span>        field = :Temperature,</span></span>
<span class="line"><span>        nan_ix = [</span></span>
<span class="line"><span>            missing,</span></span>
<span class="line"><span>            n_steps+1:length(hifi.dt),</span></span>
<span class="line"><span>            1:n_steps-1],</span></span>
<span class="line"><span>        names=vcat(</span></span>
<span class="line"><span>            &quot;High-fidelity&quot;,</span></span>
<span class="line"><span>            &quot;Proxy (initial)&quot;,</span></span>
<span class="line"><span>            &quot;Proxy (calibration)&quot;,</span></span>
<span class="line"><span>            &quot;Proxy (prediction)&quot;),</span></span>
<span class="line"><span>        legend = wno == 2</span></span>
<span class="line"><span>        )</span></span>
<span class="line"><span>end</span></span>
<span class="line"><span>fig</span></span></code></pre></div><h2 id="Example-on-GitHub" tabindex="-1">Example on GitHub <a class="header-anchor" href="#Example-on-GitHub" aria-label="Permalink to &quot;Example on GitHub {#Example-on-GitHub}&quot;">​</a></h2><p>If you would like to run this example yourself, it can be downloaded from the Fimbul.jl GitHub repository <a href="https://github.com/sintefmath/Fimbul.jl/blob/main/examples/storage/egg_htates.jl" target="_blank" rel="noreferrer">as a script</a>.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">This example took 104.823914322 seconds to complete.</span></span></code></pre></div><hr><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl" target="_blank" rel="noreferrer">Literate.jl</a>.</em></p></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-4f9813fa><!--[--><!--]--><div class="edit-info" data-v-4f9813fa><div class="edit-link" data-v-4f9813fa><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://https://github.com/sintefmath/Fimbul.jl/edit/main/docs/src/examples/storage/egg_htates.md" target="_blank" rel="noreferrer" data-v-4f9813fa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-4f9813fa></span> Edit this page<!--]--></a></div><!----></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-4f9813fa><span class="visually-hidden" id="doc-footer-aria-label" data-v-4f9813fa>Pager</span><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link prev" href="/Fimbul.jl/previews/PR23/examples/storage/btes" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Previous page</span><span class="title" data-v-4f9813fa>Borehole Thermal Energy Storage (BTES)</span><!--]--></a></div><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link next" href="/Fimbul.jl/previews/PR23/examples/production/doublet" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Next page</span><span class="title" data-v-4f9813fa>Geothermal energy production from a well doublet</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860>Made with <a href="https://luxdl.github.io/DocumenterVitepress.jl/dev/" target="_blank"><strong>DocumenterVitepress.jl</strong></a><br></p><p class="copyright" data-v-c970a860>© Copyright 2025.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"examples_analytical_analytical_1d.md\":\"CM1GiaNo\",\"examples_production_doublet.md\":\"CFfmtYfy\",\"examples_storage_btes.md\":\"CR309spX\",\"examples_storage_egg_htates.md\":\"D1HtPjR2\",\"extras_refs.md\":\"9FKbiwvu\",\"index.md\":\"a7u6VHw1\",\"man_cases_cases.md\":\"Bozj3Cc6\",\"man_cases_utils.md\":\"CtsScvJ3\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Fimbul.jl\",\"description\":\"Documentation for Fimbul.jl\",\"base\":\"/Fimbul.jl/previews/PR23/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"logo\":{\"src\":\"/logo.png\",\"width\":24,\"height\":24},\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"text\":\"Manual\",\"collapsed\":false,\"items\":[{\"text\":\"Introduction\",\"collapsed\":false,\"items\":[{\"text\":\"Fimbul.jl\",\"link\":\"/index\"}]},{\"text\":\"Cases\",\"collapsed\":false,\"items\":[{\"text\":\"Setup functions\",\"link\":\"/man/cases/cases\"},{\"text\":\"Utilities\",\"link\":\"/man/cases/utils\"}]},{\"text\":\"References\",\"collapsed\":false,\"items\":[{\"text\":\"Bibliography\",\"link\":\"/extras/refs\"}]}]},{\"text\":\"Examples\",\"collapsed\":false,\"items\":[{\"text\":\"Storage\",\"collapsed\":false,\"items\":[{\"text\":\"Borehole Thermal Energy Storage (BTES)\",\"link\":\"/examples/storage/btes\"},{\"text\":\"Digital twinning of a high-temperature aquifer thermal energy storage system\",\"link\":\"/examples/storage/egg_htates\"}]},{\"text\":\"Production\",\"collapsed\":false,\"items\":[{\"text\":\"Geothermal energy production from a well doublet\",\"link\":\"/examples/production/doublet\"}]},{\"text\":\"Analytical\",\"collapsed\":false,\"items\":[{\"text\":\"Heat equation in 1D\",\"link\":\"/examples/analytical/analytical_1d\"}]}]},{\"component\":\"VersionPicker\"}],\"sidebar\":[{\"text\":\"Manual\",\"collapsed\":false,\"items\":[{\"text\":\"Introduction\",\"collapsed\":false,\"items\":[{\"text\":\"Fimbul.jl\",\"link\":\"/index\"}]},{\"text\":\"Cases\",\"collapsed\":false,\"items\":[{\"text\":\"Setup functions\",\"link\":\"/man/cases/cases\"},{\"text\":\"Utilities\",\"link\":\"/man/cases/utils\"}]},{\"text\":\"References\",\"collapsed\":false,\"items\":[{\"text\":\"Bibliography\",\"link\":\"/extras/refs\"}]}]},{\"text\":\"Examples\",\"collapsed\":false,\"items\":[{\"text\":\"Storage\",\"collapsed\":false,\"items\":[{\"text\":\"Borehole Thermal Energy Storage (BTES)\",\"link\":\"/examples/storage/btes\"},{\"text\":\"Digital twinning of a high-temperature aquifer thermal energy storage system\",\"link\":\"/examples/storage/egg_htates\"}]},{\"text\":\"Production\",\"collapsed\":false,\"items\":[{\"text\":\"Geothermal energy production from a well doublet\",\"link\":\"/examples/production/doublet\"}]},{\"text\":\"Analytical\",\"collapsed\":false,\"items\":[{\"text\":\"Heat equation in 1D\",\"link\":\"/examples/analytical/analytical_1d\"}]}]}],\"editLink\":{\"pattern\":\"https://https://github.com/sintefmath/Fimbul.jl/edit/main/docs/src/:path\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/sintefmath/Fimbul.jl\"}],\"footer\":{\"message\":\"Made with <a href=\\\"https://luxdl.github.io/DocumenterVitepress.jl/dev/\\\" target=\\\"_blank\\\"><strong>DocumenterVitepress.jl</strong></a><br>\",\"copyright\":\"© Copyright 2025.\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>