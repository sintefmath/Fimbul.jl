<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Digital twinning of a high-temperature aquifer thermal energy storage system | Fimbul.jl</title>
    <meta name="description" content="Documentation for Fimbul.jl">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/Fimbul.jl/previews/PR25/assets/style.2xBu0wxE.css" as="style">
    <link rel="preload stylesheet" href="/Fimbul.jl/previews/PR25/vp-icons.css" as="style">
    
    <script type="module" src="/Fimbul.jl/previews/PR25/assets/app.B51vbuG3.js"></script>
    <link rel="preload" href="/Fimbul.jl/previews/PR25/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/Fimbul.jl/previews/PR25/assets/chunks/theme.C8DtsskL.js">
    <link rel="modulepreload" href="/Fimbul.jl/previews/PR25/assets/chunks/framework.UmJHmbPe.js">
    <link rel="modulepreload" href="/Fimbul.jl/previews/PR25/assets/examples_storage_egg_htates.md.BCXCEcFa.lean.js">
    <script src="/Fimbul.jl/versions.js"></script>
    <script src="/Fimbul.jl/previews/PR25/siteinfo.js"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-492508fc></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-492508fc>Skip to content</a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle has-sidebar" data-v-822684d1 data-v-0f4f798b><a class="title" href="/Fimbul.jl/previews/PR25/" data-v-0f4f798b><!--[--><!--]--><!--[--><img class="VPImage logo" src="/Fimbul.jl/previews/PR25/logo.png" width="24" height="24" alt data-v-35a7d0b8><!--]--><span data-v-0f4f798b>Fimbul.jl</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Manual</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Introduction</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR25/index" data-v-acbfed09><!--[--><span data-v-acbfed09>Fimbul.jl</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Cases</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR25/man/cases/cases" data-v-acbfed09><!--[--><span data-v-acbfed09>Setup functions</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR25/man/cases/utils" data-v-acbfed09><!--[--><span data-v-acbfed09>Utilities</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>References</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR25/extras/refs" data-v-acbfed09><!--[--><span data-v-acbfed09>Bibliography</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup active" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Examples</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Storage</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR25/examples/storage/ates_demo" data-v-acbfed09><!--[--><span data-v-acbfed09>Aquifer Thermal Energy Storage (ATES)</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR25/examples/storage/btes_demo" data-v-acbfed09><!--[--><span data-v-acbfed09>Borehole Thermal Energy Storage (BTES)</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link active" href="/Fimbul.jl/previews/PR25/examples/storage/egg_htates" data-v-acbfed09><!--[--><span data-v-acbfed09>Digital twinning of a high-temperature aquifer thermal energy storage system</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Production</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR25/examples/production/doublet_demo" data-v-acbfed09><!--[--><span data-v-acbfed09>Geothermal energy production from a well doublet</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Analytical</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR25/examples/analytical/analytical_1d" data-v-acbfed09><!--[--><span data-v-acbfed09>Heat equation in 1D</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><!----><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/sintefmath/Fimbul.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-04f5c5e9><span class="vpi-more-horizontal icon" data-v-04f5c5e9></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/sintefmath/Fimbul.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--[--><!--[--><div class="VPFlyout VPNolebaseEnhancedReadabilitiesMenu VPNolebaseEnhancedReadabilitiesMenuFlyout" aria-label="Enhanced Readability" role="menuitem" data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><span class="i-icon-park-outline:book-open option-icon" data-v-04f5c5e9></span><!----><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--]--></div></div></div><!--]--><!--]--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-168ddf5d><button data-v-168ddf5d>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-18756405><div class="curtain" data-v-18756405></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18756405><span class="visually-hidden" id="sidebar-aria-label" data-v-18756405> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Manual</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Introduction</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR25/index" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Fimbul.jl</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Cases</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR25/man/cases/cases" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Setup functions</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR25/man/cases/utils" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Utilities</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>References</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR25/extras/refs" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Bibliography</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible has-active" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Examples</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><section class="VPSidebarItem level-1 collapsible has-active" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Storage</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR25/examples/storage/ates_demo" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Aquifer Thermal Energy Storage (ATES)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR25/examples/storage/btes_demo" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Borehole Thermal Energy Storage (BTES)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR25/examples/storage/egg_htates" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Digital twinning of a high-temperature aquifer thermal energy storage system</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Production</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR25/examples/production/doublet_demo" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Geothermal energy production from a well doublet</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Analytical</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR25/examples/analytical/analytical_1d" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Heat equation in 1D</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _Fimbul_jl_previews_PR25_examples_storage_egg_htates" data-v-83890dd9><div><h1 id="Digital-twinning-of-a-high-temperature-aquifer-thermal-energy-storage-system" tabindex="-1">Digital twinning of a high-temperature aquifer thermal energy storage system <a class="header-anchor" href="#Digital-twinning-of-a-high-temperature-aquifer-thermal-energy-storage-system" aria-label="Permalink to &quot;Digital twinning of a high-temperature aquifer thermal energy storage system {#Digital-twinning-of-a-high-temperature-aquifer-thermal-energy-storage-system}&quot;">​</a></h1><p>This script was prepared for the <a href="https://dte_aicomas_2025.iacm.info" target="_blank" rel="noreferrer">2025 DTE &amp; AICOMAS conference</a>:</p><p>Ø. Klemetsdal, O. Andersen, S. Krogstad, O. Møyner, &quot;Predictive Digital Twins for Underground Thermal Energy Storage using Differentiable Programming&quot;</p><p>The example demonstrates digital twinning of high-temperature aquifer thermal energy storage (HT-ATES). We first set up and simulate a high-fidelity model of the system, before we construct reduced-order models at a lower resolution and calibrate using adjoint-based optimization so that its output matches that of the high-fidelity model.</p><p>Add modules to namespace</p><div class="language-@example vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">@example</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>using Jutul, JutulDarcy # Jutul and JutulDarcy modules</span></span>
<span class="line"><span>using Fimbul # Fimbul module</span></span>
<span class="line"><span>using HYPRE # Iterative linear solvers</span></span>
<span class="line"><span>using GLMakie # Visualization</span></span>
<span class="line"><span>using LBFGSB # Optimization</span></span></code></pre></div><h1 id="Set-up-model" tabindex="-1">Set up model <a class="header-anchor" href="#Set-up-model" aria-label="Permalink to &quot;Set up model {#Set-up-model}&quot;">​</a></h1><p>We use the first realization of the EGG benchmark model [?], and place a well doublet near the center of the domain. The fluid model is a single-phase water system with PVT formulations taken from the <a href="https://webbook.nist.gov/chemistry/fluid/" target="_blank" rel="noreferrer">NIST</a> database, which can be conveniently set up with the :geothermal keyword.</p><p>The HT-ATES system is operated by charging the aquifer through the main well (labelled &quot;Hot&quot; in this setup) with water at 25 l/s and 90°C from June to September while a supporting well (labelled &quot;Cold&quot;) is used to extract water at a constant BHP of 25 bar. The system is then discharged from December to March by producing hot water from the main well at a rate of 25 l/s with the supporting well injecting water at 10°C at a BHP of 45 bar. For the remaining months, the system is left to rest with no external forces applied. This cycle of charge – rest – discharge – rest is repeated for a total of 5 years.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hifi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> egg_ates</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    use_bc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, report_interval </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> si_unit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:year</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Jutul case with 240 time-steps (4 years, 52 weeks, 1.03 day) and forces for each step.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Model:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">MultiModel with 5 models and 18 cross-terms. 37181 equations, 37181 degrees of freedom and 301469 parameters.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  models:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    1) Reservoir (37106x37106)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       SinglePhaseSystem{AqueousPhase, Tuple{Float64}}(AqueousPhase(), (998.20715,))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       ∈ MinimalTPFATopology (18553 cells, 52113 faces)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    2) WellA (23x23)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       SinglePhaseSystem{AqueousPhase, Tuple{Float64}}(AqueousPhase(), (998.20715,))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       ∈ MultiSegmentWell [WellA] (8 nodes, 7 segments, 7 perforations)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    3) WellB (23x23)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       SinglePhaseSystem{AqueousPhase, Tuple{Float64}}(AqueousPhase(), (998.20715,))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       ∈ MultiSegmentWell [WellB] (8 nodes, 7 segments, 7 perforations)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    4) WellObs (23x23)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       SinglePhaseSystem{AqueousPhase, Tuple{Float64}}(AqueousPhase(), (998.20715,))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       ∈ MultiSegmentWell [WellObs] (8 nodes, 7 segments, 7 perforations)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    5) Facility (6x6)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.PredictionMode()</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       ∈ WellGroup([:WellA, :WellB, :WellObs], true, true)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  cross_terms:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    1) WellA &lt;-&gt; Reservoir (Eqs: mass_conservation &lt;-&gt; mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    2) WellA &lt;-&gt; Reservoir (Eqs: energy_conservation &lt;-&gt; energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    3) WellB &lt;-&gt; Reservoir (Eqs: mass_conservation &lt;-&gt; mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    4) WellB &lt;-&gt; Reservoir (Eqs: energy_conservation &lt;-&gt; energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    5) WellObs &lt;-&gt; Reservoir (Eqs: mass_conservation &lt;-&gt; mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    6) WellObs &lt;-&gt; Reservoir (Eqs: energy_conservation &lt;-&gt; energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.ReservoirFromWellThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    7) WellA  -&gt; Facility (Eq: control_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    8) Facility  -&gt; WellA (Eq: mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    9) Facility  -&gt; WellA (Eq: energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    10) WellA  -&gt; Facility (Eq: temperature_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellTemperatureCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    11) WellB  -&gt; Facility (Eq: control_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    12) Facility  -&gt; WellB (Eq: mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    13) Facility  -&gt; WellB (Eq: energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    14) WellB  -&gt; Facility (Eq: temperature_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellTemperatureCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    15) WellObs  -&gt; Facility (Eq: control_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    16) Facility  -&gt; WellObs (Eq: mass_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityFlowCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    17) Facility  -&gt; WellObs (Eq: energy_conservation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.WellFromFacilityThermalCT</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    18) WellObs  -&gt; Facility (Eq: temperature_equation)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       JutulDarcy.FacilityFromWellTemperatureCT</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Model storage will be optimized for runtime performance.</span></span></code></pre></div><h2 id="Visualize-the-model" tabindex="-1">Visualize the model <a class="header-anchor" href="#Visualize-the-model" aria-label="Permalink to &quot;Visualize the model {#Visualize-the-model}&quot;">​</a></h2><p>We visualize the model interactively using <code>plot_reservoir</code>.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">reservoir_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data_domain)</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR25/assets/wswulid.BCUOuk8a.jpeg" alt=""></p><h2 id="Simulate-high-fidelity-model" tabindex="-1">Simulate high-fidelity model <a class="header-anchor" href="#Simulate-high-fidelity-model" aria-label="Permalink to &quot;Simulate high-fidelity model {#Simulate-high-fidelity-model}&quot;">​</a></h2><p>We set up a simulator for the high-fidelity model and simulate the system.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">results_hifi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> simulate_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">ReservoirSimResult with 240 entries:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  wells (3 present):</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :WellObs</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :WellB</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :WellA</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    Results per well:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :lrat =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :wrat =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :temperature =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :control =&gt; Vector{Symbol} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :Aqueous_mass_rate =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :bhp =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :wcut =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :mass_rate =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :rate =&gt; Vector{Float64} of size (240,)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  states (Vector with 240 entries, reservoir variables for each state)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Pressure =&gt; Vector{Float64} of size (18553,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :TotalMasses =&gt; Matrix{Float64} of size (1, 18553)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :TotalThermalEnergy =&gt; Vector{Float64} of size (18553,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :FluidEnthalpy =&gt; Matrix{Float64} of size (1, 18553)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Temperature =&gt; Vector{Float64} of size (18553,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :PhaseMassDensities =&gt; Matrix{Float64} of size (1, 18553)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :RockInternalEnergy =&gt; Vector{Float64} of size (18553,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :FluidInternalEnergy =&gt; Matrix{Float64} of size (1, 18553)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :PhaseViscosities =&gt; Matrix{Float64} of size (1, 18553)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  time (report time for each state)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     Vector{Float64} of length 240</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  result (extended states, reports)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     SimResult with 240 entries</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  extra</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     Dict{Any, Any} with keys :simulator, :config</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Completed at Sep. 08 2025 9:09 after 41 seconds, 244 milliseconds, 902.5 microseconds.</span></span></code></pre></div><h3 id="Visualize-the-reservoir-states" tabindex="-1">Visualize the reservoir states <a class="header-anchor" href="#Visualize-the-reservoir-states" aria-label="Permalink to &quot;Visualize the reservoir states {#Visualize-the-reservoir-states}&quot;">​</a></h3><p>We visualize the results of the high-fidelity simulation interactively using <code>plot_reservoir</code>. We see that a hot thermal plume develops around the main well, while a cold plume develops around the supporting well. After a few cycles, the plumes start to interact slightly.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi, results_hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, step </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dt),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :seaborn_icefire_gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR25/assets/pfhlghj.BEJHINdu.jpeg" alt=""></p><h3 id="Inspect-well-output" tabindex="-1">Inspect well output <a class="header-anchor" href="#Inspect-well-output" aria-label="Permalink to &quot;Inspect well output {#Inspect-well-output}&quot;">​</a></h3><p>We can also inspect the well output using <code>plot_well_results</code>.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_well_results</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(results_hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells)</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR25/assets/swnynmn.C4ha3Mqs.jpeg" alt=""></p><h2 id="Construct-proxy-model" tabindex="-1">Construct proxy model <a class="header-anchor" href="#Construct-proxy-model" aria-label="Permalink to &quot;Construct proxy model {#Construct-proxy-model}&quot;">​</a></h2><p>The high-fidelity model is posed on a logically Cartesian mesh with 60×60×7 cells. We construct a proxy model by coarsening the high-fidelity model to 15×15×3 cells using the <code>coarsen_reservoir_case</code> function.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">coarsening </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">proxy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JutulDarcy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">coarsen_reservoir_case</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi, coarsening,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    method</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:ijk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    setup_arg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (block_backend </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">results_proxy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> simulate_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(proxy, info_level</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(proxy, results_proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, step </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dt),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :seaborn_icefire_gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR25/assets/xgakpxz.p3DcQtNY.jpeg" alt=""></p><h3 id="Compare-proxy-models-to-high-fidelity-model" tabindex="-1">Compare proxy models to high-fidelity model <a class="header-anchor" href="#Compare-proxy-models-to-high-fidelity-model" aria-label="Permalink to &quot;Compare proxy models to high-fidelity model {#Compare-proxy-models-to-high-fidelity-model}&quot;">​</a></h3><p>We compare the well output of the proxy models to the high-fidelity model.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_well_results</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([results_hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells, results_proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    names </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;High-fidelity&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Proxy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR25/assets/cbitjqw.DxjMx3Xb.jpeg" alt=""></p><h3 id="Define-mismatch-objective-function" tabindex="-1">Define mismatch objective function <a class="header-anchor" href="#Define-mismatch-objective-function" aria-label="Permalink to &quot;Define mismatch objective function {#Define-mismatch-objective-function}&quot;">​</a></h3><p>We define an objective function that measures the mismatch in well output between the high-fidelity model and the proxy model. The objective function is defined as the sum of the squared differences in production temperature of all wells, weighted by the inverse of the units of the respective quantities. The objective function is also scaled by the total time simulated in the high-fidelity model.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states_hf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> results_hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states_proxy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> results_proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">240-element Vector{OrderedDict{Symbol, Any}}:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.452653897371485e6, 3.458001716670781e6, 3.4960512384776697e6, 3.5517063180298414e6, 3.584618270679528e6, 3.6142676475288644e6, 3.6449939361485727e6, 3.65633414508314e6, 3.6578707571236053e6, 3.660317424882294e6  …  3.351389853352118e6, 3.3693849166947026e6, 3.390839540462582e6, 3.4262268881370947e6, 3.3236363234345876e6, 3.3250639295340744e6, 3.3273094856462013e6, 3.3331545392338336e6, 3.3445617944528805e6, 3.347351041870764e6], :TotalMasses =&gt; [455965.39172111126 1.4185888599382057e6 … 557151.7994120701 101302.42999535307], :TotalThermalEnergy =&gt; [1.687551575763038e12, 5.249529572742797e12, 7.499163711906326e12, 7.686696192672101e12, 8.249155827939625e12, 8.249192919147552e12, 8.249230175823779e12, 7.499334366674561e12, 6.561889663662612e12, 5.062142953555255e12  …  6.008278441920095e12, 6.008291436798435e12, 4.693895885379994e12, 1.5020221601613086e12, 9.387562158163772e11, 5.257090263717393e12, 4.881641601981468e12, 3.191854212613884e12, 2.0652407066074995e12, 3.754512302525636e11], :FluidEnthalpy =&gt; [1.3525778760032014e6 1.3524055444195734e6 … 1.3544234612011916e6 1.3542424709789064e6], :Temperature =&gt; [323.23430797099206, 323.1937008397222, 323.18672317266225, 323.1897079309083, 323.1908400580968, 323.1926996365853, 323.19457522968867, 323.19624681951143, 323.1948251326915, 323.20245865184285  …  323.68980022566683, 323.6907353494646, 323.68506956350154, 323.67993335080416, 323.67602473360404, 323.6796161597231, 323.6836536164787, 323.68495390209625, 323.6724903418875, 323.63002642981866]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.955178778952504, 13.611760813771745, 7.169046534195665], :Pressure =&gt; [4.242320149088933e6, 4.2554228642325075e6, 4.336760539546235e6, 4.405504680991943e6], :PhaseMassDensities =&gt; [967.2841544379003 967.2940532803855 967.3392434196251 967.3815479165282], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.62252739481943 364.6612669976104 243.11886885249623 243.129501132231], :TotalThermalEnergy =&gt; [4.3218587113626456e8, 5.556600000030135e8, 3.7042929503226e8, 3.704150506287451e8], :FluidEnthalpy =&gt; [1.5281923772187866e6 1.528169583833668e6 1.5281382460765704e6 1.5280838935213287e6], :Temperature =&gt; [363.1499995421431, 363.1442779233561, 363.13304754662863, 363.117410911984]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.128121813669516, -14.43084735110637, -6.935330978151477], :Pressure =&gt; [2.5e6, 2.564040574490223e6, 2.675561252131085e6, 2.7601063570091906e6], :PhaseMassDensities =&gt; [988.9965084821433 989.0269893963053 988.9988460873888 988.9821571166359], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.98892211085604 372.85439089073566 248.56252074215385 248.55832634632083], :TotalThermalEnergy =&gt; [3.9166068241557777e8, 5.03555140954209e8, 3.3585588654632497e8, 3.359621327181551e8], :FluidEnthalpy =&gt; [1.353133484703986e6 1.353133485360877e6 1.353898115562387e6 1.3544338990979162e6], :Temperature =&gt; [323.4256568689626, 323.42155260470105, 323.59306150314217, 323.71279760734535]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024955177930953698, -0.0073230703433481955, 0.000934899718673501], :Pressure =&gt; [3.4005368187151486e6, 3.439376166856832e6, 3.53641730713035e6, 3.6140386744304635e6], :PhaseMassDensities =&gt; [989.4823999677965 989.5008187825496 989.4382925029679 989.3797058845321], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.1313929355545 373.03302036100126 248.67296567262025 248.65824124941412], :TotalThermalEnergy =&gt; [3.9143118098842186e8, 5.032634833140528e8, 3.357177743649838e8, 3.359019429979961e8], :FluidEnthalpy =&gt; [1.3525881032384438e6 1.3525882965899755e6 1.3536114473283656e6 1.354510706315631e6], :Temperature =&gt; [323.240075625763, 323.2376030748547, 323.47033222993804, 323.6753577094366]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.12812181544182, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 1), :SurfaceTemperature =&gt; [363.1499995421431, 323.4256568689626, 323.240075625763]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.4514521261265585e6, 3.4566288799630185e6, 3.494241609123647e6, 3.5491992519972343e6, 3.5816143468201575e6, 3.6106135001499173e6, 3.640551975210199e6, 3.651541076652386e6, 3.652986898306305e6, 3.655404583523541e6  …  3.3513065761071346e6, 3.3693057400678815e6, 3.3907524910360426e6, 3.4261207465365855e6, 3.323535267329382e6, 3.3249640874299915e6, 3.3272121118560317e6, 3.333061598028441e6, 3.3444769826731742e6, 3.3472712257726025e6], :TotalMasses =&gt; [455965.2536809742 1.418586422597662e6 … 557152.6596955466 101302.57783587833], :TotalThermalEnergy =&gt; [1.6875490584415054e12, 5.249566992040937e12, 7.49921340510574e12, 7.686740777030148e12, 8.249199001820324e12, 8.249235295338839e12, 8.249277001981627e12, 7.4993675151294e12, 6.561921522402838e12, 5.0621695840377295e12  …  6.008231536103744e12, 6.008241169222465e12, 4.69385726832864e12, 1.5020104808075452e12, 9.387482088680121e11, 5.257047580488463e12, 4.881602193038489e12, 3.191827149466717e12, 2.0652197203676118e12, 3.754476240711007e11], :FluidEnthalpy =&gt; [1.3525753230857903e6 1.3524154214495046e6 … 1.35440869095219e6 1.3542285120603933e6], :Temperature =&gt; [323.2337894446213, 323.1960972981083, 323.18894481739596, 323.1916419950337, 323.1925767595803, 323.19439618283246, 323.1964457611924, 323.19768830923897, 323.19641275302996, 323.2041832402563  …  323.68715314067, 323.6878986760307, 323.6822800867007, 323.67729671023693, 323.6731326727741, 323.676863095494, 323.68091623486345, 323.68207897539077, 323.669045268475, 323.6267705540043]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.955178760418992, 13.608929905904494, 7.142481242424518], :Pressure =&gt; [4.1764201801301003e6, 4.1895216613979116e6, 4.270858814864205e6, 4.339626436027683e6], :PhaseMassDensities =&gt; [967.2536306072868 967.2614958394115 967.3040963702396 967.3417171115545], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.6135773402314 364.64899313152443 243.11003543552465 243.11949055908767], :TotalThermalEnergy =&gt; [4.321870134811934e8, 5.556653213006289e8, 3.704361155565099e8, 3.7042780426362956e8], :FluidEnthalpy =&gt; [1.5281764995234055e6 1.528167482301145e6 1.5281536970908875e6 1.528131169128934e6], :Temperature =&gt; [363.1499998352566, 363.1473156820228, 363.13995509993595, 363.13133484152735]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.12789290867658, -14.43031797397432, -6.934897060814764], :Pressure =&gt; [2.5e6, 2.564040240442124e6, 2.6755601629467583e6, 2.7601047164498153e6], :PhaseMassDensities =&gt; [988.9938919497413 989.0243728144428 988.9970136819427 988.9810585857163], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.9881549034853 372.85340446261284 248.56206020843484 248.55805025538746], :TotalThermalEnergy =&gt; [3.916667896881455e8, 5.0356299343965083e8, 3.3585955176386124e8, 3.359643291303242e8], :FluidEnthalpy =&gt; [1.3531581250433587e6 1.3531581254159834e6 1.3539153686360267e6 1.3544442385207124e6], :Temperature =&gt; [323.431415576821, 323.4273111114529, 323.5970933944856, 323.7152137727815]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024955176993820893, -0.006900170561365993, 0.0012846381171448306], :Pressure =&gt; [3.401107910343134e6, 3.439947159239094e6, 3.536987566473061e6, 3.6146085355344443e6], :PhaseMassDensities =&gt; [989.4798965184967 989.4982621630992 989.4345252407106 989.382235738], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.1306588858812 373.03205653817525 248.67201885634572 248.65887707093967], :TotalThermalEnergy =&gt; [3.914376043627684e8, 5.032719018933687e8, 3.3572581019475603e8, 3.358973676387997e8], :FluidEnthalpy =&gt; [1.352614242130632e6 1.352614936375144e6 1.3536494925132175e6 1.3544894186600053e6], :Temperature =&gt; [323.2461453535121, 323.2437897368411, 323.4791827807276, 323.67034809820626]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.12789290968192, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 2), :SurfaceTemperature =&gt; [363.1499998352566, 323.431415576821, 323.2461453535121]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.4501968327257885e6, 3.455200613399968e6, 3.492385926316866e6, 3.546681801278316e6, 3.5786478187443856e6, 3.6071327774776383e6, 3.636470877198263e6, 3.6471965093911886e6, 3.6485936236904887e6, 3.651024488710995e6  …  3.3512573255368257e6, 3.3692648586550322e6, 3.3907083036247594e6, 3.426064446098318e6, 3.323459975133833e6, 3.3248903906891225e6, 3.3271415448473836e6, 3.332997529245476e6, 3.3444256864526225e6, 3.34722908292245e6], :TotalMasses =&gt; [455965.0371479757 1.4185839823058066e6 … 557153.5091011821 101302.71974123186], :TotalThermalEnergy =&gt; [1.6875481520214714e12, 5.249603648581549e12, 7.499262061833361e12, 7.686784599707654e12, 8.249242035627589e12, 8.249280782961295e12, 8.249353936275701e12, 7.499401499733832e12, 6.5619535715569e12, 5.062196345710441e12  …  6.008185221416231e12, 6.008191769267431e12, 4.693819538257815e12, 1.5019987551360684e12, 9.38740339101565e11, 5.257005601905305e12, 4.881563396204752e12, 3.191800448698937e12, 2.0651991910033848e12, 3.754441996585331e11], :FluidEnthalpy =&gt; [1.3525741355650183e6 1.3524250699481813e6 … 1.354394252614552e6 1.3542152677405651e6], :Temperature =&gt; [323.23359337435403, 323.19844396038917, 323.19111917338716, 323.193542415439, 323.1943081466675, 323.19622234000184, 323.1995553702195, 323.1991726013349, 323.1980157438815, 323.2059226255298  …  323.6845397876658, 323.6851113806128, 323.6795551414226, 323.67465017999103, 323.6702904333945, 323.6741557580025, 323.67822165697964, 323.67924285685723, 323.6656755542053, 323.62367917128466]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.9551787554113, 13.62383959603553, 7.132647489955872], :Pressure =&gt; [4.1501710210476704e6, 4.163272012631959e6, 4.2445931300220825e6, 4.31336937191052e6], :PhaseMassDensities =&gt; [967.2414724342032 967.2486191380287 967.290183429464 967.3260660487044], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.610012377689 364.6441387294684 243.10653873212223 243.115557017962], :TotalThermalEnergy =&gt; [4.321874682011651e8, 5.556672669574343e8, 3.704387131394117e8, 3.7043260327272755e8], :FluidEnthalpy =&gt; [1.5281701737824148e6 1.5281660236508697e6 1.5281592082405975e6 1.5281484895175179e6], :Temperature =&gt; [363.14999991444137, 363.14838881404245, 363.1425655735973, 363.1365486906545]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.12782868805505, -14.429923689112533, -6.934539897889588], :Pressure =&gt; [2.5e6, 2.564040115435403e6, 2.67555952186899e6, 2.760103676849866e6], :PhaseMassDensities =&gt; [988.9923637067116 989.0228445710591 988.9961713149787 988.9808972356029], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.98770679922495 372.85282832843035 248.5618484985256 248.558009703681], :TotalThermalEnergy =&gt; [3.916703567596994e8, 5.035675798418916e8, 3.3586123655929166e8, 3.359646510464705e8], :FluidEnthalpy =&gt; [1.3531725167826521e6 1.3531725170347588e6 1.3539232993447084e6 1.3544457535790761e6], :Temperature =&gt; [323.4347790762137, 323.43067449952474, 323.5989467395204, 323.7155678704301]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024955169746148004, -0.006427258551168427, 0.0017355546007623089], :Pressure =&gt; [3.4016504831916327e6, 3.440488932900049e6, 3.5375267365770903e6, 3.6151458700575973e6], :PhaseMassDensities =&gt; [989.4596665461718 989.4777453328419 989.4115903715689 989.3698702098432], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.12472714818693 373.0243218753899 248.6662546950332 248.65576927474646], :TotalThermalEnergy =&gt; [3.9148541915188545e8, 5.033342413764621e8, 3.3577220549809265e8, 3.359225924536112e8], :FluidEnthalpy =&gt; [1.352807253023642e6 1.3528106494777e6 1.353867992066628e6 1.3546083354213254e6], :Temperature =&gt; [323.2912025491003, 323.28947755720924, 323.53019019546133, 323.6980909641156]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.12782868873523, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 3), :SurfaceTemperature =&gt; [363.14999991444137, 323.4347790762137, 323.2912025491003]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.448997762014079e6, 3.4538308929716367e6, 3.490601468514463e6, 3.5442657525236662e6, 3.575814042987912e6, 3.603852617916236e6, 3.6326736445606668e6, 3.6431729751434103e6, 3.6445362399620432e6, 3.6469917734274226e6  …  3.3512588279308355e6, 3.3692755366818667e6, 3.390716568437562e6, 3.426061887725644e6, 3.323434402932146e6, 3.3248664194435454e6, 3.327120735943942e6, 3.3329834521042877e6, 3.344425074643632e6, 3.3472383835282335e6], :TotalMasses =&gt; [455964.7844142479 1.4185816004738703e6 … 557154.3556019812 101302.85830969657], :TotalThermalEnergy =&gt; [1.687548379352838e12, 5.24963979254163e12, 7.499310051428839e12, 7.686828016774871e12, 8.249285683920075e12, 8.249332648807029e12, 8.249474052160768e12, 7.499436702557378e12, 6.561985716980119e12, 5.062223147596824e12  …  6.008139401006131e12, 6.0081430794305205e12, 4.693782474528375e12, 1.5019870631647407e12, 9.387325814522494e11, 5.256964198851014e12, 4.881525100484382e12, 3.1917740486225806e12, 2.065179030017674e12, 3.7544090992349365e11], :FluidEnthalpy =&gt; [1.3525739396317585e6 1.3524345961157791e6 … 1.3543800896227378e6 1.3542025605687867e6], :Temperature =&gt; [323.2336253173978, 323.2007582519182, 323.1932642428222, 323.19542614103244, 323.19606625797053, 323.19831241823937, 323.20443944942105, 323.20071549369374, 323.1996275013456, 323.20766863075573  …  323.68195489071223, 323.682364726842, 323.67687890325317, 323.6720118600627, 323.66748923482317, 323.6714860874237, 323.67556243376, 323.6764392329101, 323.6623668683424, 323.620709931151]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.9551787531016, 13.637191516834516, 7.128788095359027], :Pressure =&gt; [4.1351257546473467e6, 4.1482264671744555e6, 4.229533659206052e6, 4.298313094310583e6], :PhaseMassDensities =&gt; [967.2345037234475 967.2413210361462 967.2823705410536 967.3174283747894], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.6079690449742 364.6413874098773 243.10457513909557 243.11338613372877], :TotalThermalEnergy =&gt; [4.321877287581613e8, 5.556682258196688e8, 3.70439995039794e8, 3.7043492928219455e8], :FluidEnthalpy =&gt; [1.5281665477016165e6 1.5281646285770435e6 1.5281612556118427e6 1.5281561377497714e6], :Temperature =&gt; [363.1499999509617, 363.14888070517026, 363.14381703497344, 363.13903485418615]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.129672180246008, -14.430640101280805, -6.9347200158200355], :Pressure =&gt; [2.5e6, 2.5640419297441505e6, 2.675561979716534e6, 2.7601063013368403e6], :PhaseMassDensities =&gt; [988.9912019758693 989.0216837454138 988.995656227758 988.981044168348], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.9873661619509 372.85239070747207 248.5617190429873 248.55804663190762], :TotalThermalEnergy =&gt; [3.9167306834802985e8, 5.0357106605070835e8, 3.3586226922568136e8, 3.359643593408898e8], :FluidEnthalpy =&gt; [1.3531834570155663e6 1.353183457207198e6 1.3539281615454864e6 1.3544443814116507e6], :Temperature =&gt; [323.4373359214966, 323.4332311450956, 323.60008281354555, 323.71524706024644]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024955156742006566, -0.005914975493566136, 0.0022618539272907727], :Pressure =&gt; [3.4021713666927093e6, 3.4410078666035584e6, 3.5380400496802013e6, 3.615655003584153e6], :PhaseMassDensities =&gt; [989.4102186989514 989.4277819611634 989.3573745552843 989.3309518908438], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.110228282121 373.00548612802027 248.65262877422134 248.6459880343418], :TotalThermalEnergy =&gt; [3.916014753650342e8, 5.034850087469864e8, 3.358812157856252e8, 3.360009608674016e8], :FluidEnthalpy =&gt; [1.3532754306406367e6 1.3532836832804617e6 1.3543811054644836e6 1.3549773183416224e6], :Temperature =&gt; [323.40054594673893, 323.399953801479, 323.65002070716355, 323.78424769063025]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.129672180763066, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 4), :SurfaceTemperature =&gt; [363.1499999509617, 323.4373359214966, 323.40054594673893]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.4477827336223735e6, 3.452446320322324e6, 3.488810883008318e6, 3.5418655205366863e6, 3.573018494827003e6, 3.6006540563371885e6, 3.6290077468229686e6, 3.639302601805187e6, 3.6406388847470516e6, 3.6431218857749063e6  …  3.3512385584036005e6, 3.3692610300665684e6, 3.3906955057555246e6, 3.426023278019977e6, 3.3233928627298716e6, 3.3248262765151346e6, 3.3270833065514914e6, 3.332951374098813e6, 3.344403095790781e6, 3.3472230155475726e6], :TotalMasses =&gt; [455964.48715104535 1.4185792327824563e6 … 557155.1824617351 101302.990689073], :TotalThermalEnergy =&gt; [1.6875495901407415e12, 5.249675376463253e12, 7.499357315729147e12, 7.68687102371098e12, 8.249330664127172e12, 8.249395149654822e12, 8.249653737478043e12, 7.499473614633853e12, 6.562017784369814e12, 5.06224984559132e12  …  6.008094007104176e12, 6.008095024073656e12, 4.693745981585152e12, 1.5019754294330093e12, 9.38724924908144e11, 5.256923308707617e12, 4.8814872480292295e12, 3.1917479141579033e12, 2.0651592105716094e12, 3.75437741086578e11], :FluidEnthalpy =&gt; [1.3525745827255629e6 1.3524439629194355e6 … 1.3543661596038558e6 1.3541903124632507e6], :Temperature =&gt; [323.2338543108586, 323.203036277025, 323.19537651935974, 323.1972919968769, 323.1978794441451, 323.2008396709818, 323.21176849815737, 323.20233724465777, 323.20123704932263, 323.20940953739125  …  323.6793938122798, 323.6796535858259, 323.6742435535754, 323.66938627882575, 323.6647243633334, 323.6688493064407, 323.6729338031937, 323.6736636148186, 323.6591139966741, 323.6178495397578]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.955178752058792, 13.646049169208773, 7.127585476993307], :Pressure =&gt; [4.125138933937847e6, 4.1382394625413204e6, 4.219537427111339e6, 4.288317648146534e6], :PhaseMassDensities =&gt; [967.2298780036397 967.2365435501315 967.277337924537 967.312003240354], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.60661271308675 364.63958634008134 243.1033103046094 243.1120226487298], :TotalThermalEnergy =&gt; [4.321879016774647e8, 5.556687355463835e8, 3.704406520755505e8, 3.704360828274565e8], :FluidEnthalpy =&gt; [1.528164140605232e6 1.5281632492584102e6 1.5281615747340624e6 1.5281591200523528e6], :Temperature =&gt; [363.1499999674499, 363.1491073011043, 363.14441847067997, 363.1402233795679]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.13098358089799, -14.43105862850999, -6.934756863909281], :Pressure =&gt; [2.5e6, 2.564043213538498e6, 2.6755636197679485e6, 2.7601079742874573e6], :PhaseMassDensities =&gt; [988.9902013396879 989.0206837534422 988.995276217625 988.9813184747777], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.9870727600984 372.85201371938024 248.56162353602394 248.55811557263274], :TotalThermalEnergy =&gt; [3.9167540392135346e8, 5.0357406887372863e8, 3.358630309344413e8, 3.3596381197941107e8], :FluidEnthalpy =&gt; [1.3531928801937464e6 1.3531928803587956e6 1.3539317479016762e6 1.3544418052841455e6], :Temperature =&gt; [323.43953821466795, 323.43543329008054, 323.6009207920712, 323.71464497686105]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024955137753432426, -0.005351869018568423, 0.002852833593319187], :Pressure =&gt; [3.4025265574252126e6, 3.4413594293404007e6, 3.53838160577982e6, 3.6159889512609486e6], :PhaseMassDensities =&gt; [989.3181070751709 989.3349184900537 989.2576452535426 989.2517845281736], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.0832197434003 372.9704774241852 248.62756406688538 248.62609110594428], :TotalThermalEnergy =&gt; [3.91817017394919e8, 5.03764398771065e8, 3.3608118956308967e8, 3.361597549486579e8], :FluidEnthalpy =&gt; [1.3541448231182105e6 1.3541601581962197e6 1.3553222995222833e6 1.3557247776984358e6], :Temperature =&gt; [323.60362834030286, 323.6046876264173, 323.86985671415636, 323.95881979327896]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.130983581343344, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 5), :SurfaceTemperature =&gt; [363.1499999674499, 323.43953821466795, 323.60362834030286]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.4465456778596453e6, 3.451040462766128e6, 3.487006383112235e6, 3.5394699141418254e6, 3.570245633590428e6, 3.5975096118218573e6, 3.6254307112067714e6, 3.635536428918864e6, 3.636849784671799e6, 3.639360401051002e6  …  3.351193602580815e6, 3.369217511718003e6, 3.390639921984228e6, 3.4259410760008683e6, 3.323333817748459e6, 3.324768379186639e6, 3.3270275717196353e6, 3.3328993012562315e6, 3.344356977515261e6, 3.347179342421294e6], :TotalMasses =&gt; [455964.1490949696 1.4185768748968889e6 … 557155.989209331 101303.11709363476], :TotalThermalEnergy =&gt; [1.687551666072168e12, 5.249710406917353e12, 7.4994038793421e12, 7.686913749394591e12, 8.249378140003544e12, 8.249473566308773e12, 8.249908967861287e12, 7.499512996867684e12, 6.56204972664771e12, 5.062276397306192e12  …  6.008049036176998e12, 6.008047593702187e12, 4.693710026731787e12, 1.5019638901335225e12, 9.387173677342676e11, 5.256882920953192e12, 4.881449829787394e12, 3.1917220427360244e12, 2.0651397275177207e12, 3.7543468414219946e11], :FluidEnthalpy =&gt; [1.35257596130275e6 1.3524531700737453e6 … 1.3543524580360218e6 1.3541784874414946e6], :Temperature =&gt; [323.23425655828237, 323.20527838591767, 323.19745702452354, 323.1991455287045, 323.199795264755, 323.2040204010546, 323.222197364779, 323.2040716334658, 323.20284137478234, 323.2111418967765  …  323.6768563201961, 323.67697737879735, 323.6716466729032, 323.66678151825585, 323.66199517511126, 323.6662447187715, 323.67033511774105, 323.6709157072746, 323.65591606304963, 323.6150898273337]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.95517875152422, 13.652436417832295, 7.127568300597651], :Pressure =&gt; [4.1177452338116136e6, 4.130845627073853e6, 4.212136935679669e6, 4.280916882339002e6], :PhaseMassDensities =&gt; [967.2264533742184 967.2330487106711 967.2737159422431 967.3081937259265], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.6056085592945 364.6382688166444 243.10240000117213 243.11106521332667], :TotalThermalEnergy =&gt; [4.3218802968002814e8, 5.556690330470629e8, 3.7044100736460453e8, 3.704366750020503e8], :FluidEnthalpy =&gt; [1.5281623584411598e6 1.5281619424325295e6 1.528161107578769e6 1.5281599232774857e6], :Temperature =&gt; [363.1499999759021, 363.1492120958196, 363.14470865139987, 363.1407936115354]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.131906864934596, -14.431258857352892, -6.934684368687591], :Pressure =&gt; [2.5e6, 2.5640441057427893e6, 2.6755646461847955e6, 2.7601089226051075e6], :PhaseMassDensities =&gt; [988.9892015187281 989.0196843874794 988.9948786239607 988.9815834191224], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.9867795972814 372.85163696728824 248.56152360983717 248.55818216040933], :TotalThermalEnergy =&gt; [3.916777375872393e8, 5.0357706930520433e8, 3.358638272936153e8, 3.359632827238369e8], :FluidEnthalpy =&gt; [1.3532022956978823e6 1.353202295862791e6 1.35393549711581e6 1.35443931409074e6], :Temperature =&gt; [323.4417387136234, 323.4376336721704, 323.6017968679236, 323.7140627872172]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.02495511322117112, -0.004818451984160346, 0.0034289032492748808], :Pressure =&gt; [3.402682626127647e6, 3.441509703588175e6, 3.5385163383780443e6, 3.616111722624765e6], :PhaseMassDensities =&gt; [989.1708760461296 989.1867161795631 989.0997663918647 989.1194208847184], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.0400493509401 372.91460646939936 248.58788478112504 248.59282449395377], :TotalThermalEnergy =&gt; [3.921610445974268e8, 5.042096454247502e8, 3.3639733296491873e8, 3.3642482045132774e8], :FluidEnthalpy =&gt; [1.3555326725845314e6 1.3555571577174927e6 1.3568105276592665e6 1.3569725881662404e6], :Temperature =&gt; [323.92783134210276, 323.93102302079507, 324.2174754725286, 324.2502689429064]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.13190686537959, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 6), :SurfaceTemperature =&gt; [363.1499999759021, 323.4417387136234, 323.92783134210276]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.445293875823033e6, 3.449621066704262e6, 3.4851957155007953e6, 3.5370850971542266e6, 3.567498962090609e6, 3.594416212118068e6, 3.621931738269567e6, 3.6318609499004646e6, 3.6331545277420473e6, 3.635692316162835e6  …  3.3511153756080093e6, 3.369135001176505e6, 3.390538379578555e6, 3.425801616954028e6, 3.3232513500352707e6, 3.324686713321004e6, 3.326947323773288e6, 3.3328203250756483e6, 3.344278150334056e6, 3.3470974284777325e6], :TotalMasses =&gt; [455963.77601244004 1.4185745309365764e6 … 557156.7740148515 101303.23742900943], :TotalThermalEnergy =&gt; [1.6875545049797026e12, 5.249744902204611e12, 7.499449789527479e12, 7.686956401831457e12, 8.249429668980025e12, 8.249573951034545e12, 8.25025456713353e12, 7.499555756373432e12, 6.562081536725147e12, 5.062302791252404e12  …  6.008004479275416e12, 6.008000772253229e12, 4.693674579213914e12, 1.5019524748336104e12, 9.387099075717667e11, 5.256843022126607e12, 4.881412833503935e12, 3.191696429533981e12, 2.0651205738408342e12, 3.7543173067304095e11], :FluidEnthalpy =&gt; [1.3525779900341693e6 1.3524622251541864e6 … 1.3543389771932096e6 1.354167049738223e6], :Temperature =&gt; [323.2348116531593, 323.20748584646077, 323.199507978995, 323.20099596340873, 323.20187764518914, 323.20810283637513, 323.2363340276624, 323.2059594373803, 323.20443994908135, 323.2128647711446  …  323.6743418130651, 323.6743350873241, 323.6690859118178, 323.6642040964564, 323.65930075186964, 323.66367138885045, 323.66776545666227, 323.66819492039843, 323.6527718196516, 323.612423084235]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.955178751248273, 13.656270264631795, 7.128053706552656], :Pressure =&gt; [4.1117017910815766e6, 4.1248020740563236e6, 4.206089316031362e6, 4.274868549112693e6], :PhaseMassDensities =&gt; [967.2236487394209 967.2302147408044 967.2708185624198 967.3052059521017], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.60478619742076 364.6372004351748 243.10167181019872 243.1103143038628], :TotalThermalEnergy =&gt; [4.321881355669237e8, 5.556692333303549e8, 3.704412187852244e8, 3.704370003152971e8], :FluidEnthalpy =&gt; [1.5281609147398411e6 1.5281607208824058e6 1.5281603024882448e6 1.5281597287610867e6], :Temperature =&gt; [363.14999998024956, 363.1492639458776, 363.1448524551339, 363.14107201435417]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.13252604734116, -14.431284518039492, -6.934515832662343], :Pressure =&gt; [2.5e6, 2.5640446843188885e6, 2.6755651643653414e6, 2.7601092526532235e6], :PhaseMassDensities =&gt; [988.9880292755527 989.0185124522226 988.9942931159273 988.9816932527534], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.98643587763024 372.85119515810504 248.56137645561824 248.55820976461158], :TotalThermalEnergy =&gt; [3.916804736951186e8, 5.035805872346204e8, 3.3586499917825764e8, 3.3596306326459163e8], :FluidEnthalpy =&gt; [1.3532133349387024e6 1.353213335132045e6 1.3539410138707273e6 1.354438281075125e6], :Temperature =&gt; [323.4443186954274, 323.44021355359615, 323.60308602753736, 323.7138213764747]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024955084352966197, -0.004350458619587879, 0.003948149364418999], :Pressure =&gt; [3.40260130461665e6, 3.441420039960794e6, 3.5384044966765586e6, 3.6159825576419495e6], :PhaseMassDensities =&gt; [988.9587835569927 988.9734811178968 988.8702404431087 988.9205617761679], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.9778605850697 372.8342187450131 248.53019861837143 248.54284574879205], :TotalThermalEnergy =&gt; [3.92656147010395e8, 5.048496475720032e8, 3.3684794499468845e8, 3.368150158142836e8], :FluidEnthalpy =&gt; [1.357530678470539e6 1.3575659285394605e6 1.358938450610878e6 1.35881525913933e6], :Temperature =&gt; [324.39455934234303, 324.40025806070855, 324.7138383883083, 324.6800664375332]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.132526047862896, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 7), :SurfaceTemperature =&gt; [363.14999998024956, 323.4443186954274, 324.39455934234303]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.444009540751446e6, 3.448169564884418e6, 3.4833582814437714e6, 3.5346864226418086e6, 3.564749963992452e6, 3.5913383955372716e6, 3.6184699528639237e6, 3.6282339903795645e6, 3.6295106420359835e6, 3.632075442892539e6  …  3.351003028731895e6, 3.369012585387113e6, 3.390389396151355e6, 3.425602255447458e6, 3.32314422442618e6, 3.32458007025309e6, 3.32684139004249e6, 3.3327134350021384e6, 3.3441659014653615e6, 3.3469765342270015e6], :TotalMasses =&gt; [455963.3683595844 1.4185721893118264e6 … 557157.5369100234 101303.35198092305], :TotalThermalEnergy =&gt; [1.687558010082599e12, 5.249778859331958e12, 7.499495068792692e12, 7.686999222532635e12, 8.249487139022135e12, 8.24970284649251e12, 8.250703735401804e12, 7.499602846699357e12, 6.562113181759947e12, 5.06232899485711e12  …  6.007960334530326e12, 6.007954551427386e12, 4.69363962126309e12, 1.5019412131057656e12, 9.387025427556406e11, 5.256803602408727e12, 4.881376250928953e12, 3.1916710726471064e12, 2.0651017445789497e12, 3.7542887308170013e11], :FluidEnthalpy =&gt; [1.3525805800387925e6 1.3524711212788208e6 … 1.354325713356195e6 1.3541559697576219e6], :Temperature =&gt; [323.2354999839438, 323.2096582541484, 323.20153016355937, 323.2028536517093, 323.2042037046547, 323.2133549541658, 323.2547195457853, 323.2080432052467, 323.2060305985854, 323.21457550635495  …  323.67185017577646, 323.671726232771, 323.66655997043074, 323.6616606564919, 323.6566404784369, 323.66112866989596, 323.6652242338433, 323.66550104044194, 323.64968044389377, 323.6098424443638]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.955178751094934, 13.65888730763989, 7.128756483755439], :Pressure =&gt; [4.106401440691862e6, 4.119501627189711e6, 4.200786041066606e6, 4.269564377004267e6], :PhaseMassDensities =&gt; [967.2211886282569 967.2277423130895 967.268314016862 967.3026571500804], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.6040648551525 364.6362683518853 243.10104234924472 243.10967372004635], :TotalThermalEnergy =&gt; [4.321882285038709e8, 5.556693841971719e8, 3.7044135842580444e8, 3.70437195444012e8], :FluidEnthalpy =&gt; [1.5281596493140513e6 1.5281595608729923e6 1.528159351029751e6 1.5281590745676856e6], :Temperature =&gt; [363.14999998267496, 363.14928988066885, 363.1449244468938, 363.1412095375934]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.13296977508359, -14.431210716207092, -6.934278340746613], :Pressure =&gt; [2.5e6, 2.5640450701533705e6, 2.675565349054372e6, 2.760109150052129e6], :PhaseMassDensities =&gt; [988.9864583895612 989.016941790544 988.9932934441762 988.9814577202078], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.98597526980046 372.8506030326021 248.5611252107039 248.55815056882636], :TotalThermalEnergy =&gt; [3.9168414025672877e8, 5.035853015487569e8, 3.358669993983644e8, 3.359635344050695e8], :FluidEnthalpy =&gt; [1.3532281282826345e6 1.3532281285417227e6 1.3539504298134507e6 1.3544404990338911e6], :Temperature =&gt; [323.44777604741614, 323.4436708024892, 323.60528639707866, 323.71433966348513]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024955049560993373, -0.0038813290092151987, 0.004418820209764327], :Pressure =&gt; [3.402267743106052e6, 3.441075065906824e6, 3.538029683016057e6, 3.6155845466395025e6], :PhaseMassDensities =&gt; [988.668520008658 988.6818693481002 988.5628626050095 988.64856954579], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.89275086750473 372.7242836977699 248.45294614172752 248.47448664536896], :TotalThermalEnergy =&gt; [3.9331349497091264e8, 5.056985219993593e8, 3.374442653641268e8, 3.373427107186168e8], :FluidEnthalpy =&gt; [1.360196454711898e6 1.360243479998653e6 1.3617607456985253e6 1.361312426049572e6], :Temperature =&gt; [325.0159246860299, 325.02434754035164, 325.37160311229945, 325.26205276963606]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.132969775782755, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 8), :SurfaceTemperature =&gt; [363.14999998267496, 323.44777604741614, 325.0159246860299]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.4426716547298804e6, 3.4466643243028186e6, 3.481471143239061e6, 3.5322488652871647e6, 3.5619717946841354e6, 3.588246914167682e6, 3.6150127437857552e6, 3.62462115396514e6, 3.625882663083835e6, 3.6284731110415407e6  …  3.3508440380659765e6, 3.368836890938771e6, 3.390178327628752e6, 3.4253262117195907e6, 3.3230011145504974e6, 3.324437098797183e6, 3.3266983567900425e6, 3.3325669324385924e6, 3.344007765723442e6, 3.346803398439257e6], :TotalMasses =&gt; [455962.92553504737 1.4185698365705875e6 … 557158.2751766964 101303.46047782632], :TotalThermalEnergy =&gt; [1.6875620941781157e12, 5.249812273589419e12, 7.499539747755464e12, 7.687042532684389e12, 8.24955279588573e12, 8.249867149466803e12, 8.251267786045336e12, 7.499655287274794e12, 6.562144638531654e12, 5.06235498014096e12  …  6.00791658912843e12, 6.007908911109727e12, 4.693605131104758e12, 1.5019301318741978e12, 9.386952701773569e11, 5.256764644000977e12, 4.881340066321208e12, 3.1916459650076133e12, 2.0650832308691821e12, 3.754261036002877e11], :FluidEnthalpy =&gt; [1.3525836496037699e6 1.3524798500919584e6 … 1.3543126562295589e6 1.3541452131585507e6], :Temperature =&gt; [323.23630382318464, 323.21179505894037, 323.2035246983798, 323.20473244756676, 323.20686525849163, 323.2200593324793, 323.27781767327906, 323.2103685468449, 323.2076117250962, 323.21627181776023  …  323.6693805446649, 323.6691495299648, 323.664067111679, 323.6591570849396, 323.65401310506144, 323.65861528671047, 323.66271022797474, 323.66283318530424, 323.64664034091066, 323.6073407468575]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.955178751006503, 13.660720683247805, 7.1295009401714955], :Pressure =&gt; [4.1015291626733574e6, 4.1146292605852275e6, 4.195911641123567e6, 4.264689056741212e6], :PhaseMassDensities =&gt; [967.2189272036865 967.2254746223999 967.2660314266299 967.3003523729776], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.60340177083623 364.635413452636 243.10046867174836 243.1090944663812], :TotalThermalEnergy =&gt; [4.321883139287801e8, 5.55669509132445e8, 3.70441462248977e8, 3.704373268537872e8], :FluidEnthalpy =&gt; [1.5281584860595793e6 1.5281584488548331e6 1.5281583449579717e6 1.5281582161049193e6], :Temperature =&gt; [363.1499999840743, 363.1493022656843, 363.14496161631416, 363.1412792450957]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.13314788802165, -14.430983033575338, -6.933932093668485], :Pressure =&gt; [2.5e6, 2.5640451601826036e6, 2.675565011763467e6, 2.760108363956222e6], :PhaseMassDensities =&gt; [988.9841819112874 989.0146654118214 988.9915705934142 988.9806169054165], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.9853077715078 372.8497448580415 248.56069221108012 248.55793924902065], :TotalThermalEnergy =&gt; [3.916894537014899e8, 5.0359213342719364e8, 3.358704460364068e8, 3.359652159401748e8], :FluidEnthalpy =&gt; [1.3532495663419422e6 1.3532495667174e6 1.353966654475777e6 1.3544484149252402e6], :Temperature =&gt; [323.45278633252286, 323.4486809731805, 323.60907790654534, 323.71618945584174]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024955015968727356, -0.0034566279071645205, 0.0047996389972887864], :Pressure =&gt; [3.401639061553324e6, 3.4404320116017777e6, 3.5373493376946654e6, 3.6148751639216626e6], :PhaseMassDensities =&gt; [988.3027809180209 988.3148045835738 988.1780650809203 988.3028267606949], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.78551056507894 372.5859035416546 248.3562359757437 248.387592005874], :TotalThermalEnergy =&gt; [3.9414071926321816e8, 5.06765970702547e8, 3.381900979078541e8, 3.380129127576001e8], :FluidEnthalpy =&gt; [1.3635537924563251e6 1.3636130035651901e6 1.3652934037717083e6 1.3644861534398817e6], :Temperature =&gt; [325.7983879697041, 325.8096399389256, 326.1948384962165, 326.00164982089166]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.133147889034856, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 9), :SurfaceTemperature =&gt; [363.1499999840743, 323.45278633252286, 325.7983879697041]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [3.4412868288108674e6, 3.445113044412172e6, 3.479543969842515e6, 3.52978416270815e6, 3.559176509452998e6, 3.585151909979244e6, 3.6115679529353697e6, 3.6210295390604413e6, 3.622277743355842e6, 3.6248928436336494e6  …  3.350637968812308e6, 3.3686076685822182e6, 3.389905183593623e6, 3.4249739612948406e6, 3.322821293928496e6, 3.324257091122337e6, 3.32651756597165e6, 3.332380189718724e6, 3.3438031729980833e6, 3.3465776353025404e6], :TotalMasses =&gt; [455962.451878969 1.4185674766254404e6 … 557158.9888916927 101303.56316305099], :TotalThermalEnergy =&gt; [1.6875666858314866e12, 5.249845167497117e12, 7.499583909853068e12, 7.687086785127605e12, 8.249629262824666e12, 8.250073964122178e12, 8.251956056207768e12, 7.499714182702173e12, 6.562175929472625e12, 5.062380753512302e12  …  6.00787324135202e12, 6.007863843309342e12, 4.693571103608894e12, 1.5019192670113489e12, 9.386880882785967e11, 5.256726138253717e12, 4.881304272221969e12, 3.1916211050000957e12, 2.0650650275181074e12, 3.754234160205416e11], :FluidEnthalpy =&gt; [1.3525871395634322e6 1.3524884203179122e6 … 1.3542998019781895e6 1.3541347558280376e6], :Temperature =&gt; [323.23720892014467, 323.2138978002231, 323.20549545855675, 323.20665241967566, 323.2099700510595, 323.2285075101531, 323.3060113370946, 323.2129853842376, 323.20918456608797, 323.2179542185867  …  323.6669328177843, 323.6666045251061, 323.6616069650192, 323.65670148145114, 323.651418060782, 323.65613067351796, 323.6602229136335, 323.66019117622847, 323.6436506517204, 323.60491238347504]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [24.955178750947333, 13.662068037571728, 7.130210693254198], :Pressure =&gt; [4.096943340112087e6, 4.1100433546865345e6, 4.1913241955219842e6, 4.260100737070407e6], :PhaseMassDensities =&gt; [967.2167987351274 967.2233423106816 967.2638931221644 967.2982025373113], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [283.60277767125865 364.6346095900564 243.0999312572204 243.10855415374635], :TotalThermalEnergy =&gt; [4.32188394326252e8, 5.556696197316333e8, 3.704415474386542e8, 3.7043742619010997e8], :FluidEnthalpy =&gt; [1.5281573911730312e6 1.5281573797922635e6 1.5281573309442783e6 1.528157277631177e6], :Temperature =&gt; [363.14999998501065, 363.1493079535763, 363.1449817929646, 363.14131606936314]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-25.1334708804276, -14.430832805021522, -6.933570814098945], :Pressure =&gt; [2.5e6, 2.5640453525010226e6, 2.675564744706118e6, 2.7601075509886267e6], :PhaseMassDensities =&gt; [988.9807912306181 989.0112749060418 988.9887133557995 988.9788225559273], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.98431357200957 372.84846666747563 248.55997410894415 248.55748827980682], :TotalThermalEnergy =&gt; [3.916973677207926e8, 5.036023090470522e8, 3.3587616229070175e8, 3.359688051732562e8], :FluidEnthalpy =&gt; [1.3532814971013286e6 1.3532814976605438e6 1.3539935633678732e6 1.3544653117941548e6], :Temperature =&gt; [323.4602488578861, 323.45614332681765, 323.6153661690858, 323.72013787318724]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.02495498083719111, -0.0031769818032809137, 0.005054384957847327], :Pressure =&gt; [3.4007271496325904e6, 3.439502627561791e6, 3.536374785815162e6, 3.613865327023247e6], :PhaseMassDensities =&gt; [987.85810783267 987.8686503126083 987.7087558753212 987.8791120399716], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [289.65512560658146 372.41770734405065 248.2382857075379 248.28110088156666], :TotalThermalEnergy =&gt; [3.951355362619527e8, 5.080487957467663e8, 3.390788712717721e8, 3.388209308262549e8], :FluidEnthalpy =&gt; [1.367601145370856e6 1.3676725022600167e6 1.369521458894144e6 1.3683248263399045e6], :Temperature =&gt; [326.740856895355, 326.75489724794124, 327.17839593888283, 326.895093018266]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [24.95517875, -25.133470881936706, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; ProducerControl{BottomHolePressureTarget{Float64}, Float64}(BottomHolePressureTarget with value 25.0 [bar], 1.0), :WellA =&gt; InjectorControl{TotalRateTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(TotalRateTarget with value 0.025 [m^3/s], [1.0], 998.20715, ((1, 1.0),), 363.15, missing, 1.0, missing)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = -1.0e-20, bhp = 2.5e6), :WellA =&gt; (rate = 0.025,)), 10), :SurfaceTemperature =&gt; [363.14999998501065, 323.4602488578861, 326.740856895355]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ⋮</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.7569716954702814e6, 2.721313531444414e6, 2.676325204528994e6, 2.620400399750992e6, 2.587595296107518e6, 2.5595666281485376e6, 2.531411500956492e6, 2.521885363240793e6, 2.5193409280503215e6, 2.5214480089460374e6  …  3.2442585574420565e6, 3.2172829878964564e6, 3.1793813733748393e6, 3.1218797720735176e6, 3.276616225705518e6, 3.277276693966444e6, 3.277126451427938e6, 3.269094539831287e6, 3.241318649312107e6, 3.2017504668312534e6], :TotalMasses =&gt; [455642.7786186299 1.4174886174904357e6 … 557389.3419130144 101359.95738378318], :TotalThermalEnergy =&gt; [1.6918702072752375e12, 5.264647119665191e12, 7.521225097116115e12, 7.716851318040832e12, 8.297312019134535e12, 8.326299593450873e12, 8.361295802711203e12, 7.586222292971964e12, 6.5808872936383e12, 5.065270783286874e12  …  5.947212905511025e12, 5.940711735637706e12, 4.649213425095088e12, 1.4881227239013982e12, 9.380965443816152e11, 5.252993584128464e12, 4.87284776042516e12, 3.1850673392145586e12, 2.058973959755606e12, 3.739200514110266e11], :FluidEnthalpy =&gt; [1.3560591765164286e6 1.3563376511562793e6 … 1.3499885119452458e6 1.3482828535502253e6], :Temperature =&gt; [324.0927760516957, 324.16015748582936, 324.1732297805123, 324.50727002662427, 325.15655943916477, 326.3475090485862, 327.78699516232587, 327.1099690314332, 324.16194474789125, 323.3986017324057  …  320.24700493170235, 319.8808396277962, 320.45900129449495, 320.54264815478365, 323.43732570823204, 323.4149580080057, 323.0725514857524, 322.96358723645005, 322.6429978879638, 322.246660809589]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-24.95517900566168, -13.67319363587427, -7.165344668840146], :Pressure =&gt; [1.8424595366224018e6, 1.905875348819113e6, 2.0155156633523726e6, 2.0994109658367513e6], :PhaseMassDensities =&gt; [977.5399813012375 977.5711120785825 977.7901480464647 977.7453119735789], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.6296928923187 368.53562688812156 245.74546766842 245.73419913424448], :TotalThermalEnergy =&gt; [4.1401282845884943e8, 5.3229524643561685e8, 3.546080561331269e8, 3.547307258699399e8], :FluidEnthalpy =&gt; [1.446301887385999e6 1.4463018108063885e6 1.4450504981372491e6 1.4457017649433222e6], :Temperature =&gt; [344.9460401217917, 344.942042113614, 344.651022268926, 344.7936429965045]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [25.210418939927063, 14.558439492443641, 7.010759898021397], :Pressure =&gt; [4.5e6, 4.514212073106482e6, 4.598010722804478e6, 4.669622132901021e6], :PhaseMassDensities =&gt; [1001.7883063999748 1001.7950710773323 1001.8349564768789 1001.869022292501], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.73967315824336 377.6678442838815 251.78858715017705 251.7971488234648], :TotalThermalEnergy =&gt; [3.4756334759743816e8, 4.4686482922099364e8, 2.9790072869461566e8, 2.978928953641738e8], :FluidEnthalpy =&gt; [1.187727938690787e6 1.1877279304247405e6 1.1877279197443423e6 1.1877279024349502e6], :Temperature =&gt; [283.15, 283.1501457457682, 283.1510156416016, 283.15169706175874]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-0.024955434359393586, -0.018354859120600937, -0.013058227497744926], :Pressure =&gt; [2.66649943423372e6, 2.7053805458314475e6, 2.802551252118102e6, 2.880298611341855e6], :PhaseMassDensities =&gt; [990.5420951780497 990.5704503388589 990.7860517578365 990.8870843307687], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.44211179972825 373.43626195772316 249.01169451853247 249.03708677364426], :TotalThermalEnergy =&gt; [3.881308773501342e8, 4.98988077281128e8, 3.322865694606038e8, 3.321417804067057e8], :FluidEnthalpy =&gt; [1.3390370060664224e6 1.3389379464586864e6 1.3372501562966483e6 1.3366108747724716e6], :Temperature =&gt; [320.11408852225543, 320.08836121008477, 319.68578676599094, 319.53073886843555]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [-24.95517875, 25.210418939927063, -0.02495517875], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; InjectorControl{BottomHolePressureTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(BottomHolePressureTarget with value 45.0 [bar], [1.0], 998.20715, ((1, 1.0),), 283.15, missing, 1.0, missing), :WellA =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -0.025 [m^3/s], 1.0)), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -2.5e-5 [m^3/s], 1.0), :WellB =&gt; InjectorControl{BottomHolePressureTarget{Float64}, Float64, Tuple{Tuple{Int64, Float64}}, Vector{Float64}, Missing, Missing}(BottomHolePressureTarget with value 45.0 [bar], [1.0], 998.20715, ((1, 1.0),), 283.15, missing, 1.0, missing), :WellA =&gt; ProducerControl{TotalRateTarget{Float64}, Float64}(TotalRateTarget with value -0.025 [m^3/s], 1.0)), Dict{Symbol, Any}(:WellObs =&gt; (bhp = 10000.0, rate = -2.5e-5), :WellB =&gt; (rate_lower = 1.0e-20, bhp = 4.5e6), :WellA =&gt; (bhp = 10000.0, rate = -0.025)), 232), :SurfaceTemperature =&gt; [344.9460401217917, 283.15, 320.11408852225543]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.8193211794138136e6, 2.804646861933363e6, 2.8015059132612403e6, 2.8013030080337636e6, 2.801002140865282e6, 2.8009853031938146e6, 2.8009490370538183e6, 2.8012202120746607e6, 2.8005656209210455e6, 2.802857625782902e6  …  2.973677239686759e6, 2.9735576179319643e6, 2.97110373732431e6, 2.968374200035247e6, 2.9698402901211227e6, 2.970960490308128e6, 2.972238136966318e6, 2.9725861437026905e6, 2.9683451758089676e6, 2.954070465557038e6], :TotalMasses =&gt; [455654.8347533039 1.4175380895186632e6 … 557327.116926204 101349.9297906472], :TotalThermalEnergy =&gt; [1.6918848360931926e12, 5.264723676151691e12, 7.521392306257976e12, 7.71709345663812e12, 8.297648652304697e12, 8.32669326126557e12, 8.361742996513945e12, 7.58662593407563e12, 6.581249753087801e12, 5.06550893073354e12  …  5.946867404087598e12, 5.940319756278465e12, 4.64898293486859e12, 1.488065032769955e12, 9.380511723020491e11, 5.2527357652833e12, 4.872588567642618e12, 3.184872661763881e12, 2.0588433020091462e12, 3.73891892940318e11], :FluidEnthalpy =&gt; [1.3560920150381613e6 1.356385887014533e6 … 1.349808000339594e6 1.3480940432898386e6], :Temperature =&gt; [324.0964072959402, 324.16602327515625, 324.18217243405394, 324.51993983170524, 325.1727041719821, 326.3662204618209, 327.80811659731313, 327.1311086107822, 324.1837864635347, 323.4177399109922  …  320.2241930764439, 319.8557127551675, 320.43980323740976, 320.5277483723094, 323.4174626254149, 323.3948572451441, 323.0510603373391, 322.93950551192205, 322.6183891599027, 322.21836089053863]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-1.4504575331521478e-7, -0.0032182994503047, -0.002600869654938439], :Pressure =&gt; [2.759796937293521e6, 2.7981556507802894e6, 2.894073155971992e6, 2.970817192401157e6], :PhaseMassDensities =&gt; [977.8658719469154 977.8842231801968 978.2228380961003 978.1393076366817], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.72524902043 368.6536669925122 245.85421453891732 245.8332210447045], :TotalThermalEnergy =&gt; [4.141508809627564e8, 5.324764397136962e8, 3.5453998268900347e8, 3.547159044787912e8], :FluidEnthalpy =&gt; [1.4472394639359394e6 1.447242676017824e6 1.4450325501742696e6 1.4459500256537548e6], :Temperature =&gt; [345.1010815515053, 345.09937541658314, 344.5912938985213, 344.7948130788]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [3.507144139476169e-7, 0.00099546413477825, 0.0007576019447468983], :Pressure =&gt; [2.7585268620614153e6, 2.7977923805670207e6, 2.8959566837900635e6, 2.9744914711086326e6], :PhaseMassDensities =&gt; [1001.0003166715171 1000.9839927343484 1001.0309329579602 1001.0682732263385], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.50862250232086 377.362074952225 251.58651399974917 251.5958986327748], :TotalThermalEnergy =&gt; [3.4728932392841244e8, 4.470412425371587e8, 2.9801592549823874e8, 2.980088217102404e8], :FluidEnthalpy =&gt; [1.1859895742811472e6 1.1874430822773483e6 1.187439477769342e6 1.1874454018449814e6], :Temperature =&gt; [282.6704957143165, 283.05436767955246, 283.0548176394726, 283.0574994940458]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [-1.525918615315531e-8, 0.0013542336125338971, 0.0010417383141162358], :Pressure =&gt; [2.758731924274923e6, 2.7975862377174017e6, 2.8947279966515717e6, 2.972459960347375e6], :PhaseMassDensities =&gt; [990.5763797169495 990.4422875758896 990.7258578784646 990.9142870808121], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.4521645515786 373.3879457343702 248.9965661465944 249.04392357041974], :TotalThermalEnergy =&gt; [3.881443544243002e8, 4.995224027754937e8, 3.325003769413311e8, 3.321683992964282e8], :FluidEnthalpy =&gt; [1.3391301713076823e6 1.3406353195351143e6 1.3382831201046363e6 1.3367740725954885e6], :Temperature =&gt; [320.13013843496265, 320.4809624887758, 319.92259793394663, 319.5632778061372]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 233), :SurfaceTemperature =&gt; [345.1010815515053, 282.6704957143165, 320.13013843496265]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.8186754427934545e6, 2.8040623295096178e6, 2.801040986415533e6, 2.800984369850079e6, 2.8007604063244355e6, 2.800821609620129e6, 2.8008656357106967e6, 2.8011755858824383e6, 2.800564245367982e6, 2.802917656488977e6  …  2.9719272404364957e6, 2.971947485971721e6, 2.9696110901510376e6, 2.967062035227958e6, 2.967862460640441e6, 2.968985006316665e6, 2.9702887563661598e6, 2.9706811097244457e6, 2.9665692572267787e6, 2.9524368832344697e6], :TotalMasses =&gt; [455654.7804548005 1.4175373959022241e6 … 557328.6069111542 101350.46451385763], :TotalThermalEnergy =&gt; [1.6918830048287808e12, 5.264731389726529e12, 7.521413200006389e12, 7.717120488695102e12, 8.297712738507711e12, 8.32677859256643e12, 8.361840397690799e12, 7.586695961571676e12, 6.581321347240923e12, 5.065526599262178e12  …  5.946766928193158e12, 5.940140847128316e12, 4.648897269581356e12, 1.488042499869775e12, 9.380498116669415e11, 5.252724006352631e12, 4.8725554553716875e12, 3.184821649049803e12, 2.058797315615798e12, 3.73876959211171e11], :FluidEnthalpy =&gt; [1.3560902325132515e6 1.3563878260445937e6 … 1.349775135774902e6 1.3480360273605909e6], :Temperature =&gt; [324.09603265459083, 324.16651424515817, 324.1831105328489, 324.5211279531097, 325.1753345352914, 326.36972587314875, 327.812123707931, 327.13427718828524, 324.18748040895366, 323.4189220536363  …  320.2185164700425, 319.845624560098, 320.4336085939256, 320.52265533272333, 323.41694880051483, 323.394076546161, 323.04873895368945, 322.9340669275676, 322.61082291585984, 322.2048762934071]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [3.494997460726639e-11, -0.003240151102822778, -0.00261549278266476], :Pressure =&gt; [2.759571925197378e6, 2.797930707954754e6, 2.8938485615170947e6, 2.9705929992785803e6], :PhaseMassDensities =&gt; [977.8657934210087 977.8878409710981 978.2258793948716 978.1461246496854], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.7252259954316 368.65503086755035 245.85497890066753 245.83493434694222], :TotalThermalEnergy =&gt; [4.141508449406515e8, 5.324680844221202e8, 3.5453527351169914e8, 3.547055344734542e8], :FluidEnthalpy =&gt; [1.447239224415992e6 1.4472144275190616e6 1.445008673693578e6 1.4458975363659193e6], :Temperature =&gt; [345.10104144310793, 345.0929741939619, 344.5858846667491, 344.7829048159573]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [3.193763648226012e-10, 0.0009721815057889641, 0.0007475458417354651], :Pressure =&gt; [2.756945551139835e6, 2.796211000942383e6, 2.8943750542549514e6, 2.9729096366878296e6], :PhaseMassDensities =&gt; [1000.9995990912093 1000.9811896691342 1001.0281647668935 1001.0655620833942], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.5084120967854 377.3610182215349 251.58581827745166 251.59521724823426], :TotalThermalEnergy =&gt; [3.472890747583668e8, 4.470725992019339e8, 2.980364436553143e8, 2.9802873753086257e8], :FluidEnthalpy =&gt; [1.1859879958055941e6 1.1875279222706272e6 1.187522736748256e6 1.1875261957862666e6], :Temperature =&gt; [282.6700538027426, 283.076717664707, 283.0767394060245, 283.07876284373924]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [9.815055085516857e-11, 0.0013500479512022984, 0.0010475435768136478], :Pressure =&gt; [2.7581392798483693e6, 2.7969934505976606e6, 2.8941346292617093e6, 2.971866403952951e6], :PhaseMassDensities =&gt; [990.5761591909666 990.435233557432 990.7209923307389 990.9144823294391], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.4520998899832 373.3852864320624 248.99534330107514 249.04397264175194], :TotalThermalEnergy =&gt; [3.881442683953236e8, 4.9954351986153275e8, 3.32510249411496e8, 3.321674342791734e8], :FluidEnthalpy =&gt; [1.3391295749576986e6 1.3407008249689054e6 1.3383287428622372e6 1.3367693353134755e6], :Temperature =&gt; [320.13003584295234, 320.4963484776662, 319.9333506765506, 319.56220247681404]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 234), :SurfaceTemperature =&gt; [345.10104144310793, 282.6700538027426, 320.13003584295234]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.8178152493314184e6, 2.803201770245884e6, 2.800179768067599e6, 2.80012218359077e6, 2.799897550633314e6, 2.7999581432579025e6, 2.8000011529564112e6, 2.8003114046458914e6, 2.7997005373336547e6, 2.8020544516410236e6  …  2.9710738389490712e6, 2.9710931105870465e6, 2.9687540362704177e6, 2.966201068609779e6, 2.9670097520041843e6, 2.9681322900500754e6, 2.9694361622713995e6, 2.969828323434897e6, 2.9657158746732124e6, 2.9515826123442044e6], :TotalMasses =&gt; [455654.6803851333 1.417536533663121e6 … 557330.3068201501 101351.0246517697], :TotalThermalEnergy =&gt; [1.6918812256803154e12, 5.264738962914802e12, 7.521433927633475e12, 7.717147691348133e12, 8.297777732539734e12, 8.326862518154398e12, 8.361935254597379e12, 7.586764803070088e12, 6.581392023328399e12, 5.065543577939348e12  …  5.946666963426488e12, 5.939963335044909e12, 4.648812027496603e12, 1.4880187229516594e12, 9.38048613117772e11, 5.252712951878313e12, 4.872523296860639e12, 3.1847711405038584e12, 2.058751783684187e12, 3.7386226513963837e11], :FluidEnthalpy =&gt; [1.356088425002367e6 1.3563896365524263e6 … 1.3497428897454138e6 1.3479791869021216e6], :Temperature =&gt; [324.09566607553745, 324.1669930863173, 324.1840367200085, 324.5223175984114, 325.1779954709276, 326.37316619044014, 327.8160182696714, 327.13738369249893, 324.19111739059736, 323.42004755361256  …  320.2128798416985, 319.8356245591018, 320.42745236706156, 320.5172876073324, 323.4165063241083, 323.3933540737637, 323.0464964231479, 322.92869404253577, 322.60334201257587, 322.1916170211495]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.3653606753350323e-10, -0.00324021651438528, -0.0026171507285380545], :Pressure =&gt; [2.7587065807120334e6, 2.7970653926380374e6, 2.89298320922963e6, 2.969727671524525e6], :PhaseMassDensities =&gt; [977.8654866503823 977.889634934136 978.223330102756 978.1492570992336], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.72513604558594 368.65570717568244 245.85433819367694 245.83572161738132], :TotalThermalEnergy =&gt; [4.1415071476165456e8, 5.324631947718669e8, 3.5453852539847445e8, 3.5470026607887536e8], :FluidEnthalpy =&gt; [1.4472383394837852e6 1.4471976242275133e6 1.4450247817159623e6 1.4458705907800265e6], :Temperature =&gt; [345.1008954182811, 345.08921294395043, 344.58959866791974, 344.7768393365477]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.6989511338633025e-10, 0.000997921534615724, 0.0007663629808503845], :Pressure =&gt; [2.756104326003411e6, 2.795369751471204e6, 2.893533696721378e6, 2.9720681951289116e6], :PhaseMassDensities =&gt; [1000.9992173682847 1000.9803305972475 1001.0273446350834 1001.0647196236197], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.508300169778 377.36069435906353 251.5856121558461 251.5950055149992], :TotalThermalEnergy =&gt; [3.472889420155219e8, 4.470796838221902e8, 2.9804076542739105e8, 2.980332789770337e8], :FluidEnthalpy =&gt; [1.1859871554244177e6 1.1875468751518147e6 1.1875400473166977e6 1.187544405239969e6], :Temperature =&gt; [282.6698185369589, 283.08170376677697, 283.0812900578621, 283.0835484472932]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.4371836292526993e-10, 0.0013276945411197691, 0.001032687105899442], :Pressure =&gt; [2.7572707262401273e6, 2.796124908572543e6, 2.8932662152690766e6, 2.9709981218485567e6], :PhaseMassDensities =&gt; [990.5758362823532 990.4361470428578 990.7222341640794 990.9162240192582], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.4520052082326 373.3856308079547 248.9956554078351 249.04441037614714], :TotalThermalEnergy =&gt; [3.881441416043922e8, 4.9953952328320026e8, 3.3250679027985394e8, 3.3216290338879704e8], :FluidEnthalpy =&gt; [1.3391286981415164e6 1.3406880078821993e6 1.3383122964333843e6 1.3367479163891186e6], :Temperature =&gt; [320.12988482345685, 320.49340029925713, 319.9295427275367, 319.5572264410271]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 235), :SurfaceTemperature =&gt; [345.1008954182811, 282.6698185369589, 320.12988482345685]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.8169481719722752e6, 2.802334703049702e6, 2.799312711820797e6, 2.799255143787162e6, 2.799030522876882e6, 2.799091096811483e6, 2.7991340682922094e6, 2.799444330216469e6, 2.7988334801458973e6, 2.8011873753930503e6  …  2.9702069085770054e6, 2.9702262139727166e6, 2.9678871032450413e6, 2.96533411931956e6, 2.9661427076181932e6, 2.9672652565303748e6, 2.968569146740404e6, 2.968961361203834e6, 2.964848961641185e6, 2.950715726467144e6], :TotalMasses =&gt; [455654.5752508321 1.417535664655552e6 … 557331.9970865224 101351.57609863653], :TotalThermalEnergy =&gt; [1.6918795337939407e12, 5.264746599267678e12, 7.521454677978873e12, 7.717175090958869e12, 8.297842840955324e12, 8.326946575813067e12, 8.36203007467333e12, 7.586833381131447e12, 6.58146259218168e12, 5.065560564858076e12  …  5.946567053338843e12, 5.939786792105837e12, 4.648726859082654e12, 1.4879949694758965e12, 9.380474137482623e11, 5.25270188678574e12, 4.872491194466323e12, 3.1847207051988506e12, 2.0587064013412007e12, 3.7384777034698834e11], :FluidEnthalpy =&gt; [1.3560866901863804e6 1.3563914623782919e6 … 1.3497107444677067e6 1.3479231097941552e6], :Temperature =&gt; [324.09531692810924, 324.16747592913356, 324.1849638686586, 324.5235158736534, 325.18066106447884, 326.37661190394545, 327.81991129642756, 327.1404782499964, 324.1947488082505, 323.4211735616766  …  320.2072461269214, 319.82567895867834, 320.42130133611715, 320.51192509462896, 323.41606338794315, 323.39263075322225, 323.0442576228035, 322.92332877602047, 322.59588550866914, 322.17853732634217]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.368149559416293e-10, -0.0032407720863094447, -0.002617531830943546], :Pressure =&gt; [2.7578394674659236e6, 2.7961983061298295e6, 2.8921160741296685e6, 2.9688605464559537e6], :PhaseMassDensities =&gt; [977.8651792526409 977.8913055854035 978.2206571236518 978.1521760910741], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.72504591186055 368.6563369963723 245.85366640075557 245.8364552400471], :TotalThermalEnergy =&gt; [4.1415058431688166e8, 5.324585805564435e8, 3.545419615748621e8, 3.546953165555756e8], :FluidEnthalpy =&gt; [1.4472374527434167e6 1.447181748807089e6 1.4450418203025647e6 1.445845256136186e6], :Temperature =&gt; [345.1007490953595, 345.08566253353484, 344.5935241533551, 344.7711398783635]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.751002478634117e-10, 0.0009984525805471502, 0.0007667239249372185], :Pressure =&gt; [2.7552373293739683e6, 2.794502731591161e6, 2.892666600636507e6, 2.971201038802619e6], :PhaseMassDensities =&gt; [1000.9988239504034 1000.9795385634104 1001.0265933479499 1001.0639443790213], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.5081848136303 377.36039576934144 251.58542333679495 251.5948106747804], :TotalThermalEnergy =&gt; [3.472888052058255e8, 4.470855682497337e8, 2.980442702250418e8, 2.980370210491576e8], :FluidEnthalpy =&gt; [1.1859862892970343e6 1.1875625422915223e6 1.1875540032238958e6 1.187559332071608e6], :Temperature =&gt; [282.66957606156893, 283.0858230885366, 283.08495620256195, 283.08746888910196]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.4349096838456917e-10, 0.0013299155547393884, 0.0010342177999979275], :Pressure =&gt; [2.756403547204628e6, 2.7952577491040425e6, 2.8923991606041742e6, 2.970131155666726e6], :PhaseMassDensities =&gt; [990.5755138848052 990.4374670796769 990.723096815045 990.9176560760236], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.45191067633425 373.3861284501116 248.99587221567 249.04477029126826], :TotalThermalEnergy =&gt; [3.881440150141354e8, 4.9953426587920016e8, 3.3250414437025666e8, 3.3215903700206566e8], :FluidEnthalpy =&gt; [1.3391278227124251e6 1.340671265165174e6 1.3382996296338674e6 1.3367295847659279e6], :Temperature =&gt; [320.12973404283053, 320.4895322208124, 319.9266224011184, 319.5529754210975]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 236), :SurfaceTemperature =&gt; [345.1007490953595, 282.66957606156893, 320.12973404283053]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.8160837698158487e6, 2.801470313073403e6, 2.7984483344208756e6, 2.7983907853055648e6, 2.798166178591261e6, 2.798226736360308e6, 2.798269673176465e6, 2.798579947692729e6, 2.797969116279122e6, 2.8003229931360395e6  …  2.969342622587446e6, 2.969361961891951e6, 2.967022809545299e6, 2.964469801224629e6, 2.965278302746773e6, 2.966400862695507e6, 2.967704772290865e6, 2.9680970411764546e6, 2.9639846933482746e6, 2.949851485220698e6], :TotalMasses =&gt; [455654.46701346396 1.4175347944398767e6 … 557333.6817808186 101352.11990203502], :TotalThermalEnergy =&gt; [1.6918779287180708e12, 5.264754304665199e12, 7.521475462194625e12, 7.717202694220052e12, 8.297908073508998e12, 8.327030774682021e12, 8.362124866066957e12, 7.586901710242877e12, 6.581533065456482e12, 5.065577566512964e12  …  5.94646720819008e12, 5.939611211141555e12, 4.648641771093611e12, 1.4879712411766904e12, 9.38046215857317e11, 5.252690824017483e12, 4.872459158315805e12, 3.184670347608919e12, 2.058661167271647e12, 3.738334660318288e11], :FluidEnthalpy =&gt; [1.3560850307859688e6 1.356393308132518e6 … 1.3496787042655284e6 1.347867767089259e6], :Temperature =&gt; [324.0949852284326, 324.1679632551665, 324.1858925771038, 324.52472315701823, 325.1833317909891, 326.38006345489885, 327.8238031767332, 327.14356157361635, 324.1983753305417, 323.4223005868787  …  320.20161610531716, 319.8157875467693, 320.4151561436102, 320.50656829211476, 323.4156210155741, 323.3919076124365, 323.04202345233176, 322.9179717974637, 322.5884533769011, 322.1656294512217]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.363912685546382e-10, -0.0032413648144785836, -0.0026179586770487574], :Pressure =&gt; [2.756975040243986e6, 2.7953339053885653e6, 2.8912516283921213e6, 2.967996111098909e6], :PhaseMassDensities =&gt; [977.8648728072403 977.8929621693496 978.2180707814714 978.1550161799084], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.7249560573761 368.65696151380695 245.8530163820681 245.83716903222447], :TotalThermalEnergy =&gt; [4.141504542761342e8, 5.32454000615564e8, 3.545452695787136e8, 3.5469048710404676e8], :FluidEnthalpy =&gt; [1.4472365687489596e6 1.447165989976736e6 1.4450582124102875e6 1.445820529440513e6], :Temperature =&gt; [345.10060322572434, 345.08213842989335, 344.5973026145275, 344.765578334476]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.7456447697530626e-10, 0.0009990086923346636, 0.0007671035077920745], :Pressure =&gt; [2.7543729870995283e6, 2.793638366142231e6, 2.891802159192727e6, 2.9703365373310605e6], :PhaseMassDensities =&gt; [1000.9984317363507 1000.9787492072417 1001.0258441789081 1001.0631729401393], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.50806981046355 377.36009818907655 251.5852350500783 251.59461679104245], :TotalThermalEnergy =&gt; [3.4728866881495315e8, 4.470914309603254e8, 2.980477662144665e8, 2.9804073729592264e8], :FluidEnthalpy =&gt; [1.1859854258213376e6 1.1875781513813508e6 1.1875679242802602e6 1.1875741544169236e6], :Temperature =&gt; [282.6693343265761, 283.0899271892863, 283.0886132421139, 283.09136188648364]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.4305099662485006e-10, 0.001332099561912399, 0.00103571112223935], :Pressure =&gt; [2.755539026421802e6, 2.794393248215533e6, 2.8915347646228974e6, 2.969266846715211e6], :PhaseMassDensities =&gt; [990.5751924754933 990.4388028168007 990.7239451245975 990.9190644723651], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.4518164342018 373.3866320111438 248.99608541911465 249.04512425987625], :TotalThermalEnergy =&gt; [3.881438888121235e8, 4.9952896325291127e8, 3.3250153161752665e8, 3.3215522374095696e8], :FluidEnthalpy =&gt; [1.3391269499670365e6 1.3406543828113042e6 1.3382871180748162e6 1.3367115011115517e6], :Temperature =&gt; [320.12958372444206, 320.4856312506767, 319.9237383640514, 319.54878246752475]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 237), :SurfaceTemperature =&gt; [345.10060322572434, 282.6693343265761, 320.12958372444206]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.815378427835123e6, 2.80076502893804e6, 2.797743184774434e6, 2.7976858253910863e6, 2.7974613255909258e6, 2.797521923986872e6, 2.7975648794491347e6, 2.797875183040165e6, 2.797264359160025e6, 2.7996182207948985e6  …  2.968637325775842e6, 2.9686567898593172e6, 2.966317666709734e6, 2.9637647479900247e6, 2.9645727157094697e6, 2.965695291686679e6, 2.9669992413173504e6, 2.9673915958037656e6, 2.9632793860796364e6, 2.9491463123835316e6], :TotalMasses =&gt; [455654.3858159704 1.417534016902182e6 … 557335.3965167482 101352.6627367553], :TotalThermalEnergy =&gt; [1.6918764494351873e12, 5.264762198536236e12, 7.52149644831943e12, 7.717230666697041e12, 8.297973592094e12, 8.327115261719516e12, 8.362219770836169e12, 7.586969940285721e12, 6.581603554595112e12, 5.065594693290293e12  …  5.946367634718659e12, 5.939436824961943e12, 4.648556932119642e12, 1.4879475885631018e12, 9.380450426698257e11, 5.252679896747371e12, 4.872427324347233e12, 3.1846201769594023e12, 2.0586161574390244e12, 3.7381936168841095e11], :FluidEnthalpy =&gt; [1.356083531130873e6 1.3563952576560213e6 … 1.349646873190505e6 1.3478132460132262e6], :Temperature =&gt; [324.0946805441453, 324.16846450946264, 324.1868321745864, 324.52594847594366, 325.1860160001249, 326.38352852438766, 327.82770133459195, 327.14664205504926, 324.20200445359217, 323.42343779734114  …  320.1960033677763, 319.8059654044221, 320.4090308906077, 320.50123052256936, 323.4151893730332, 323.39119501948835, 323.03980514964826, 322.9126365113041, 322.581059906202, 322.1529038024756]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.11171012772845e-10, -0.0032421376368869078, -0.0026183334820226055], :Pressure =&gt; [2.756270453933552e6, 2.794629347863118e6, 2.8905470370680043e6, 2.9672915362027497e6], :PhaseMassDensities =&gt; [977.8646230265542 977.8946795742845 978.2156483127802 978.1578478891045], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.7248828178537 368.65760896021413 245.85240754928057 245.83788071836906], :TotalThermalEnergy =&gt; [4.1415034828128105e8, 5.3244944223704416e8, 3.545484373265197e8, 3.546857757387477e8], :FluidEnthalpy =&gt; [1.4472358482135374e6 1.447150363138363e6 1.4450739554471367e6 1.4457964590462127e6], :Temperature =&gt; [345.10048432895064, 345.0786341514875, 344.60092346118535, 344.7601556967625]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.4234780473380118e-10, 0.0009994712049264387, 0.0007674546598144316], :Pressure =&gt; [2.753668164324099e6, 2.792933523045193e6, 2.891097247298339e6, 2.9696315711442814e6], :PhaseMassDensities =&gt; [1000.9981119072736 1000.9780329198807 1001.025166818735 1001.0624751773344], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.5079760316802 377.3598281551032 251.5850648108988 251.5944414241223], :TotalThermalEnergy =&gt; [3.4728855759560865e8, 4.470973142312616e8, 2.980512886171405e8, 2.980444610729344e8], :FluidEnthalpy =&gt; [1.185984721704507e6 1.1875938876557301e6 1.1875820245194116e6 1.1875890786771134e6], :Temperature =&gt; [282.66913720358394, 283.09406712093175, 283.09231979850523, 283.095284026878]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.1658403256090802e-10, 0.001334098702474132, 0.0010372112902089217], :Pressure =&gt; [2.754834458030561e6, 2.7936887020480935e6, 2.8908303298518285e6, 2.9685625039125145e6], :PhaseMassDensities =&gt; [990.5749305328854 990.4401978566265 990.7248627034419 990.9205296735474], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.45173962861776 373.387157928768 248.99631603183119 249.04549250509788], :TotalThermalEnergy =&gt; [3.8814378595985377e8, 4.9952368996877307e8, 3.324989178693411e8, 3.321514361346169e8], :FluidEnthalpy =&gt; [1.339126238695399e6 1.3406376603145036e6 1.3382746704288798e6 1.3366936053264393e6], :Temperature =&gt; [320.12946121766214, 320.4817576083583, 319.9208592437301, 319.5446235806986]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 238), :SurfaceTemperature =&gt; [345.10048432895064, 282.66913720358394, 320.12946121766214]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.814637085089541e6, 2.800023685701987e6, 2.797001819320978e6, 2.796944427430333e6, 2.7967199127938445e6, 2.7967804775065696e6, 2.796823380271354e6, 2.7971336906774514e6, 2.7965228851173827e6, 2.7988767241034936e6  …  2.9678960799437105e6, 2.9679155568203647e6, 2.9655763722160594e6, 2.963023395467315e6, 2.9638313905074554e6, 2.9649539765823064e6, 2.966257942212276e6, 2.9666503427466615e6, 2.9625381607935624e6, 2.9484050845067115e6], :TotalMasses =&gt; [455654.29432520433 1.4175332150656932e6 … 557337.0973884643 101353.1970820711], :TotalThermalEnergy =&gt; [1.691875041024787e12, 5.264770128111186e12, 7.521517428185329e12, 7.71725879474127e12, 8.298039191815205e12, 8.327199850166877e12, 8.362314609691239e12, 7.587037898083635e12, 6.581673929240617e12, 5.065611809110827e12  …  5.946268069751486e12, 5.939263304009958e12, 4.648472129907924e12, 1.487923948328833e12, 9.380438649643611e11, 5.252668937818111e12, 4.87239551873198e12, 3.1845700511929893e12, 2.058571265379812e12, 3.73805425709146e11], :FluidEnthalpy =&gt; [1.3560820806280575e6 1.356397205306968e6 … 1.3496151132614147e6 1.3477593616499864e6], :Temperature =&gt; [324.09438967796467, 324.1689676651341, 324.187771087057, 324.52718025172305, 325.188703150265, 326.3869973838958, 327.8315964173173, 327.14970984390465, 324.20562726640395, 323.42457385793534  …  320.1903906650879, 319.79619151653674, 320.4029078462655, 320.49589509751763, 323.41475569169745, 323.3904799773953, 323.03758840375014, 322.90730558271605, 322.5736853533506, 322.14032957530685]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.1701534602618496e-10, -0.0032427525951135416, -0.0026188474202153943], :Pressure =&gt; [2.7555288278478347e6, 2.793887749804549e6, 2.8898054074464343e6, 2.9665499227886037e6], :PhaseMassDensities =&gt; [977.8643601150771 977.896371473019 978.2133001650766 978.1605961082789], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.72480572818233 368.6582467910103 245.85181739539456 245.83857142118256], :TotalThermalEnergy =&gt; [4.141502367143401e8, 5.324449045049016e8, 3.545514691533149e8, 3.5468116509673125e8], :FluidEnthalpy =&gt; [1.4472350897994535e6 1.447134792226435e6 1.4450889980487782e6 1.4457728840415045e6], :Temperature =&gt; [345.1003591818947, 345.07514492486445, 344.6043875572683, 344.7548479325397]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.497442890888661e-10, 0.0009999623234486906, 0.0007677786250429793], :Pressure =&gt; [2.7529267196832323e6, 2.792192057375904e6, 2.8903557108420115e6, 2.9688899788781437e6], :PhaseMassDensities =&gt; [1000.997775459745 1000.9772972169571 1001.0244688819344 1001.061758617715], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.5078773801123 377.35955080163524 251.58488940024878 251.5942613330474], :TotalThermalEnergy =&gt; [3.4728844059744143e8, 4.4710323301899177e8, 2.9805484638545245e8, 2.9804820221059126e8], :FluidEnthalpy =&gt; [1.185983981002621e6 1.1876097045206504e6 1.187596253173671e6 1.1876040576729197e6], :Temperature =&gt; [282.6689298369196, 283.098227835036, 283.0960597250813, 283.09922011402426]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.227360084769554e-10, 0.00133622620247788, 0.0010386206652262281], :Pressure =&gt; [2.754092712244167e6, 2.792946977780067e6, 2.890088714828065e6, 2.9678209793983377e6], :PhaseMassDensities =&gt; [990.5746547686487 990.4415707525903 990.7257611526813 990.9219745012026], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.45165877032036 373.38767549835285 248.9965418367536 249.04585562989365], :TotalThermalEnergy =&gt; [3.881436776803088e8, 4.9951843581703e8, 3.3249631083542883e8, 3.3214765791480315e8], :FluidEnthalpy =&gt; [1.3391254898916148e6 1.3406209815409651e6 1.3382622380831034e6 1.3366757372441448e6], :Temperature =&gt; [320.1293322464172, 320.4778965588565, 319.9179860588575, 319.5404735309917]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 239), :SurfaceTemperature =&gt; [345.1003591818947, 282.6689298369196, 320.1293322464172]))</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Reservoir =&gt; OrderedDict{Symbol, Any}(:Pressure =&gt; [2.8139039883398726e6, 2.7992906031667846e6, 2.7962687571015037e6, 2.796211395289762e6, 2.7959869010427366e6, 2.796047453019533e6, 2.7960903247657022e6, 2.796400649120318e6, 2.7957898626096225e6, 2.7981436854458395e6  …  2.967163117226504e6, 2.9671826333408896e6, 2.9648434133618465e6, 2.9622904212625977e6, 2.9630982982706274e6, 2.9642208957260605e6, 2.965524881510753e6, 2.9659173387993984e6, 2.961805214881639e6, 2.947672172553388e6], :TotalMasses =&gt; [455654.20113666565 1.4175324156299403e6 … 557338.794312471 101353.72495912039], :TotalThermalEnergy =&gt; [1.6918737129211743e12, 5.264778124859361e12, 7.521538446813467e12, 7.717287119701887e12, 8.298104909886947e12, 8.327284569645449e12, 8.362409409182467e12, 7.587105621322182e12, 6.581744211989596e12, 5.065628943586267e12  …  5.946168586310281e12, 5.939090730013723e12, 4.64838742505653e12, 1.4879003383267866e12, 9.380426893712578e11, 5.252657986064604e12, 4.872363783491261e12, 3.184520007464314e12, 2.0585265162179358e12, 3.737916576523697e11], :FluidEnthalpy =&gt; [1.3560807017674872e6 1.3563991741858723e6 … 1.3495834564573034e6 1.34770612666801e6], :Temperature =&gt; [324.09411501684514, 324.16947524548783, 324.18871184270915, 324.52842080142494, 325.19139525732794, 326.3904717222743, 327.83548997162393, 327.15276710881045, 324.20924543752085, 323.42571126324066  …  320.1847826601279, 319.7864710434743, 320.3967919326347, 320.4905665934149, 323.4143228667906, 323.38976549172855, 323.03537663917854, 322.90198346625647, 322.5663343565012, 322.12790689400003]), :WellA =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.1566608948249203e-10, -0.0032434131266721317, -0.0026193235051418474], :Pressure =&gt; [2.754795752296655e6, 2.7931547022901904e6, 2.889072332926211e6, 2.9658168656453085e6], :PhaseMassDensities =&gt; [977.8641002347849 977.8980608332702 978.2110465660428 978.1632805578533], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [286.7247295273007 368.65888366482085 245.85125100418108 245.83924609694753], :TotalThermalEnergy =&gt; [4.1415012643389463e8, 5.324403809378696e8, 3.545543648220189e8, 3.546766557100701e8], :FluidEnthalpy =&gt; [1.4472343401297815e6 1.447119272292053e6 1.445103355969182e6 1.4457498240458667e6], :Temperature =&gt; [345.1002354779564, 345.07166673109145, 344.6076955802212, 344.74965660014465]), :WellB =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.4804176412825642e-10, 0.0010004881575517758, 0.000768144882734555], :Pressure =&gt; [2.7521937049030457e6, 2.791459021675574e6, 2.889622604430085e6, 2.9681568167245965e6], :PhaseMassDensities =&gt; [1000.9974428370042 1000.9765632090995 1001.0237714957547 1001.0610443230388], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [293.50777985003083 377.35927408719203 251.58471412798488 251.5940818112148], :TotalThermalEnergy =&gt; [3.472883249293737e8, 4.471091858909176e8, 2.980584383991906e8, 2.980519602483757e8], :FluidEnthalpy =&gt; [1.1859832487218182e6 1.1876256181423578e6 1.1876106257348068e6 1.187619109596507e6], :Temperature =&gt; [282.6687248264145, 283.10241422868205, 283.09983774035607, 283.10317557584773]), :WellObs =&gt; OrderedDict{Symbol, Any}(:TotalMassFlux =&gt; [1.2131310547676444e-10, 0.0013383154450585333, 0.001040074099721754], :Pressure =&gt; [2.7533595646229396e6, 2.7922138516619527e6, 2.8893556979725175e6, 2.9670880529612466e6], :PhaseMassDensities =&gt; [990.5743822009534 990.4429396738594 990.7266631698142 990.9234145608989], :Saturations =&gt; [1.0 1.0 1.0 1.0], :SurfaceWellConditions =&gt; JutulDarcy.TopConditions{1, Float64}[JutulDarcy.TopConditions{1, Float64}([998.20715], [1.0])], :TotalMasses =&gt; [290.4515788492979 373.38819156951314 248.99676853838542 249.04621755637066], :TotalThermalEnergy =&gt; [3.8814357065613586e8, 4.9951320547784466e8, 3.3249370407795215e8, 3.32143897820729e8], :FluidEnthalpy =&gt; [1.3391247497682325e6 1.3406043806489552e6 1.3382498107292969e6 1.3366579571029209e6], :Temperature =&gt; [320.12920477027745, 320.47405320880165, 319.9151135005903, 319.536343589911]), :Facility =&gt; OrderedDict{Symbol, Any}(:TotalSurfaceMassRate =&gt; [0.0, 0.0, 0.0], :WellGroupConfiguration =&gt; JutulDarcy.WellGroupConfiguration{Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, JutulDarcy.WellControlForce}, Dict{Symbol, Any}}(Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, JutulDarcy.WellControlForce}(:WellObs =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellB =&gt; DisabledControl{DisabledTarget}(DisabledTarget()), :WellA =&gt; DisabledControl{DisabledTarget}(DisabledTarget())), Dict{Symbol, Any}(:WellObs =&gt; nothing, :WellB =&gt; nothing, :WellA =&gt; nothing), 240), :SurfaceTemperature =&gt; [345.1002354779564, 282.6687248264145, 320.12920477027745]))</span></span></code></pre></div><p>We calibrate against the first two years. Since we have defined report steps of 1/4 month, this corresponds to the first 12_4_2 steps. To see the effect of more or less data used for calibration, and to exclude data from one or more of the wells and WellObs, you can change num_years_cal and wells_cal below.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">num_years_cal </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_steps </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 12</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">num_years_cal</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells_cal </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:WellA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:WellObs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:WellB</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">objective </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (model, state, dt, step_no, forces) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    well_mismatch_thermal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, wells_cal,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        states_hf, state, dt, step_no, forces;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        scale</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(hifi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dt[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_steps]),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        w_bhp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        w_temp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">si_unit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Kelvin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        w_energy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">#1 (generic function with 1 method)</span></span></code></pre></div><h3 id="Compute-mismatch-for-initial-proxy-model" tabindex="-1">Compute mismatch for initial proxy model <a class="header-anchor" href="#Compute-mismatch-for-initial-proxy-model" aria-label="Permalink to &quot;Compute mismatch for initial proxy model {#Compute-mismatch-for-initial-proxy-model}&quot;">​</a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obj0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Jutul</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">evaluate_objective</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    objective, proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model, states_proxy[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_steps],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dt[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_steps], proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">forces[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_steps])</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Initial proxy mismatch: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$obj0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Initial proxy mismatch: 37.46045966947307</span></span></code></pre></div><h2 id="Set-up-optimization" tabindex="-1">Set up optimization <a class="header-anchor" href="#Set-up-optimization" aria-label="Permalink to &quot;Set up optimization {#Set-up-optimization}&quot;">​</a></h2><p>We start by declaring the parameters to be optimized and their bounds</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">parameters </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_parameters</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">opt_config </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> optimization_config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model, parameters,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    use_scaling </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rel_min </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rel_max </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Dict{Symbol, Jutul.OptimizationConfig} with 5 entries:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  :WellObs   =&gt; OptimizationConfig(Dict{Symbol, Any}(:MaterialHeatCapacities=&gt;O…</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  :WellB     =&gt; OptimizationConfig(Dict{Symbol, Any}(:MaterialHeatCapacities=&gt;O…</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  :Reservoir =&gt; OptimizationConfig(Dict{Symbol, Any}(:RockDensity=&gt;OrderedDict{…</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  :WellA     =&gt; OptimizationConfig(Dict{Symbol, Any}(:MaterialHeatCapacities=&gt;O…</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  :Facility  =&gt; OptimizationConfig(Dict{Symbol, Any}(), false)</span></span></code></pre></div><p>We will only consider a subset of all the model parameters</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> well_symbols</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(proxy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (k, v) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> opt_config</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (ki, vi) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ki </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Volumetric properties</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            :FluidVolume</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:BulkVolume</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:active</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Reservoir</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_max</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        elseif</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ki </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Rock density and heat capacity</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            :RockDensity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:RockHeatCapacity</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:active</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Reservoir</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_max</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        elseif</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ki </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Conductive properties</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            :Transmissibilities</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            :RockThermalConductivities</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:FluidThermalConductivities</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:active</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Reservoir</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_max</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        elseif</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ki </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Well properties</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            :WellIndices</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:WellIndicesThermal</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:active</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wells</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rel_max</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        else</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            vi[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:active</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><h3 id="Calibrate-proxy-model" tabindex="-1">Calibrate proxy model <a class="header-anchor" href="#Calibrate-proxy-model" aria-label="Permalink to &quot;Calibrate proxy model {#Calibrate-proxy-model}&quot;">​</a></h3><p>Setting up the calibration requires a few steps, which we conveniently implement in the <code>calibrate_case</code> utility functions.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> run_optimization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(opt_setup;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    factr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, maxfun </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, maxiter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, m </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    lower </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> opt_setup</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">limits</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">min</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    upper </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> opt_setup</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">limits</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">max</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    x0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> opt_setup</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x0)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    setup </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:lower</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lower, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:upper</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> upper, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:x0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> copy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x0))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    prt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    f! </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> opt_setup</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">F_and_dF!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NaN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, x)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    g! </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (dFdx, x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> opt_setup</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">F_and_dF!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NaN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, dFdx, x)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    results, x_opt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LBFGSB</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lbfgsb</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f!, g!, x0, lb</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lower, ub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">upper,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        iprint </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prt,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        factr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> factr,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        maxfun </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> maxfun,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        maxiter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> maxiter,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        m </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> m</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (x_opt, results, setup)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> calibrate_case</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(objective, case, n_steps, opt_config; lbfgs_args </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NamedTuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    case </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> deepcopy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    _, cfg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_reservoir_simulator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        relaxation</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        tol_cnv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        tol_cnv_well</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        info_level</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    cfg[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:tolerances</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-6</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> well </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> well_symbols</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        cfg[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:tolerances</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][well][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-6</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    case_cal </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> case[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_steps]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    parameters </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_parameters</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case_cal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    opt_setup </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_parameter_optimization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        case_cal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model, case_cal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">state0, parameters, case_cal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dt,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        case_cal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">forces, objective, opt_config);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    x_opt, _, _ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> run_optimization</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(opt_setup; lbfgs_args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    case_cal </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> deepcopy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(opt_setup</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:case</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    params </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> case_cal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">parameters</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> opt_setup</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    params </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> devectorize_variables!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        params, case_cal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model, x_opt, data[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:mapper</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], config </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    case_cal </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> JutulCase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case_cal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model, case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dt, case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">forces;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        state0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">state0, parameters </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> case_cal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">parameters)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> case_cal</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">calibrate_case (generic function with 1 method)</span></span></code></pre></div><p>We use the LBFGS optimization algorithm, which has a number of parameters that can be set, including the maximum number of function evaluations (maxfun), and the maximum number of iterations (maxiter), both we set to 200 here. Increasing these numbers will likely give a better match.</p><div class="language-@example vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">@example</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>proxy_cal = calibrate_case(objective, proxy, n_steps, opt_config;</span></span>
<span class="line"><span>    lbfgs_args = (maxfun = 200, maxiter = 200, factr = 1e-6))</span></span></code></pre></div><h3 id="Simulate-the-full-schedule-using-the-calibrated-proxy" tabindex="-1">Simulate the full schedule using the calibrated proxy <a class="header-anchor" href="#Simulate-the-full-schedule-using-the-calibrated-proxy" aria-label="Permalink to &quot;Simulate the full schedule using the calibrated proxy {#Simulate-the-full-schedule-using-the-calibrated-proxy}&quot;">​</a></h3><div class="language-@example vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">@example</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>results_proxy_cal = simulate_reservoir(proxy_cal)</span></span>
<span class="line"><span>states_proxy_cal = results_proxy_cal.result.states</span></span>
<span class="line"><span>obj = Jutul.evaluate_objective(</span></span>
<span class="line"><span>    objective, proxy_cal.model, states_proxy_cal[1:n_steps],</span></span>
<span class="line"><span>    proxy_cal.dt[1:n_steps], proxy_cal.forces[1:n_steps])</span></span>
<span class="line"><span>println(&quot;Final proxy mismatch: $obj&quot;)</span></span></code></pre></div><h3 id="Plot-the-calibrated-results" tabindex="-1">Plot the calibrated results <a class="header-anchor" href="#Plot-the-calibrated-results" aria-label="Permalink to &quot;Plot the calibrated results {#Plot-the-calibrated-results}&quot;">​</a></h3><p>Finally, we plot the resulting production temperatures for the high-fidelity and proxy model. The calibrated proxy does a good job of reproducing the temperatures used for calibration, but the prediction for the remaining three years of storage are not perfect, with the calibrated proxy model showing mismatch comparable to the initial proxy model for WellA in the final year. The match in the observation well is almost perfect.</p><div class="language-@example vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">@example</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>fig = Figure(size = (800, 1200), fontsize = 20)</span></span>
<span class="line"><span>time_tot = results_hifi.wells.time/si_unit(:year)</span></span>
<span class="line"><span>for (wno, well) in enumerate(well_symbols(hifi.model))</span></span>
<span class="line"><span>    ax = Axis(fig[wno, 1], xlabel = &quot;Time (years)&quot;, ylabel = &quot;Temperature (°C)&quot;,</span></span>
<span class="line"><span>        title = &quot;Well: $well&quot;)</span></span>
<span class="line"><span>    plot_well_data!(ax, time_tot, states_hf,</span></span>
<span class="line"><span>        vcat([states_proxy], [states_proxy_cal], [states_proxy_cal]);</span></span>
<span class="line"><span>        wells = [well],</span></span>
<span class="line"><span>        field = :Temperature,</span></span>
<span class="line"><span>        nan_ix = [</span></span>
<span class="line"><span>            missing,</span></span>
<span class="line"><span>            n_steps+1:length(hifi.dt),</span></span>
<span class="line"><span>            1:n_steps-1],</span></span>
<span class="line"><span>        names=vcat(</span></span>
<span class="line"><span>            &quot;High-fidelity&quot;,</span></span>
<span class="line"><span>            &quot;Proxy (initial)&quot;,</span></span>
<span class="line"><span>            &quot;Proxy (calibration)&quot;,</span></span>
<span class="line"><span>            &quot;Proxy (prediction)&quot;),</span></span>
<span class="line"><span>        legend = wno == 2</span></span>
<span class="line"><span>        )</span></span>
<span class="line"><span>end</span></span>
<span class="line"><span>fig</span></span></code></pre></div><h2 id="Example-on-GitHub" tabindex="-1">Example on GitHub <a class="header-anchor" href="#Example-on-GitHub" aria-label="Permalink to &quot;Example on GitHub {#Example-on-GitHub}&quot;">​</a></h2><p>If you would like to run this example yourself, it can be downloaded from the Fimbul.jl GitHub repository <a href="https://github.com/sintefmath/Fimbul.jl/blob/main/examples/storage/egg_htates.jl" target="_blank" rel="noreferrer">as a script</a>.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">This example took 104.076549302 seconds to complete.</span></span></code></pre></div><hr><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl" target="_blank" rel="noreferrer">Literate.jl</a>.</em></p></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-4f9813fa><!--[--><!--]--><div class="edit-info" data-v-4f9813fa><div class="edit-link" data-v-4f9813fa><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://https://github.com/sintefmath/Fimbul.jl/edit/main/docs/src/examples/storage/egg_htates.md" target="_blank" rel="noreferrer" data-v-4f9813fa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-4f9813fa></span> Edit this page<!--]--></a></div><!----></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-4f9813fa><span class="visually-hidden" id="doc-footer-aria-label" data-v-4f9813fa>Pager</span><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link prev" href="/Fimbul.jl/previews/PR25/examples/storage/btes_demo" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Previous page</span><span class="title" data-v-4f9813fa>Borehole Thermal Energy Storage (BTES)</span><!--]--></a></div><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link next" href="/Fimbul.jl/previews/PR25/examples/production/doublet_demo" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Next page</span><span class="title" data-v-4f9813fa>Geothermal energy production from a well doublet</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860>Made with <a href="https://luxdl.github.io/DocumenterVitepress.jl/dev/" target="_blank"><strong>DocumenterVitepress.jl</strong></a><br></p><p class="copyright" data-v-c970a860>© Copyright 2025.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"examples_analytical_analytical_1d.md\":\"BKequpgS\",\"examples_production_doublet_demo.md\":\"h87_wa9i\",\"examples_storage_ates_demo.md\":\"Yjv9QL79\",\"examples_storage_btes_demo.md\":\"Df-IXJXQ\",\"examples_storage_egg_htates.md\":\"BCXCEcFa\",\"extras_refs.md\":\"DaPqex-e\",\"index.md\":\"DBC9CJnu\",\"man_cases_cases.md\":\"C-JQa8JW\",\"man_cases_utils.md\":\"Dfu3j1B6\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Fimbul.jl\",\"description\":\"Documentation for Fimbul.jl\",\"base\":\"/Fimbul.jl/previews/PR25/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"logo\":{\"src\":\"/logo.png\",\"width\":24,\"height\":24},\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"text\":\"Manual\",\"collapsed\":false,\"items\":[{\"text\":\"Introduction\",\"collapsed\":false,\"items\":[{\"text\":\"Fimbul.jl\",\"link\":\"/index\"}]},{\"text\":\"Cases\",\"collapsed\":false,\"items\":[{\"text\":\"Setup functions\",\"link\":\"/man/cases/cases\"},{\"text\":\"Utilities\",\"link\":\"/man/cases/utils\"}]},{\"text\":\"References\",\"collapsed\":false,\"items\":[{\"text\":\"Bibliography\",\"link\":\"/extras/refs\"}]}]},{\"text\":\"Examples\",\"collapsed\":false,\"items\":[{\"text\":\"Storage\",\"collapsed\":false,\"items\":[{\"text\":\"Aquifer Thermal Energy Storage (ATES)\",\"link\":\"/examples/storage/ates_demo\"},{\"text\":\"Borehole Thermal Energy Storage (BTES)\",\"link\":\"/examples/storage/btes_demo\"},{\"text\":\"Digital twinning of a high-temperature aquifer thermal energy storage system\",\"link\":\"/examples/storage/egg_htates\"}]},{\"text\":\"Production\",\"collapsed\":false,\"items\":[{\"text\":\"Geothermal energy production from a well doublet\",\"link\":\"/examples/production/doublet_demo\"}]},{\"text\":\"Analytical\",\"collapsed\":false,\"items\":[{\"text\":\"Heat equation in 1D\",\"link\":\"/examples/analytical/analytical_1d\"}]}]},{\"component\":\"VersionPicker\"}],\"sidebar\":[{\"text\":\"Manual\",\"collapsed\":false,\"items\":[{\"text\":\"Introduction\",\"collapsed\":false,\"items\":[{\"text\":\"Fimbul.jl\",\"link\":\"/index\"}]},{\"text\":\"Cases\",\"collapsed\":false,\"items\":[{\"text\":\"Setup functions\",\"link\":\"/man/cases/cases\"},{\"text\":\"Utilities\",\"link\":\"/man/cases/utils\"}]},{\"text\":\"References\",\"collapsed\":false,\"items\":[{\"text\":\"Bibliography\",\"link\":\"/extras/refs\"}]}]},{\"text\":\"Examples\",\"collapsed\":false,\"items\":[{\"text\":\"Storage\",\"collapsed\":false,\"items\":[{\"text\":\"Aquifer Thermal Energy Storage (ATES)\",\"link\":\"/examples/storage/ates_demo\"},{\"text\":\"Borehole Thermal Energy Storage (BTES)\",\"link\":\"/examples/storage/btes_demo\"},{\"text\":\"Digital twinning of a high-temperature aquifer thermal energy storage system\",\"link\":\"/examples/storage/egg_htates\"}]},{\"text\":\"Production\",\"collapsed\":false,\"items\":[{\"text\":\"Geothermal energy production from a well doublet\",\"link\":\"/examples/production/doublet_demo\"}]},{\"text\":\"Analytical\",\"collapsed\":false,\"items\":[{\"text\":\"Heat equation in 1D\",\"link\":\"/examples/analytical/analytical_1d\"}]}]}],\"editLink\":{\"pattern\":\"https://https://github.com/sintefmath/Fimbul.jl/edit/main/docs/src/:path\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/sintefmath/Fimbul.jl\"}],\"footer\":{\"message\":\"Made with <a href=\\\"https://luxdl.github.io/DocumenterVitepress.jl/dev/\\\" target=\\\"_blank\\\"><strong>DocumenterVitepress.jl</strong></a><br>\",\"copyright\":\"© Copyright 2025.\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>