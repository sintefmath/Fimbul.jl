<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Aquifer Thermal Energy Storage (ATES) | Fimbul.jl</title>
    <meta name="description" content="Documentation for Fimbul.jl">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/Fimbul.jl/previews/PR25/assets/style.2xBu0wxE.css" as="style">
    <link rel="preload stylesheet" href="/Fimbul.jl/previews/PR25/vp-icons.css" as="style">
    
    <script type="module" src="/Fimbul.jl/previews/PR25/assets/app.B51vbuG3.js"></script>
    <link rel="preload" href="/Fimbul.jl/previews/PR25/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/Fimbul.jl/previews/PR25/assets/chunks/theme.C8DtsskL.js">
    <link rel="modulepreload" href="/Fimbul.jl/previews/PR25/assets/chunks/framework.UmJHmbPe.js">
    <link rel="modulepreload" href="/Fimbul.jl/previews/PR25/assets/examples_storage_ates_demo.md.Yjv9QL79.lean.js">
    <script src="/Fimbul.jl/versions.js"></script>
    <script src="/Fimbul.jl/previews/PR25/siteinfo.js"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-492508fc></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-492508fc>Skip to content</a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle has-sidebar" data-v-822684d1 data-v-0f4f798b><a class="title" href="/Fimbul.jl/previews/PR25/" data-v-0f4f798b><!--[--><!--]--><!--[--><img class="VPImage logo" src="/Fimbul.jl/previews/PR25/logo.png" width="24" height="24" alt data-v-35a7d0b8><!--]--><span data-v-0f4f798b>Fimbul.jl</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Manual</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Introduction</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR25/index" data-v-acbfed09><!--[--><span data-v-acbfed09>Fimbul.jl</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Cases</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR25/man/cases/cases" data-v-acbfed09><!--[--><span data-v-acbfed09>Setup functions</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR25/man/cases/utils" data-v-acbfed09><!--[--><span data-v-acbfed09>Utilities</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>References</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR25/extras/refs" data-v-acbfed09><!--[--><span data-v-acbfed09>Bibliography</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup active" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Examples</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Storage</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link active" href="/Fimbul.jl/previews/PR25/examples/storage/ates_demo" data-v-acbfed09><!--[--><span data-v-acbfed09>Aquifer Thermal Energy Storage (ATES)</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR25/examples/storage/btes_demo" data-v-acbfed09><!--[--><span data-v-acbfed09>Borehole Thermal Energy Storage (BTES)</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR25/examples/storage/egg_htates" data-v-acbfed09><!--[--><span data-v-acbfed09>Digital twinning of a high-temperature aquifer thermal energy storage system</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Production</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR25/examples/production/doublet_demo" data-v-acbfed09><!--[--><span data-v-acbfed09>Geothermal energy production from a well doublet</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Analytical</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Fimbul.jl/previews/PR25/examples/analytical/analytical_1d" data-v-acbfed09><!--[--><span data-v-acbfed09>Heat equation in 1D</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><!----><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/sintefmath/Fimbul.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-04f5c5e9><span class="vpi-more-horizontal icon" data-v-04f5c5e9></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/sintefmath/Fimbul.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--[--><!--[--><div class="VPFlyout VPNolebaseEnhancedReadabilitiesMenu VPNolebaseEnhancedReadabilitiesMenuFlyout" aria-label="Enhanced Readability" role="menuitem" data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><span class="i-icon-park-outline:book-open option-icon" data-v-04f5c5e9></span><!----><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--]--></div></div></div><!--]--><!--]--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-168ddf5d><button data-v-168ddf5d>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-18756405><div class="curtain" data-v-18756405></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18756405><span class="visually-hidden" id="sidebar-aria-label" data-v-18756405> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Manual</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Introduction</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR25/index" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Fimbul.jl</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Cases</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR25/man/cases/cases" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Setup functions</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR25/man/cases/utils" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Utilities</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>References</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR25/extras/refs" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Bibliography</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible has-active" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Examples</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><section class="VPSidebarItem level-1 collapsible has-active" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Storage</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR25/examples/storage/ates_demo" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Aquifer Thermal Energy Storage (ATES)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR25/examples/storage/btes_demo" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Borehole Thermal Energy Storage (BTES)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR25/examples/storage/egg_htates" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Digital twinning of a high-temperature aquifer thermal energy storage system</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Production</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR25/examples/production/doublet_demo" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Geothermal energy production from a well doublet</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Analytical</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Fimbul.jl/previews/PR25/examples/analytical/analytical_1d" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Heat equation in 1D</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _Fimbul_jl_previews_PR25_examples_storage_ates_demo" data-v-83890dd9><div><h1 id="Aquifer-Thermal-Energy-Storage-ATES" tabindex="-1">Aquifer Thermal Energy Storage (ATES) <a class="header-anchor" href="#Aquifer-Thermal-Energy-Storage-ATES" aria-label="Permalink to &quot;Aquifer Thermal Energy Storage (ATES) {#Aquifer-Thermal-Energy-Storage-ATES}&quot;">​</a></h1><p>This example demonstrates comprehensive simulation and analysis of an Aquifer Thermal Energy Storage (ATES) system using Fimbul.jl. ATES systems store thermal energy by injecting hot water into subsurface aquifers during charging periods and extracting the heated water during discharge periods for heating applications.</p><p>The simulation models a two-well ATES system operating over multiple annual cycles, examining thermal efficiency, energy recovery rates, and aquifer temperature evolution. Key performance metrics include energy recovery efficiency and thermal plume propagation within the confined aquifer system.</p><p>Add required modules to namespace</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Jutul, JutulDarcy, Fimbul</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> HYPRE</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Statistics</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GLMakie</span></span></code></pre></div><p>Useful SI units</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Kelvin, joule, watt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> si_units</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Kelvin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:joule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:watt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kilogram </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> si_unit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:kilogram</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">meter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> si_unit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:meter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">darcy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> si_unit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:darcy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">9.86923266716013e-13</span></span></code></pre></div><h2 id="Geological-setup-and-model-configuration" tabindex="-1">Geological setup and model configuration <a class="header-anchor" href="#Geological-setup-and-model-configuration" aria-label="Permalink to &quot;Geological setup and model configuration {#Geological-setup-and-model-configuration}&quot;">​</a></h2><p>We first define the subsurface model with a layered aquifer system suitable for ATES operations. The model includes multiple geological layers with varying permeability and a confined aquifer target zone for thermal storage.</p><p><strong>ATES Operational Modes:</strong></p><ul><li><p><strong>Charging</strong>: Inject hot water through hot well, produce through cold well</p></li><li><p><strong>Discharging</strong>: Produce hot water through hot well, inject cold water through cold well</p></li><li><p><strong>Rest</strong>: No well activity to allow thermal equilibration</p></li></ul><p>The operational schedule includes charging from June to September, rest periods from October to November, and discharging from December to March. We simulate five years of operation with balanced injection/production rates to maintain stable aquifer pressure throughout the thermal storage cycles. Configure ATES system parameters and create simulation case. The system uses realistic geological and operational parameters for a medium-scale ATES installation with 400m well spacing.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">num_years </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">case, layers </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Fimbul</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ates</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    well_distance </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 400.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Distance between wells [m]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    temperature_charge </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> convert_to_si</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">85</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Celsius</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Hot injection temperature</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    temperature_discharge </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> convert_to_si</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Celsius</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Cold injection temperature</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    depths </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">850.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">900.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1050.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1300.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Layer boundaries [m]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    porosity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.05</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.35</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.05</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Layer porosities [-]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    permeability </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">darcy, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Layer permeabilities</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rock_thermal_conductivity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">watt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(meter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Kelvin),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rock_heat_capacity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 900.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">joule</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(kilogram</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Kelvin),   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Rock heat capacity</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    aquifer_layer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Primary aquifer for thermal storage (high permeability)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    utes_schedule_args </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (num_years </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> num_years,)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h2 id="Inspect-the-ATES-model" tabindex="-1">Inspect the ATES model <a class="header-anchor" href="#Inspect-the-ATES-model" aria-label="Permalink to &quot;Inspect the ATES model {#Inspect-the-ATES-model}&quot;">​</a></h2><p>We first visualize the computational mesh, well locations, and geological structure. The mesh is strategically refined around wells and within the aquifer layer to capture thermal and hydraulic interactions accurately.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">msh </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> physical_representation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">reservoir_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data_domain)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">600</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], zreversed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, aspect </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ATES system: mesh structure and well configuration&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Jutul</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_mesh_edges!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, msh, alpha </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> get_model_wells</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">colors </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:red</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:blue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Hot well = red, Cold well = blue</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (i, (k, w)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> enumerate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(wells)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    plot_well!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, msh, w, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> colors[i], linewidth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_cell_data!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, msh, layers,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :rainbow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    alpha </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR25/assets/yvzapow.BrcWyW1K.jpeg" alt=""></p><h3 id="Visualize-reservoir-properties" tabindex="-1">Visualize reservoir properties <a class="header-anchor" href="#Visualize-reservoir-properties" aria-label="Permalink to &quot;Visualize reservoir properties {#Visualize-reservoir-properties}&quot;">​</a></h3><p>Next, we examine the geological heterogeneity and porosity distribution that controls fluid flow and thermal transport within the aquifer system</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model, key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :porosity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, aspect </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :bilbao100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR25/assets/cverczh.CUSzY8LB.jpeg" alt=""></p><h2 id="Simulate-the-ATES-system" tabindex="-1">Simulate the ATES system <a class="header-anchor" href="#Simulate-the-ATES-system" aria-label="Permalink to &quot;Simulate the ATES system {#Simulate-the-ATES-system}&quot;">​</a></h2><p>Transitions between injection and production modes are numerically challenging, requiring small time steps to ensure convergence and physical consistency.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sim, cfg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> setup_reservoir_simulator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case; info_level </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JutulDarcy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ControlChangeTimestepSelector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">push!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(cfg[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:timestep_selectors</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], sel)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cfg[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:timestep_max_decrease</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-3</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # Prevent excessive timestep reduction</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">0.001</span></span></code></pre></div><p>Execute simulation (computation time: several minutes depending on system)</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">results </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> simulate_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case, simulator </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sim, config </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cfg)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">ReservoirSimResult with 130 entries:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  wells (2 present):</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Hot</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Cold</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    Results per well:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :lrat =&gt; Vector{Float64} of size (130,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :wrat =&gt; Vector{Float64} of size (130,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :temperature =&gt; Vector{Float64} of size (130,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :control =&gt; Vector{Symbol} of size (130,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :Aqueous_mass_rate =&gt; Vector{Float64} of size (130,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :bhp =&gt; Vector{Float64} of size (130,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :wcut =&gt; Vector{Float64} of size (130,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :mass_rate =&gt; Vector{Float64} of size (130,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">       :rate =&gt; Vector{Float64} of size (130,)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  states (Vector with 130 entries, reservoir variables for each state)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Pressure =&gt; Vector{Float64} of size (59450,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :TotalMasses =&gt; Matrix{Float64} of size (1, 59450)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :TotalThermalEnergy =&gt; Vector{Float64} of size (59450,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :FluidEnthalpy =&gt; Matrix{Float64} of size (1, 59450)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :Temperature =&gt; Vector{Float64} of size (59450,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :PhaseMassDensities =&gt; Matrix{Float64} of size (1, 59450)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :RockInternalEnergy =&gt; Vector{Float64} of size (59450,)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">    :FluidInternalEnergy =&gt; Matrix{Float64} of size (1, 59450)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  time (report time for each state)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     Vector{Float64} of length 130</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  result (extended states, reports)</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     SimResult with 130 entries</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  extra</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">     Dict{Any, Any} with keys :simulator, :config</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  Completed at Sep. 08 2025 9:09 after 3 minutes, 3 seconds, 19.09 milliseconds.</span></span></code></pre></div><h2 id="Visualize-ATES-results" tabindex="-1">Visualize ATES results <a class="header-anchor" href="#Visualize-ATES-results" aria-label="Permalink to &quot;Visualize ATES results {#Visualize-ATES-results}&quot;">​</a></h2><p>We examine the temperature field evolution throughout the simulation timeline. Interactive visualization allows exploration of thermal plume development and migration patterns around the well doublet system.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case, results</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :Temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    aspect </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :seaborn_icefire_gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR25/assets/rrjpsnz.hz9-PuHe.jpeg" alt=""></p><h3 id="Visualize-thermal-plume" tabindex="-1">Visualize thermal plume <a class="header-anchor" href="#Visualize-thermal-plume" aria-label="Permalink to &quot;Visualize thermal plume {#Visualize-thermal-plume}&quot;">​</a></h3><p>We plot temperature deviation from the initial state around the wells after the first and last charge and discharge stages, respectively.</p><p>Identify time steps for charge/discharge start and stop from the well controls when charging (injection) and discharging (production) phases begin and e</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">times </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> convert_from_si</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cumsum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dt), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:year</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> results</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_steps </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(states)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">is_control </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (f, ctrl) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Facility</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">control[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Hot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">isa</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ctrl</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ch_start </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> findall</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">diff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">is_control</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, InjectorControl) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">forces]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ch_stop </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> findall</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">diff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">is_control</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, InjectorControl) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">forces]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dch_start </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> findall</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">diff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">is_control</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, ProducerControl) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">forces]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dch_stop </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> findall</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">diff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">is_control</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, ProducerControl) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">forces]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">5-element Vector{Int64}:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  22</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  48</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">  74</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 100</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> 126</span></span></code></pre></div><p>Calculate temperature changes for visualization We focus on cells in the aquifer layer that show significant temperature changes (&gt;1°C) to visualize the thermal plume evolution during different operational phases</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">geo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> tpfv_geometry</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(msh)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cell_mask </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> geo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cell_centroids[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,:] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> .&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> geo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cell_centroids[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,:] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 900.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">T0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">state0[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">steps </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> vcat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ch_stop[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], dch_stop[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], ch_stop[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], dch_stop[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ΔT, cells_to_show </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [], []</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (n, step) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> enumerate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(steps)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ΔT_n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> states[step][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Reservoir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> T0</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Only visualize cells with significant temperature change (&gt;1°C)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    cells </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cell_mask </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.&amp;&amp;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> abs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(ΔT_n) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    push!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(cells_to_show, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">findall</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(cells))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ΔT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> push!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ΔT, ΔT_n[cells])</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><p>Set up consistent visualization parameters for all subplots Ensures proper axis limits and color scaling across different time steps</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">limits </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> extrema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(geo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cell_centroids[:, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">vcat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(cells_to_show</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)], dims</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Δx </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [xd[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> xd[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> xd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> limits]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">limits </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> tuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dx, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dx) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (l, dx) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> zip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(limits, Δx))</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">colorrange </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> extrema</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">vcat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ΔT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">(-19.94490410302518, 46.58880846107593)</span></span></code></pre></div><p>Plot temperature change after the first and last ATES operational cycles</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">600</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (n, ΔT_n) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> enumerate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ΔT)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Create subplot for each operational stage</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    row, col </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">÷</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    stage </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> col </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Charge&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Discharge&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[row, col],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$stage</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$(round(times[steps[n]], digits</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1))</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> years&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        limits </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> limits, zreversed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, azimuth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, aspect </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Visualize temperature changes with ice-fire colormap (blue=cold, red=hot)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    plot_cell_data!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, msh, ΔT_n,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        cells </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cells_to_show[n],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        colorrange </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> colorrange,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :seaborn_icefire_gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    hidedecorations!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#dbab09;--shiki-light-font-weight:bold;--shiki-dark:#ffea7f;--shiki-dark-font-weight:bold;">┌ </span><span style="--shiki-light:#dbab09;--shiki-light-font-weight:bold;--shiki-dark:#ffea7f;--shiki-dark-font-weight:bold;">Warning: </span><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">Assignment to `ax` in soft scope is ambiguous because a global variable by the same name exists: `ax` will be treated as a new local. Disambiguate by using `local ax` to suppress this warning or `global ax` to assign to the existing global variable.</span></span>
<span class="line"><span style="--shiki-light:#dbab09;--shiki-light-font-weight:bold;--shiki-dark:#ffea7f;--shiki-dark-font-weight:bold;">└ </span><span style="--shiki-light:#959da5;--shiki-dark:#959da5;">@ ates_demo.md:190</span></span></code></pre></div><p>Add shared colorbar for temperature scale reference</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Colorbar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(steps)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    colormap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :seaborn_icefire_gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    colorrange </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> colorrange,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Temperature Change (°C)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    vertical </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR25/assets/pliebqh.zHwYlpnA.jpeg" alt=""></p><h2 id="Analyze-ATES-performance" tabindex="-1">Analyze ATES performance <a class="header-anchor" href="#Analyze-ATES-performance" aria-label="Permalink to &quot;Analyze ATES performance {#Analyze-ATES-performance}&quot;">​</a></h2><p>Examine the well responses including flow rates, pressures, and temperatures interactively to understand operational behavior</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_well_results</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(results</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells)</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR25/assets/ctwzyqp.DPG1W1cq.jpeg" alt=""></p><h3 id="Analyze-derived-ATES-performance-metrics" tabindex="-1">Analyze derived ATES performance metrics <a class="header-anchor" href="#Analyze-derived-ATES-performance-metrics" aria-label="Permalink to &quot;Analyze derived ATES performance metrics {#Analyze-derived-ATES-performance-metrics}&quot;">​</a></h3><p>We examine key performance indicators for the ATES system: flow rate, temperature, thermal effect, and energy recovery efficiency. The efficiency (recovery factor) is the most critical metric, defined as the ratio of energy extracted during discharge to energy injected during charge phases.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> results</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">130-element Vector{OrderedDict{Symbol, Any}}:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Pressure =&gt; [1.4477050439034484e6, 1.3474514217245355e6, 1.3223635175216228e6, 1.32672066518567e6, 1.3353590441256755e6, 1.3430286379187596e6, 1.3487657498503693e6, 1.3524643591376464e6, 1.3533698722168654e6, 1.353507606275062e6  …  1.3636116785488175e7, 1.3636100756947832e7, 1.3635995296527017e7, 1.3635503361278348e7, 1.3634739056468284e7, 1.3633609591189584e7, 1.3631776173708586e7, 1.3628341211189048e7, 1.362356031615269e7, 1.3599942408800038e7], :TotalMasses =&gt; [3.5420643156185667e6 3.54189554332059e6 … 1.0361695101055986e6 1.0361589460226144e6], :TotalThermalEnergy =&gt; [1.8427281232890938e14, 1.8427263139961138e14, 2.122096378877315e14, 1.6424894567537006e14, 1.2712727412187281e14, 9.839490687298462e13, 7.615576303702616e13, 5.894228018490012e13, 5.630054043831631e13, 5.630053838259366e13  …  1.890193255095847e13, 1.8901932403087324e13, 1.953494105041159e13, 2.5238715706891375e13, 3.260802413341397e13, 4.2129180263199016e13, 5.443049899009914e13, 7.032376117149938e13, 6.106594223026686e13, 6.106593936873842e13], :FluidEnthalpy =&gt; [1.1959327798944148e6 1.1959331666621172e6 … 1.3482397062461434e6 1.348232303444835e6], :Temperature =&gt; [285.27133102644325, 285.270799398355, 285.2713229303317, 285.27000746971544, 285.26781893766787, 285.26413922349326, 285.2579984321908, 285.24790342338486, 285.24548371778303, 285.2454736185048  …  321.5349912025101, 321.53498867075155, 321.5343097259729, 321.53033597444715, 321.5279098765576, 321.52644326311014, 321.52555646201154, 321.52501582015174, 321.52527171988385, 321.52524182024564], :PhaseMassDensities =&gt; [1000.1122773511246 1000.0646239964018 … 994.7227297013728 994.712588181708], :RockInternalEnergy =&gt; [256744.19792379893, 256743.7194585195, 256744.1906372985, 256743.00672274388, 256741.03704390107, 256737.72530114395, 256732.19858897172, 256723.11308104638, 256720.93534600473, 256720.9262566543  …  289381.4920822591, 289381.4898036764, 289380.8787533756, 289377.30237700243, 289375.11888890184, 289373.7989367991, 289373.0008158104, 289372.5142381366, 289372.74454789545, 289372.7176382211], :FluidInternalEnergy =&gt; [1.194485237376751e6 1.1945858023124617e6 … 1.3345438692964413e6 1.3345600703089698e6])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Pressure =&gt; [1.4477049681027413e6, 1.3474506184245e6, 1.322361477643153e6, 1.326719575147986e6, 1.3353588338080156e6, 1.34302891820933e6, 1.348766287412142e6, 1.3524651526774534e6, 1.353370712843959e6, 1.3535084528576285e6  …  1.3636116694877861e7, 1.3636100667127993e7, 1.363599521593582e7, 1.3635503325338418e7, 1.3634739062269347e7, 1.3633609626170699e7, 1.3631776212930478e7, 1.3628341223331457e7, 1.3623560296178125e7, 1.3599942392977575e7], :TotalMasses =&gt; [3.5420652079308284e6 3.54189642159637e6 … 1.0361695398851306e6 1.0361589482008475e6], :TotalThermalEnergy =&gt; [1.8427139543922188e14, 1.8427123269035656e14, 2.1220851541936228e14, 1.6424731356770575e14, 1.2712502907896762e14, 9.839191576496828e13, 7.615186311165389e13, 5.893732562663474e13, 5.629536431275233e13, 5.629535639566994e13  …  1.890247271542775e13, 1.890247211157959e13, 1.9535459777368453e13, 2.5239095121018836e13, 3.2608276718664508e13, 4.212931876718804e13, 5.443053073080486e13, 7.032368767018158e13, 6.106592998484235e13, 6.1065938470393016e13], :FluidEnthalpy =&gt; [1.195924371894814e6 1.1959248704366738e6 … 1.348239428928103e6 1.3482322830960422e6], :Temperature =&gt; [285.2691315011217, 285.2686280724089, 285.2698098205093, 285.267164944061, 285.2627672095796, 285.2554434651001, 285.24334997657814, 285.2238597562319, 285.21918641572074, 285.2191465381906  …  321.54420289316886, 321.5441925854119, 321.542869165522, 321.5351817073504, 321.53040673225837, 321.5275029736178, 321.52574442878665, 321.5246789216404, 321.52520708286426, 321.5252370783517], :PhaseMassDensities =&gt; [1000.1125292981162 1000.0648719801515 … 994.7227582897235 994.7125902728118], :RockInternalEnergy =&gt; [256742.21835100953, 256741.765265168, 256742.82883845837, 256740.44844965488, 256736.4904886216, 256729.89911859008, 256719.01497892034, 256701.4737806087, 256697.26777414867, 256697.23188437155  …  289389.782603852, 289389.7733268707, 289388.5822489698, 289381.6635366153, 289377.36605903256, 289374.752676256, 289373.16998590797, 289372.2110294763, 289372.6863745778, 289372.71337051655], :FluidInternalEnergy =&gt; [1.1944768298176052e6 1.1945775072243689e6 … 1.3345435923921e6 1.3345600500048257e6])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Pressure =&gt; [1.4477053440916843e6, 1.3474511856430988e6, 1.322361929613858e6, 1.3267201923849792e6, 1.3353595087152198e6, 1.3430296015265645e6, 1.3487669956307954e6, 1.352466003491188e6, 1.3533715840218868e6, 1.3535093255784505e6  …  1.3636116611687386e7, 1.3636100584653925e7, 1.3635995141966498e7, 1.3635503292970786e7, 1.3634739070906341e7, 1.3633609665277714e7, 1.3631776259262243e7, 1.3628341245158095e7, 1.3623560281618489e7, 1.3599942378977612e7], :TotalMasses =&gt; [3.5420660966727575e6 3.541897299131644e6 … 1.0361695695636392e6 1.0361589503380735e6], :TotalThermalEnergy =&gt; [1.842699854262948e14, 1.842698388297528e14, 2.1220739502815516e14, 1.6424568762941744e14, 1.27122798040334e14, 9.838895552362953e13, 7.614803013742578e13, 5.893252785731632e13, 5.629036178446414e13, 5.629034558354907e13  …  1.890299623193415e13, 1.8902994964424633e13, 1.953596257962485e13, 2.523946828796983e13, 3.260852676935378e13, 4.212945643344382e13, 5.443056240483464e13, 7.032361451370653e13, 6.1065917781942766e13, 6.106593758924024e13], :FluidEnthalpy =&gt; [1.195916004684209e6 1.1959166029386122e6 … 1.348239152574775e6 1.3482322631371587e6], :Temperature =&gt; [285.2669426522399, 285.26646427691344, 285.26829951700864, 285.2643331675815, 285.25774699617324, 285.2468374448342, 285.2289529996435, 285.20057697104, 285.19377108708915, 285.19368912394884  …  321.5531306792422, 321.5531090537404, 321.55116583500177, 321.53994765406736, 321.53287853341635, 321.5285562745495, 321.5259320007154, 321.5243436037481, 321.5251426703143, 321.5252324272096], :PhaseMassDensities =&gt; [1000.1127802370138 1000.065119754817 … 994.7227867810918 994.7125923245488], :RockInternalEnergy =&gt; [256740.2483870159, 256739.8178492221, 256741.46956530778, 256737.89985082336, 256731.9722965559, 256722.1537003508, 256706.05769967916, 256680.519273936, 256674.39397838022, 256674.32021155395  …  289397.81761131797, 289397.79814836633, 289396.04925150156, 289385.9528886606, 289379.5906800747, 289375.7006470945, 289373.33880064386, 289371.90924337326, 289372.6284032829, 289372.70918448863], :FluidInternalEnergy =&gt; [1.1944684625942572e6 1.1945692394929463e6 … 1.3345433164456922e6 1.3345600300882175e6])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Pressure =&gt; [1.447705754856238e6, 1.3474518620393116e6, 1.322362580020338e6, 1.3267209459582502e6, 1.3353602551752145e6, 1.3430303180642435e6, 1.34876771620467e6, 1.3524668411081827e6, 1.3533724363329452e6, 1.3535101789050002e6  …  1.3636116535113009e7, 1.3636100508706277e7, 1.3635995073681302e7, 1.3635503262702351e7, 1.3634739079326892e7, 1.3633609702489272e7, 1.3631776302383048e7, 1.3628341263218263e7, 1.3623560265236674e7, 1.3599942364432618e7], :TotalMasses =&gt; [3.542066981165072e6 3.5418981738142893e6 … 1.0361695991381117e6 1.0361589524335972e6], :TotalThermalEnergy =&gt; [1.842685822532745e14, 1.8426844979757778e14, 2.1220627670828228e14, 1.6424406783759862e14, 1.2712058093147069e14, 9.838602588688856e13, 7.614426324656736e13, 5.8927881663760234e13, 5.628552685377666e13, 5.62855002021716e13  …  1.890350361793065e13, 1.8903501496796824e13, 1.9536449970783633e13, 2.523983527932675e13, 3.260877430511802e13, 4.2129593265671695e13, 5.443059401186672e13, 7.032354170042537e13, 6.106590562147501e13, 6.106593672513035e13], :FluidEnthalpy =&gt; [1.195907678050165e6 1.1959083640664164e6 … 1.3482388771818029e6 1.3482322435640583e6], :Temperature =&gt; [285.264764421543, 285.2643079773205, 285.2667920062382, 285.26151209645195, 285.2527581277643, 285.23832039980766, 285.2148042413512, 285.17802976791245, 285.1692072491796, 285.1690721917502  …  321.56178338498955, 321.56174720220656, 321.55920820919533, 321.54463472880195, 321.5353254741344, 321.5296031942513, 321.52611917588604, 321.5240098589089, 321.52507848173815, 321.52522786602736], :PhaseMassDensities =&gt; [1000.1130299760202 1000.0653667240346 … 994.7228151725855 994.7125943362515], :RockInternalEnergy =&gt; [256738.28797938873, 256737.87717958848, 256740.11280561436, 256735.36088680677, 256727.48231498786, 256714.4883598269, 256693.3238172161, 256660.2267911212, 256652.2865242616, 256652.1649725752  …  289405.6050464906, 289405.5724819859, 289403.2873882758, 289390.17125592177, 289381.792926721, 289376.64287482615, 289373.5072582974, 289371.608873018, 289372.5706335643, 289372.7050794246], :FluidInternalEnergy =&gt; [1.194460135910962e6 1.1945610002771341e6 … 1.3345430414600968e6 1.33456001055739e6])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Pressure =&gt; [1.447706167841581e6, 1.347452549034902e6, 1.3223632493577765e6, 1.3267217124361265e6, 1.3353610089779883e6, 1.3430310384371215e6, 1.3487684363001944e6, 1.3524676604051152e6, 1.353373266484549e6, 1.353511009843531e6  …  1.3636116465007816e7, 1.3636100439137936e7, 1.3635995010999693e7, 1.3635503234789915e7, 1.3634739088178355e7, 1.3633609739046281e7, 1.3631776344301434e7, 1.3628341280026674e7, 1.3623560248326581e7, 1.3599942349759571e7], :TotalMasses =&gt; [3.5420678613755982e6 3.5418990454896763e6 … 1.0361696286093427e6 1.0361589544879625e6], :TotalThermalEnergy =&gt; [1.842671858841689e14, 1.84267065575647e14, 2.12205160458044e14, 1.6424245417142003e14, 1.2711837767880973e14, 9.838312659426611e13, 7.614056156723481e13, 5.89233820129879e13, 5.628085373443148e13, 5.628081470278699e13  …  1.890399537479786e13, 1.8903992226786133e13, 1.953692244725714e13, 2.5240196167498414e13, 3.2609019345508336e13, 4.212972926757568e13, 5.443062555159003e13, 7.032346922870774e13, 6.106589350335042e13, 6.106593587791627e13], :FluidEnthalpy =&gt; [1.1958993917797485e6 1.1959001537137844e6 … 1.3482386027475803e6 1.3482322243735392e6], :Temperature =&gt; [285.26259675307585, 285.26215914515353, 285.2652872854575, 285.258701694085, 285.2478004386429, 285.22989157263817, 285.20090042675173, 285.15619372170016, 285.14546550375917, 285.14526755003277  …  321.5701695605891, 321.5701158659406, 321.5670044792357, 321.54924385631443, 321.53774774767686, 321.53064376106323, 321.52630595245745, 321.5236776796515, 321.5250145166685, 321.525223394029], :PhaseMassDensities =&gt; [1000.1132785060512 1000.0656128441439 … 994.7228434649672 994.7125963084422], :RockInternalEnergy =&gt; [256736.33707776826, 256735.9432306382, 256738.75855691172, 256732.8315246765, 256723.0203947786, 256706.90241537435, 256680.81038407655, 256640.57434953016, 256630.91895338325, 256630.7407950295  …  289413.15260453016, 289413.10427934653, 289410.3040313122, 289394.319470683, 289383.97297290916, 289377.5793849569, 289373.67535721173, 289371.30991168635, 289372.51306500164, 289372.7010546261], :FluidInternalEnergy =&gt; [1.1944518495873238e6 1.1945527895691432e6 … 1.3345427674324175e6 1.3345599914087297e6])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Pressure =&gt; [1.4477065799039586e6, 1.3474532370559939e6, 1.3223639200986188e6, 1.3267224796041746e6, 1.3353617636447332e6, 1.3430317595431875e6, 1.3487691543525478e6, 1.3524684613085298e6, 1.353374074744023e6, 1.3535118186876224e6  …  1.3636116401165204e7, 1.3636100375743123e7, 1.363599495376786e7, 1.3635503209332313e7, 1.3634739097777296e7, 1.3633609775600465e7, 1.363177638614585e7, 1.3628341297047772e7, 1.3623560231686844e7, 1.3599942335219176e7], :TotalMasses =&gt; [3.5420687373215575e6 3.541899914152983e6 … 1.0361696579779082e6 1.0361589565016424e6], :TotalThermalEnergy =&gt; [1.8426579628323347e14, 1.8426568614598634e14, 2.122040462760236e14, 1.6424084661024253e14, 1.2711618820906169e14, 9.838025738666716e13, 7.613692422447831e13, 5.891902404572153e13, 5.627633684567434e13, 5.627628372515355e13  …  1.8904471988343406e13, 1.890446765594556e13, 1.953738048886422e13, 2.5240551025613973e13, 3.2609261909995688e13, 4.212986444285666e13, 5.4430657023697805e13, 7.032339709692988e13, 6.106588142747937e13, 6.106593504745189e13], :FluidEnthalpy =&gt; [1.195891145661063e6 1.1958919717743641e6 … 1.3482383292703251e6 1.348232205562374e6], :Temperature =&gt; [285.2604395913407, 285.26001775248494, 285.2637853527127, 285.25590192450267, 285.24287376387036, 285.22155021003414, 285.1872382692643, 285.13504525027673, 285.12251749675806, 285.1222479650489  …  321.5782974906532, 321.57822359806767, 321.5745625624561, 321.55377597056525, 321.5401455465152, 321.5316780033015, 321.52649232861387, 321.52334705853406, 321.52495077463266, 321.5252190104434], :PhaseMassDensities =&gt; [1000.1135258319691 1000.0658581137834 … 994.72287165879 994.7125982415748], :RockInternalEnergy =&gt; [256734.3956322066, 256734.01597723644, 256737.40681744146, 256730.3117320524, 256718.58638748332, 256699.39518903074, 256668.51444233788, 256621.54072524907, 256610.26574708225, 256610.02316854402  …  289420.4677415879, 289420.4012382609, 289417.1063062105, 289398.3983735087, 289386.13099186367, 289378.51020297135, 289373.84309575247, 289371.0123526807, 289372.4556971694, 289372.697109399], :FluidInternalEnergy =&gt; [1.194443603414597e6 1.1945446072721928e6 … 1.334542494360077e6 1.334559972638753e6])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Pressure =&gt; [1.447706990972175e6, 1.3474539258716647e6, 1.3223645918578757e6, 1.32672324721561e6, 1.3353625190119809e6, 1.3430324811995008e6, 1.3487698700767744e6, 1.3524692443036104e6, 1.353374861765108e6, 1.3535126060881817e6  …  1.3636116343321612e7, 1.3636100318258028e7, 1.3635994901752865e7, 1.3635503186249943e7, 1.3634739108059919e7, 1.3633609812038623e7, 1.363177642770554e7, 1.3628341313987186e7, 1.3623560215151165e7, 1.3599942320755847e7], :TotalMasses =&gt; [3.542069609025212e6 3.5419007798150666e6 … 1.0361696872439529e6 1.036158958474964e6], :TotalThermalEnergy =&gt; [1.8426441341493078e14, 1.842643114907102e14, 2.122029341608271e14, 1.642392451334983e14, 1.2711401244918353e14, 9.837741800634973e13, 7.613335034120419e13, 5.89148030701671e13, 5.627197080469437e13, 5.627190209102397e13  …  1.8904933929281e13, 1.89049282698162e13, 1.9537824559401195e13, 2.5240899927419316e13, 3.2609502017974016e13, 4.212999879521256e13, 5.443068842788795e13, 7.032332530347479e13, 6.1065869393771445e13, 6.106593423359208e13], :FluidEnthalpy =&gt; [1.1958829394833944e6 1.1958838181421922e6 … 1.3482380567479392e6 1.3482321871272589e6], :Temperature =&gt; [285.2582928811692, 285.25788377154805, 285.2622862061237, 285.2531127518813, 285.2379779390786, 285.2132955626461, 285.1738144742656, 285.11456158435226, 285.10033587984174, 285.09998712775575  …  321.5861752023981, 321.5860786786622, 321.5818901118107, 321.55823201339206, 321.5425190623596, 321.5327059492589, 321.52667830256615, 321.52301798814483, 321.52488725515354, 321.5252147145044], :PhaseMassDensities =&gt; [1000.1137719600598 1000.0661025360187 … 994.722899754193 994.7126001359636], :RockInternalEnergy =&gt; [256732.4635930523, 256732.09539439325, 256736.05758551133, 256727.80147669316, 256714.1801451707, 256691.96600638152, 256656.43302683905, 256603.10542591702, 256590.30229185757, 256589.98841498018  …  289427.5576821583, 289427.47081079596, 289423.70110062964, 289402.40881205286, 289388.26715612365, 289379.435354333, 289374.01047230954, 289370.7161893303, 289372.3985296382, 289372.693243054], :FluidInternalEnergy =&gt; [1.194435397182147e6 1.1945364532805549e6 … 1.3345422222411458e6 1.3345599542442162e6])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Pressure =&gt; [1.4477074011093806e6, 1.3474546156574858e6, 1.3223652649898431e6, 1.3267240155255902e6, 1.335363275175769e6, 1.3430332033445255e6, 1.348770583254937e6, 1.3524700098838874e6, 1.3533756281965387e6, 1.3535133726907554e6  …  1.363611629124607e7, 1.3636100266452445e7, 1.3635994854761919e7, 1.3635503165530603e7, 1.3634739119106814e7, 1.3633609848541172e7, 1.3631776469288079e7, 1.362834133123724e7, 1.3623560198931029e7, 1.3599942306438195e7], :TotalMasses =&gt; [3.5420704765089303e6 3.5419016424874305e6 … 1.0361697164077924e6 1.0361589604083089e6], :TotalThermalEnergy =&gt; [1.8426303724391803e14, 1.842629415919987e14, 2.1220182411104347e14, 1.6423764972066553e14, 1.2711185032636216e14, 9.83746081968826e13, 7.612983903905544e13, 5.8910714556000836e13, 5.626775041932643e13, 5.6267664797833516e13  …  1.890538165369769e13, 1.8905374538438652e13, 1.9538255107195242e13, 2.5241242947180934e13, 3.2609739688764297e13, 4.213013232833903e13, 5.443071976386391e13, 7.0323253846733414e13, 6.106585740213611e13, 6.106593343619286e13], :FluidEnthalpy =&gt; [1.1958747730371777e6 1.195875692711688e6 … 1.3482377851784374e6 1.348232169064955e6], :Temperature =&gt; [285.2561565676955, 285.25575717467933, 285.2607898437889, 285.2503341404784, 285.23311280041736, 285.2051268849362, 285.1606257423939, 285.09472073828476, 285.0788942733291, 285.0784596217406  …  321.59381047361103, 321.59368912346747, 321.58899452500583, 321.56261293328225, 321.544868486199, 321.5337276272112, 321.5268638725583, 321.52269046110877, 321.5248239577532, 321.52521050545226], :PhaseMassDensities =&gt; [1000.1140168966391 1000.066346114098 … 994.7229277514789 994.7126019919747], :RockInternalEnergy =&gt; [256730.54091092595, 256730.1814572114, 256734.71085941003, 256725.30072643055, 256709.80152037562, 256684.61419644256, 256644.5631681545, 256585.24866445627, 256571.0048459962, 256570.61365956653  …  289434.42942624993, 289434.3202111207, 289430.09507250524, 289406.351639954, 289390.3816375791, 289380.3548644901, 289374.17748530244, 289370.4214149979, 289372.34156197787, 289372.689454907], :FluidInternalEnergy =&gt; [1.1944272306803556e6 1.1945283274884773e6 … 1.3345419510734305e6 1.3345599362218168e6])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Pressure =&gt; [1.4477078105144126e6, 1.3474553070059347e6, 1.3223659406265474e6, 1.3267247853515027e6, 1.3353640325394669e6, 1.3430339260657553e6, 1.3487712937492684e6, 1.3524707585586533e6, 1.353376374687962e6, 1.353514119141034e6  …  1.363611624470736e7, 1.3636100220095942e7, 1.3635994812598307e7, 1.363550314713897e7, 1.363473913094855e7, 1.3633609885187898e7, 1.3631776511025414e7, 1.3628341348963797e7, 1.3623560183112573e7, 1.3599942292294035e7], :TotalMasses =&gt; [3.5420713397951857e6 3.5419025021822373e6 … 1.0361697454696863e6 1.0361589623020368e6], :TotalThermalEnergy =&gt; [1.842616677350463e14, 1.8426157643209884e14, 2.1220071612524825e14, 1.642360603512709e14, 1.271097017680159e14, 9.837182770312184e13, 7.612638943925611e13, 5.890675412860218e13, 5.626367068105907e13, 5.626356701263616e13  …  1.8905815603504848e13, 1.8905806916846207e13, 1.953867256563619e13, 2.524158015959358e13, 3.26099749416171e13, 4.2130265045929305e13, 5.44307510313343e13, 7.032318272510401e13, 6.106584545248241e13, 6.106593265511143e13], :FluidEnthalpy =&gt; [1.1958666461139964e6 1.1958675953776597e6 … 1.3482375145597872e6 1.348232151372237e6], :Temperature =&gt; [285.25403059635494, 285.25363793431995, 285.25929626379076, 285.24756605463756, 285.22827818455835, 285.1970434351104, 285.14766877272064, 285.0755014820895, 285.0581672306629, 285.0576408924086  …  321.6012108403412, 321.60106269230715, 321.59588295327416, 321.56691968419307, 321.5471940083267, 321.5347430654153, 321.5270490368647, 321.5223644700842, 321.5247608819517, 321.52520638253304], :PhaseMassDensities =&gt; [1000.1142606480523 1000.0665888514552 … 994.7229556508971 994.7126038099535], :RockInternalEnergy =&gt; [256728.62753671943, 256728.27414088795, 256733.36663741167, 256722.8094491738, 256705.4503661025, 256677.33909159937, 256632.90189544857, 256567.95133388057, 256552.3505075966, 256551.87680316772  …  289441.0897563071, 289440.95642307645, 289436.29465794674, 289410.22771577374, 289392.474607494, 289381.26875887375, 289374.34413317824, 289370.12802307575, 289372.2847937565, 289372.68574427976], :FluidInternalEnergy =&gt; [1.1944191037006162e6 1.1945202297901807e6 … 1.3345416808548155e6 1.334559918568306e6])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Pressure =&gt; [1.4477075566302438e6, 1.3474539449274617e6, 1.3223628661617264e6, 1.3267230538821183e6, 1.335363561230758e6, 1.3430341507840191e6, 1.3487718456627033e6, 1.3524714807721947e6, 1.3533771265837778e6, 1.353514879282424e6  …  1.3636120105589315e7, 1.3636104476638535e7, 1.3636000752059152e7, 1.3635516210957957e7, 1.3634768899705272e7, 1.3633672649369933e7, 1.3631890926101051e7, 1.3628498518703798e7, 1.362364740315097e7, 1.3599971264176892e7], :TotalMasses =&gt; [3.54207230644327e6 3.5419034633601233e6 … 1.0361698171121095e6 1.0361589773703415e6], :TotalThermalEnergy =&gt; [1.842601323486978e14, 1.8426004440170384e14, 2.121994712720977e14, 1.6423427712346753e14, 1.2710729544698745e14, 9.836872295813261e13, 7.612255753029e13, 5.8902398975919336e13, 5.625919104787672e13, 5.625906624479706e13  …  1.8906292989101848e13, 1.8906282447660805e13, 1.9539131939279355e13, 2.524195490560471e13, 3.2610237658650918e13, 4.213041368211466e13, 5.443078614716843e13, 7.0323103018518445e13, 6.106583204967275e13, 6.106593179146938e13], :FluidEnthalpy =&gt; [1.1958575348399454e6 1.1958585082833369e6 … 1.3482372381356456e6 1.3482321408159975e6], :Temperature =&gt; [285.2516471217051, 285.2512596430945, 285.2576181751851, 285.244460333777, 285.22286355674606, 285.1880173223076, 285.1332758227149, 285.0543667014824, 285.0354085377145, 285.03477482580297  …  321.60935194315937, 321.6091721648017, 321.60346302356163, 321.5717058087378, 321.5497910381827, 321.5358803380045, 321.52725706262646, 321.5219992277698, 321.524690190374, 321.52520184197743], :PhaseMassDensities =&gt; [1000.1145335839819 1000.0668602428583 … 994.7230244276233 994.7126182755261], :RockInternalEnergy =&gt; [256726.4824095346, 256726.13367878506, 256731.85635766658, 256720.01430039929, 256700.57720107146, 256669.21559007684, 256619.9482404434, 256548.93003133417, 256531.86768394304, 256531.2973432227  …  289448.41674884345, 289448.2549483215, 289443.1167212055, 289414.53522786405, 289394.81193436444, 289382.2923042041, 289374.5313563638, 289369.79930499283, 289372.2211713366, 289372.68165777967], :FluidInternalEnergy =&gt; [1.1944099930754614e6 1.1945111444234843e6 … 1.3345413176948875e6 1.334559879085012e6])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ⋮</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Pressure =&gt; [1.4477480959273055e6, 1.3475338651185532e6, 1.3224406796257792e6, 1.3268075219468742e6, 1.3354439994978914e6, 1.3431028018806449e6, 1.3488232201379302e6, 1.3525053545875938e6, 1.3534064196957648e6, 1.3535435115268254e6  …  1.363612896530814e7, 1.3636113632885642e7, 1.3636011588954218e7, 1.363553514873806e7, 1.3634806664874678e7, 1.3633748144851055e7, 1.3632025195970392e7, 1.3628679770820409e7, 1.3623745789899683e7, 1.3600003155493716e7], :TotalMasses =&gt; [3.5421486660679174e6 3.5419853916676324e6 … 1.0361726050387634e6 1.0361590179036997e6], :TotalThermalEnergy =&gt; [1.8413900761329456e14, 1.8412998312999e14, 2.1208460714283072e14, 1.640863394894202e14, 1.2693372442033266e14, 9.818922204511572e13, 7.596290074621353e13, 5.878109142350868e13, 5.614390600290072e13, 5.614327567678289e13  …  1.8919334410851438e13, 1.89192358870331e13, 1.9552263351747215e13, 2.5257819538832008e13, 3.2625497604618316e13, 4.2141148553645445e13, 5.4433891577933945e13, 7.031677392376157e13, 6.106470409324052e13, 6.106592099674305e13], :FluidEnthalpy =&gt; [1.1951387121452265e6 1.1950870073292577e6 … 1.3482117248389686e6 1.3482319062680942e6], :Temperature =&gt; [285.0636182364449, 285.0493561878079, 285.1027800138294, 284.98680910315284, 284.8323012534409, 284.66617514221724, 284.53359600853895, 284.46568618392274, 284.4497084167003, 284.4465064466235  …  321.83175439238767, 321.83007419969346, 321.8201432080177, 321.774323345144, 321.70063891440515, 321.61801423025764, 321.54564734370973, 321.4929894936476, 321.5187363772913, 321.52514488237796], :PhaseMassDensities =&gt; [1000.1360939485884 1000.089992941449 … 994.725700837211 994.7126571875499], :RockInternalEnergy =&gt; [256557.2564128004, 256544.42056902713, 256592.50201244644, 256488.12819283755, 256349.0711280968, 256199.55762799553, 256080.23640768506, 256019.11756553047, 256004.73757503025, 256001.85580196115  …  289648.5789531489, 289647.0667797241, 289638.128887216, 289596.8910106296, 289530.5750229646, 289456.2128072319, 289391.08260933874, 289343.69054428284, 289366.8627395622, 289372.63039414014], :FluidInternalEnergy =&gt; [1.1936911610522433e6 1.193739594721763e6 … 1.3345157423400413e6 1.3345596130111185e6])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Pressure =&gt; [1.4477484094748513e6, 1.3475345855112209e6, 1.3224414285554518e6, 1.3268082507537273e6, 1.3354446177043305e6, 1.3431032372521656e6, 1.348823457879924e6, 1.352505458446522e6, 1.3534064903564272e6, 1.3535435755588491e6  …  1.3636128956166053e7, 1.363611361850151e7, 1.363601155653606e7, 1.3635535044146113e7, 1.3634806369279869e7, 1.3633747465659635e7, 1.3632023916574333e7, 1.362867798066107e7, 1.3623744778678026e7, 1.3600002813608125e7], :TotalMasses =&gt; [3.5421491553731076e6 3.5419859621746037e6 … 1.0361726232723126e6 1.0361590168550329e6], :TotalThermalEnergy =&gt; [1.8413823160058353e14, 1.841290778882883e14, 2.120837365667622e14, 1.6408534178964944e14, 1.269327425346101e14, 9.818848069818122e13, 7.596251493261667e13, 5.878094546146946e13, 5.614380226655335e13, 5.6143177257883195e13  …  1.89193471619356e13, 1.8919248971223402e13, 1.9552279823157426e13, 2.525785821835935e13, 3.2625560285754668e13, 4.214120881603189e13, 5.443391359039317e13, 7.031673323289066e13, 6.106469641174686e13, 6.106592136492675e13], :FluidEnthalpy =&gt; [1.195134106561769e6 1.1950816372300098e6 … 1.3482115505687045e6 1.3482319144997345e6], :Temperature =&gt; [285.06241358962444, 285.0479509192167, 285.10160646946764, 284.9850714933727, 284.830091863695, 284.6640199213858, 284.5321468796354, 284.4649778643889, 284.44918139222426, 284.4460064370576  …  321.83197184393583, 321.83029733188226, 321.82041500163825, 321.7748173472372, 321.7012585315189, 321.6184753052009, 321.54577769954915, 321.49280298312175, 321.5186958301902, 321.52514682560826], :PhaseMassDensities =&gt; [1000.136232105348 1000.0901540257704 … 994.7257183414183 994.7126561808298], :RockInternalEnergy =&gt; [256556.172230662, 256543.15582729504, 256591.44582252088, 256486.5643440354, 256347.08267732547, 256197.6179292472, 256078.93219167183, 256018.48007795002, 256004.26325300185, 256001.40579335182  …  289648.77465954225, 289647.267598694, 289638.37350147445, 289597.3356125135, 289531.13267836696, 289456.6277746808, 289391.19992959424, 289343.5226848096, 289366.8262471712, 289372.6321430474], :FluidInternalEnergy =&gt; [1.1936865553552427e6 1.1937342241192148e6 … 1.334515569327369e6 1.3345596215726244e6])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Pressure =&gt; [1.4477487216492535e6, 1.3475353035757332e6, 1.3224421738227052e6, 1.3268089761542254e6, 1.3354452327634017e6, 1.3431036694205524e6, 1.3488236930380838e6, 1.352505560872062e6, 1.353406559876834e6, 1.3535436384905828e6  …  1.363612895049563e7, 1.3636113608016944e7, 1.3636011529742757e7, 1.3635534952347727e7, 1.3634806103265509e7, 1.3633746849041797e7, 1.3632022751514722e7, 1.3628676348051276e7, 1.3623743855032582e7, 1.3600002500867106e7], :TotalMasses =&gt; [3.5421496424443936e6 3.5419865307942904e6 … 1.0361726414704629e6 1.0361590158060546e6], :TotalThermalEnergy =&gt; [1.8413745913087612e14, 1.8412817564134716e14, 2.1208286776874138e14, 1.6408434795880544e14, 1.2693176713900677e14, 9.818774751282642e13, 7.596213568738402e13, 5.878080279548943e13, 5.614370124620822e13, 5.614308153263102e13  …  1.8919359575791164e13, 1.8919261720315902e13, 1.955229592259145e13, 2.5257896232697355e13, 3.2625622262395277e13, 4.214126866673264e13, 5.443393553001462e13, 7.031669273006e13, 6.1064688760918625e13, 6.106592173860092e13], :FluidEnthalpy =&gt; [1.1951295220022048e6 1.1950762848914126e6 … 1.348211377020103e6 1.348231922864767e6], :Temperature =&gt; [285.06121444282894, 285.04655029963465, 285.10043532195107, 284.9833406218325, 284.8278970777824, 284.66188842773676, 284.5307224217722, 284.46428553986857, 284.44866816619407, 284.44552011236465  …  321.832183544534, 321.83051474945944, 321.82068065730925, 321.77530285376355, 321.7018711845565, 321.61893323032587, 321.54590762411897, 321.49261733459065, 321.5186554450104, 321.525148797838], :PhaseMassDensities =&gt; [1000.1363696313581 1000.0903145772113 … 994.7257358116426 994.7126551738106], :RockInternalEnergy =&gt; [256555.09299854605, 256541.8952696712, 256590.39178975596, 256485.00655964925, 256345.10737000415, 256195.6995849631, 256077.650179595, 256017.85698588172, 256003.80134957467, 256000.96810112818  …  289648.96519008063, 289647.4632745135, 289638.61259157833, 289597.7725683872, 289531.68406610086, 289457.0399072933, 289391.3168617071, 289343.35560113157, 289366.78990050935, 289372.6339180542], :FluidInternalEnergy =&gt; [1.1936819706825954e6 1.1937288712789277e6 … 1.3345153969478507e6 1.3345596302382187e6])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Pressure =&gt; [1.4477490324843614e6, 1.34753601940284e6, 1.3224429155933547e6, 1.326809698260928e6, 1.3354458447338238e6, 1.3431040984256265e6, 1.3488239256507484e6, 1.3525056618904218e6, 1.3534066282799742e6, 1.3535437003447819e6  …  1.3636128948173782e7, 1.3636113601297596e7, 1.363601150839229e7, 1.3635534872949053e7, 1.3634805865940062e7, 1.363374629313878e7, 1.3632021697433995e7, 1.3628674868280387e7, 1.3623743016356248e7, 1.3600002216392571e7], :TotalMasses =&gt; [3.5421501272929884e6 3.5419870975337005e6 … 1.0361726596323726e6 1.0361590147565356e6], :TotalThermalEnergy =&gt; [1.8413669018645834e14, 1.8412727637826228e14, 2.1208200074618228e14, 1.6408335798222225e14, 1.2693079819063406e14, 9.818702239396712e13, 7.596176288486853e13, 5.87806633390568e13, 5.614360286183902e13, 5.614298841962594e13  …  1.891937166213299e13, 1.8919274143812664e13, 1.9552311659644027e13, 2.5257933594445574e13, 3.26256835426892e13, 4.214132810837968e13, 5.443395739684762e13, 7.03166524143277e13, 6.106468114062189e13, 6.106592211769826e13], :FluidEnthalpy =&gt; [1.1951249583614517e6 1.1950709502488265e6 … 1.3482112041893215e6 1.3482319313613947e6], :Temperature =&gt; [285.06002076855987, 285.0451543121341, 285.09926656779396, 284.9816164629895, 284.8257167991957, 284.6597803848414, 284.5293221630129, 284.4636087905397, 284.44816833204186, 284.4450470589957  …  321.8323896598553, 321.83072661446903, 321.82094033335267, 321.77578002564, 321.70247695407244, 321.6193880257689, 321.5460371177091, 321.49243254373414, 321.51861522104315, 321.52515079871154], :PhaseMassDensities =&gt; [1000.1365065297848 1000.0904745977507 … 994.7257532470759 994.7126541662724], :RockInternalEnergy =&gt; [256554.01869170388, 256540.6388809207, 256589.33991101457, 256483.45481669056, 256343.1451192761, 256193.80234635723, 256076.38994671163, 256017.24791148573, 256003.35149883767, 256000.54235309616  …  289649.1506938698, 289647.65395302215, 289638.8463000174, 289598.202023076, 289532.2292586652, 289457.449223192, 289391.4334059382, 289343.1892893607, 289366.7536989388, 289372.6357188404], :FluidInternalEnergy =&gt; [1.19367740692919e6 1.1937235361361736e6 … 1.334515225200254e6 1.3345596390069844e6])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Pressure =&gt; [1.44774934202978e6, 1.34753673313004e6, 1.3224436541160499e6, 1.32681041724085e6, 1.3354464537022633e6, 1.3431045243200997e6, 1.3488241557612917e6, 1.352505761529713e6, 1.3534066955899727e6, 1.3535437611451119e6  …  1.3636128948889634e7, 1.3636113597996056e7, 1.3636011491993424e7, 1.3635534804860536e7, 1.3634805654806301e7, 1.36337457926659e7, 1.363202074467456e7, 1.36286735280309e7, 1.3623742255274244e7, 1.3600001957731454e7], :TotalMasses =&gt; [3.542150609930074e6 3.5419876623998987e6 … 1.0361726777550644e6 1.03615901370554e6], :TotalThermalEnergy =&gt; [1.8413592474971103e14, 1.8412638008817197e14, 2.1208113549649594e14, 1.640823718452771e14, 1.2692983564683653e14, 9.818630524756872e13, 7.596139640193989e13, 5.8780527008154875e13, 5.6143507035940234e13, 5.614289784006178e13  …  1.891938343038357e13, 1.8919286250930887e13, 1.9552327043640887e13, 2.525797031595778e13, 3.262574413470011e13, 4.2141387143594875e13, 5.443397919094499e13, 7.031661228475577e13, 6.106467355072362e13, 6.106592250215211e13], :FluidEnthalpy =&gt; [1.1951204155349887e6 1.1950656332378641e6 … 1.3482110320710556e6 1.3482319399873465e6], :Temperature =&gt; [285.05883253946564, 285.0437629398537, 285.0981002035068, 284.9798989913763, 284.82355093195196, 284.6576955193224, 284.52794564087395, 284.46294720868826, 284.4476814960063, 284.44458687658175  …  321.8325903505867, 321.8309330840966, 321.8211941836513, 321.77624902064383, 321.70307591977627, 321.61983971158674, 321.5461661806264, 321.4922486062445, 321.51857515758167, 321.52515282787544], :PhaseMassDensities =&gt; [1000.1366428037854 1000.0906340893831 … 994.7257706448601 994.7126531573166], :RockInternalEnergy =&gt; [256552.94928551908, 256539.38664586833, 256588.29018315615, 256481.90909223864, 256341.19583875677, 256191.92596739013, 256075.15107678657, 256016.65248781943, 256002.91334640566, 256000.12818892358  …  289649.331315528, 289647.83977568697, 289639.0747652862, 289598.62411857944, 289532.76832779864, 289457.8557404281, 289391.54956256377, 289343.02374562004, 289366.7176418235, 289372.6375450879], :FluidInternalEnergy =&gt; [1.1936728639904605e6 1.1937182186264305e6 … 1.3345150540866486e6 1.3345596478791044e6])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Pressure =&gt; [1.4477504717507777e6, 1.3475398777827474e6, 1.3224486730102757e6, 1.326814065011315e6, 1.335448587859518e6, 1.3431056485140745e6, 1.3488246830210064e6, 1.352505990218938e6, 1.3534068500579123e6, 1.3535438988948583e6  …  1.3636124542588765e7, 1.3636108741866024e7, 1.3636004730796847e7, 1.36355199904508e7, 1.3634771905377204e7, 1.3633674588995641e7, 1.3631890865943445e7, 1.3628495045718262e7, 1.3623643182448534e7, 1.3599969035283046e7], :TotalMasses =&gt; [3.542151156856461e6 3.5419883054901017e6 … 1.0361726543067822e6 1.0361589979034427e6], :TotalThermalEnergy =&gt; [1.8413505943851922e14, 1.8412536592996353e14, 2.1208015557651144e14, 1.6408125649460128e14, 1.2692874914512897e14, 9.818549834735228e13, 7.596098586377794e13, 5.878037490831761e13, 5.614340041506064e13, 5.614279714856414e13  …  1.8919396522903734e13, 1.8919299729455355e13, 1.9552344210110273e13, 2.52580114531256e13, 3.262581231224697e13, 4.2141453789941586e13, 5.443400385823357e13, 7.031656688426717e13, 6.106466496104312e13, 6.106592294055964e13], :FluidEnthalpy =&gt; [1.1951152799404005e6 1.1950596169551986e6 … 1.348210806768644e6 1.3482319396862881e6], :Temperature =&gt; [285.0574892718383, 285.04218859879086, 285.0967792731988, 284.9779564863358, 284.8211061446943, 284.6553497260692, 284.52640364654144, 284.46220910420976, 284.44713981712, 284.44407532146397  …  321.8328136221116, 321.8311629380889, 321.8214774422222, 321.77677440177814, 321.7037498493351, 321.62034958699445, 321.54631217770986, 321.49204039806176, 321.51852975520626, 321.5251551213712], :PhaseMassDensities =&gt; [1000.1367972300595 1000.0908156677933 … 994.7257481345091 994.7126379873032], :RockInternalEnergy =&gt; [256551.74034465445, 256537.96973891178, 256587.10134587894, 256480.16083770222, 256338.99553022484, 256189.81475346227, 256073.76328188728, 256015.9881937888, 256002.42583540798, 255999.66778931758  …  289649.5322599004, 289648.04664427997, 289639.329698, 289599.0969616003, 289533.3748644016, 289458.314628295, 289391.68095993885, 289342.8363582556, 289366.67677968566, 289372.63960923406], :FluidInternalEnergy =&gt; [1.1936677274898153e6 1.193712199444037e6 … 1.3345149280724323e6 1.3345596804669811e6])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Pressure =&gt; [1.4477508209390123e6, 1.347540686137539e6, 1.3224495135950013e6, 1.3268148797682908e6, 1.3354492769500245e6, 1.3431061289632265e6, 1.3488249417249279e6, 1.352506102448398e6, 1.3534069253073118e6, 1.3535439665591952e6  …  1.3636124578151047e7, 1.3636108776838508e7, 1.363600476697446e7, 1.3635520034559945e7, 1.3634771943172833e7, 1.3633674608207785e7, 1.3631890860615011e7, 1.3628495011041762e7, 1.3623643147358194e7, 1.3599969017671578e7], :TotalMasses =&gt; [3.5421516980362185e6 3.54198894068834e6 … 1.036172674888354e6 1.0361589967592818e6], :TotalThermalEnergy =&gt; [1.84134201161804e14, 1.8412435805739097e14, 2.1207917983021622e14, 1.6408014904477088e14, 1.269276749047959e14, 9.818470597006942e13, 7.596058642699442e13, 5.878022816971307e13, 5.6143298135517125e13, 5.614270074403442e13  …  1.8919409076016637e13, 1.891931267056348e13, 1.955236077175295e13, 2.5258051469447125e13, 3.262587924846099e13, 4.2141519690471984e13, 5.443402844175311e13, 7.031652198146724e13, 6.106465649392774e13, 6.106592340766412e13], :FluidEnthalpy =&gt; [1.195110186104948e6 1.1950536379975958e6 … 1.3482106150103647e6 1.3482319502588366e6], :Temperature =&gt; [285.05615692228344, 285.04062400951346, 285.0954639585827, 284.976027734451, 284.8186889438124, 284.65304615190627, 284.5249033487264, 284.4614970162538, 284.44662019386277, 284.4435855457834  …  321.83302769757364, 321.83138363024995, 321.8217507248113, 321.7772854770785, 321.70441152910195, 321.62085380056783, 321.5464577600347, 321.4918345829731, 321.51848506184314, 321.5251575869544], :PhaseMassDensities =&gt; [1000.1369500337557 1000.0909950178842 … 994.7257678928181 994.7126368889087], :RockInternalEnergy =&gt; [256550.5412300551, 256536.56160856213, 256585.9175627244, 256478.42496100592, 256336.82004943115, 256187.74153671565, 256072.41301385377, 256015.34731462842, 256001.9581744765, 255999.22699120504  …  289649.72492781625, 289648.24526722496, 289639.5756523302, 289599.5569293707, 289533.9703761918, 289458.76842051104, 289391.8119840312, 289342.6511246758, 289366.6365556588, 289372.64182825893], :FluidInternalEnergy =&gt; [1.1936626335263834e6 1.1937062199197903e6 … 1.3345147366214718e6 1.3345596910421373e6])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Pressure =&gt; [1.4477511633392237e6, 1.3475414766023094e6, 1.3224503202341583e6, 1.3268156704809074e6, 1.335449949613043e6, 1.3431065973492556e6, 1.348825192220868e6, 1.3525062099156422e6, 1.3534069973129837e6, 1.3535440313597783e6  …  1.3636124612665603e7, 1.363610881070403e7, 1.3636004801769622e7, 1.3635520076623263e7, 1.363477197848457e7, 1.363367462440705e7, 1.3631890852473909e7, 1.3628494975068511e7, 1.3623643111680979e7, 1.3599969000012705e7], :TotalMasses =&gt; [3.542152236373634e6 3.5419895734357852e6 … 1.0361726953754541e6 1.036158995599469e6], :TotalThermalEnergy =&gt; [1.8413334737958994e14, 1.8412335403390056e14, 2.1207820642563506e14, 1.6407904654787638e14, 1.269266087863625e14, 9.81839234877964e13, 7.596019461832317e13, 5.87800851095938e13, 5.614319883165763e13, 5.614260727756152e13  …  1.891942125835841e13, 1.8919325242229957e13, 1.955237691715415e13, 2.5258090712370723e13, 3.262594533001471e13, 4.214158507496284e13, 5.4434052929639586e13, 7.031647731661075e13, 6.106464806553977e13, 6.1065923881194e13], :FluidEnthalpy =&gt; [1.1951051189398651e6 1.195047681867879e6 … 1.3482104241289306e6 1.348231960976879e6], :Temperature =&gt; [285.05483154980766, 285.0390653954376, 285.0941518005703, 284.97410760869536, 284.8162900184968, 284.6507713442863, 284.52343170238737, 284.46080277912637, 284.44611568833875, 284.44311069667316  …  321.83323545006294, 321.8315980221108, 321.82201713902765, 321.7777866747984, 321.70506476036235, 321.6213540658576, 321.546602776024, 321.49162985851444, 321.5184405729008, 321.52516008645387], :PhaseMassDensities =&gt; [1000.1371020349084 1000.0911736759863 … 994.7257875604341 994.7126357754885], :RockInternalEnergy =&gt; [256549.3483948269, 256535.15885589385, 256584.73662051326, 256476.69684782583, 256334.6610166471, 256185.69420985767, 256071.08853214863, 256014.72250121372, 256001.50411950488, 255998.79962700585  …  289649.9119050566, 289648.4382198997, 289639.8154251249, 289600.00800731854, 289534.5582843261, 289459.21865927184, 289391.9424984216, 289342.466872663, 289366.5965156107, 289372.6440778085], :FluidInternalEnergy =&gt; [1.1936575662389467e6 1.193700263240386e6 … 1.3345145460466975e6 1.3345597017626287e6])</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> OrderedDict(:Pressure =&gt; [1.4477515042194312e6, 1.3475422647464809e6, 1.322451123139777e6, 1.3268164574970065e6, 1.335450618380552e6, 1.343107061578398e6, 1.3488254394140162e6, 1.3525063155523476e6, 1.3534070679079087e6, 1.3535440948178025e6  …  1.3636124646699585e7, 1.3636108844107846e7, 1.3636004836136568e7, 1.363552011832848e7, 1.3634772013622457e7, 1.3633674640511971e7, 1.3631890844361044e7, 1.3628494939370371e7, 1.3623643076220782e7, 1.3599968982460458e7], :TotalMasses =&gt; [3.5421527719366415e6 3.5419902038191333e6 … 1.0361727157704083e6 1.0361589944241632e6], :TotalThermalEnergy =&gt; [1.8413249799812094e14, 1.84122353763377e14, 2.120772352811018e14, 1.6407794889431997e14, 1.2692555064309711e14, 9.818315070665283e13, 7.595981024204627e13, 5.877994560898848e13, 5.614310239764377e13, 5.614251664232716e13  …  1.8919433082886395e13, 1.8919337457191105e13, 1.9552392659593273e13, 2.5258129201579125e13, 3.2626010573505168e13, 4.214164995249587e13, 5.4434077324036266e13, 7.0316432884865664e13, 6.106463967507111e13, 6.10659243611125e13], :FluidEnthalpy =&gt; [1.1951000778886857e6 1.1950417479956483e6 … 1.348210234106291e6 1.3482319718396317e6], :Temperature =&gt; [285.0535130088809, 285.0375126073955, 285.0928426891506, 284.9721959182419, 284.8139090386085, 284.6485247395825, 284.52198797241124, 284.4601258154944, 284.4456257628483, 284.4426502314547  …  321.8334371005486, 321.83180633087153, 321.8222769039944, 321.7782782463198, 321.70570970718285, 321.6218504523507, 321.546747238372, 321.4914262025387, 321.51839628411415, 321.5251626196754], :PhaseMassDensities =&gt; [1000.1372532526987 1000.0913516665787 … 994.7258071395902 994.7126346471949], :RockInternalEnergy =&gt; [256548.16170799278, 256533.76134665596, 256583.55842023552, 256474.9763264177, 256332.51813474763, 256183.67226562425, 256069.78917517012, 256014.11323394495, 256001.06318656346, 255998.38520830925  …  289650.09339049377, 289648.62569778436, 289640.049213595, 289600.45042168786, 289535.13873646455, 289459.66540711565, 289392.0725145348, 289342.2835822849, 289366.5566557027, 289372.6463577079], :FluidInternalEnergy =&gt; [1.1936525250657997e6 1.193694328819889e6 … 1.3345143563292818e6 1.3345597126275185e6])</span></span></code></pre></div><p>Set up plotting utilities for performance metrics</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig_wells </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">800</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lcolor </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cgrad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:seaborn_icefire_gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, categorical </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> make_axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n, val, name)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    vmin, vmax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> minimum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(val), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">maximum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(val)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    dv </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> vmax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> vmin</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    pad </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dv</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig_wells[n, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        xlabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Time (years)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ylabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> name,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        limits </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ((times[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], times[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]), (vmin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pad, vmax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pad)),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> plot_well_value!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, val, x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">times)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, x, val, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lcolor, linewidth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> color_stages!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ylim </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ax</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">yaxis</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">attributes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">limits[]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> eachindex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ch_start)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        poly!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, [(times[ch_start[k]], ylim[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]), (times[ch_stop[k]], ylim[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            (times[ch_stop[k]], ylim[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]), (times[ch_start[k]], ylim[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:red</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> eachindex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dch_start)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        poly!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, [(times[dch_start[k]], ylim[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]), (times[dch_stop[k]], ylim[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            (times[dch_stop[k]], ylim[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]), (times[dch_start[k]], ylim[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:blue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">color_stages! (generic function with 1 method)</span></span></code></pre></div><p>Plot volumetric flow rate in the hot well</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rate </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> abs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(results</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Hot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:rate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">si_unit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:hour</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax_rate </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> make_axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, rate, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Rate (m³/h)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_well_value!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax_rate, rate)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">color_stages!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax_rate)</span></span></code></pre></div><p>Plot water temperature at the hot well</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">temp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> convert_from_si</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(results</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Hot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Celsius</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax_temp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> make_axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, temp, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Temperature (°C)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_well_value!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax_temp, temp)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">color_stages!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax_temp)</span></span></code></pre></div><p>Plot thermal power (effect) delivered by the system</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mrate </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> results</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wells[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Hot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:mass_rate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Cp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">reservoir_model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data_domain[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:component_heat_capacity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">effect </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mrate</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Cp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">temp</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">effect_mwh </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> abs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(effect)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-6</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Convert to MW</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax_effect </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> make_axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, effect_mwh, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Effect (MW)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_well_value!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax_effect, effect_mwh)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">color_stages!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax_effect)</span></span></code></pre></div><p>Plot energy recovery efficiency over discharge cycles</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax_eta </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> make_axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.05</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.05</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Efficiency (–)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">energy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> effect</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dt</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> eachindex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ch_start)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    energy_ch </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(energy[ch_start[k]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ch_stop[k]])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    energy_dch </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> abs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cumsum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(energy[dch_start[k]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dch_stop[k]]))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    η </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> energy_dch</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">./</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">energy_ch</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    plot_well_value!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax_eta, η, times[dch_start[k]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dch_stop[k]])</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">color_stages!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax_eta)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig_wells</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR25/assets/hxhshds.BUoPVLIb.jpeg" alt=""></p><p>The efficiency improves with each cycle as the thermal plume matures and losses decrease. Notably, efficiency exceeds 100% after the second year because the hot well produces at higher rates than the cold well injects due to lower viscosity of heated water. This rate imbalance extracts more energy than stored, causing progressive aquifer cooling as shown below. While beneficial for energy recovery in the short term, this trend requires monitoring for system sustainability.</p><h3 id="Aquifer-temperature-evolution" tabindex="-1">Aquifer temperature evolution <a class="header-anchor" href="#Aquifer-temperature-evolution" aria-label="Permalink to &quot;Aquifer temperature evolution {#Aquifer-temperature-evolution}&quot;">​</a></h3><p>Examine the spatial and temporal temperature distribution in the aquifer to understand thermal plume propagation. We analyze temperature profiles along a horizontal transect between wells and track aquifer-wide temperature statistics.</p><p>Extract temperature along a horizontal line in the aquifer layer This transect passes through the center of the aquifer between the two wells</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ijk </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cell_ijk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(msh, c) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">number_of_cells</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(msh)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">maximum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">getindex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(ijk, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> minimum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">getindex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(ijk, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">maximum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">getindex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(ijk[layers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> minimum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">getindex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(ijk[layers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cells </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ix[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ix[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ix </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ijk]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">T_line </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [state[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][cells] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> state </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> results</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states]</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">130-element Vector{Vector{Float64}}:</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [311.50074637564416, 311.5013323703091, 311.5022296992947, 311.50327547061204, 311.50419453532805, 311.50489475177085, 311.5052632044655, 311.50521999937814, 311.5049439249236, 311.50887048106694  …  311.49466027138925, 311.4943088126125, 311.4943780075538, 311.4946919370987, 311.4952563218207, 311.49602591815756, 311.4969432560774, 311.4979703237443, 311.49894884303706, 311.4999658100171]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [311.5010873563615, 311.50144172418305, 311.50227544393107, 311.50327647562426, 311.5040672260747, 311.50443243506635, 311.5041678490111, 311.5039580537018, 311.5128074057815, 311.6072578250037  …  311.49766657623013, 311.4960976666264, 311.495459294393, 311.4953056263986, 311.49557144980884, 311.49618064265604, 311.4970273606781, 311.49803360211524, 311.49906569973393, 311.5003056845277]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [311.5014258891869, 311.50155045547285, 311.50232003839585, 311.50327057193294, 311.50391208690036, 311.50389713589647, 311.50313734369803, 311.5058871226704, 311.5498560358397, 311.8828851522424  …  311.5005364257467, 311.4978210949586, 311.49650567213195, 311.49590496025405, 311.4958817918296, 311.49633418038104, 311.49711138644994, 311.49809747132554, 311.4991845601794, 311.500642403117]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [311.50176185872397, 311.50165813081736, 311.5023625903187, 311.5032558166643, 311.5037252045534, 311.5033049377117, 311.5026171484096, 311.5155217066993, 311.6407078019677, 312.40659891577826  …  311.50327679830775, 311.49948132661814, 311.49751820789675, 311.4964900025622, 311.49618712460745, 311.49648627569337, 311.4971951231991, 311.4981617902573, 311.4993052889659, 311.50097596813663]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [311.502095310802, 311.5017648078588, 311.502403082195, 311.50323159073344, 311.50350576949876, 311.5027059372238, 311.50342869880154, 311.53947612427385, 311.81273262671544, 313.2217597153521  …  311.50589475222233, 311.5010809851923, 311.4984983388813, 311.4970612020181, 311.496487573522, 311.49663697089693, 311.4972785985715, 311.49822658345425, 311.4994278472308, 311.50130641313615]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [311.5024262776246, 311.5018705022513, 311.5024414167537, 311.50319719913364, 311.50325534929846, 311.5021988850769, 311.50685921585097, 311.5862303620504, 312.0923061331104, 314.34210027874576  …  311.508396961085, 311.5026226325904, 311.49944745505525, 311.49761900744477, 311.4967832693859, 311.496786311722, 311.4973618416029, 311.49829187526234, 311.49955219662905, 311.5016337712745]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [311.5027547731625, 311.501975173296, 311.50247739097694, 311.50315188804313, 311.5029794183809, 311.50194979598854, 311.51472012460437, 311.66562887756345, 312.5014310828578, 315.75177195868525  …  311.51078964688463, 311.504108690489, 311.50036683606976, 311.4981638116727, 311.4970743014702, 311.4969343094139, 311.4974448540121, 311.4983576707561, 311.4996782889665, 311.5019580719513]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [311.50308081694976, 311.5020787972197, 311.50251083030236, 311.5030951431131, 311.5026897410735, 311.5022114098121, 311.5293652851028, 311.7882108021132, 313.05564012068396, 317.4156419128413  …  311.5130786855998, 311.50554151622595, 311.50125772556623, 311.498696017602, 311.4973607763517, 311.497080990758, 311.4975276495669, 311.4984239826991, 311.4998060813641, 311.50227934580505]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [311.50340442616863, 311.5021813428781, 311.502541545833, 311.5030267444231, 311.5024066971901, 311.50334037087214, 311.55366596394344, 311.9644945701522, 313.76380728982934, 319.2856035951242  …  311.5152695960428, 311.5069233714694, 311.50212130494975, 311.4992160122585, 311.4976427950946, 311.49722637894206, 311.49761023904847, 311.49849082120636, 311.49993553035176, 311.502597622788]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [311.50338586108427, 311.5010961758174, 311.5004421884819, 311.4998165185549, 311.4980917552557, 311.49787554623686, 311.54743730198663, 311.9597607000596, 313.7633484261746, 319.2754673799268  …  311.52387574064437, 311.51456262547157, 311.5089419125853, 311.5052249908925, 311.5027743548905, 311.5014207438853, 311.5008125721111, 311.50064895471013, 311.50122544281595, 311.5033552846808]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> ⋮</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [311.52993483077296, 311.5145381096123, 311.50556891372645, 311.5150763358464, 311.62488277591865, 312.1087647050019, 313.35972817731346, 315.5650132721588, 318.88303783909754, 323.47324687127417  …  302.10390919901914, 305.0697372202711, 307.65664356577713, 309.6956479559011, 310.8985805107255, 311.37964787006644, 311.49487313861084, 311.5096180337875, 311.5165273503859, 311.53149647866024]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [311.52995956160646, 311.5148112334729, 311.50574354953534, 311.51506720405956, 311.6224405555174, 312.0900921242963, 313.2815999078981, 315.3481480967119, 318.45657371107717, 322.7211839184983  …  301.615148756078, 304.68612765189386, 307.3825421854674, 309.54887090743796, 310.8412051751352, 311.3646203802999, 311.4925390226545, 311.50944617876553, 311.5165353375553, 311.5316395111622]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [311.52998637830143, 311.5150786154122, 311.5059155503285, 311.51505832404, 311.6200771585104, 312.07221784116405, 313.2078509735196, 315.14671129456207, 318.0606717461071, 322.0282034641954  …  301.1193683174537, 304.2938681784845, 307.1003450636816, 309.3950784249988, 310.7803632640764, 311.3484806632663, 311.48998524433995, 311.50925125168703, 311.5165429647876, 311.53178270368187]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [311.5300150299389, 311.51534061107196, 311.5060850727254, 311.5150495218854, 311.6177870129516, 312.0550867589438, 313.13813834075455, 314.95924583136406, 317.6927826330215, 321.38841891538897  …  300.621339372976, 303.8927447919352, 306.81010845802876, 309.2342381491977, 310.7159310836358, 311.33117092990756, 311.48719724015496, 311.50903108875576, 311.51654989587934, 311.5319259369654]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [311.53004530602277, 311.51559759188206, 311.5062523562202, 311.5150408135194, 311.6155653950706, 312.03864965613866, 313.07215482645745, 314.7844662905582, 317.3504886738917, 320.79683489273424  …  300.12558262642995, 303.4844491304297, 306.5118202676633, 309.0663017265423, 310.6477867670607, 311.31263140910795, 311.4841595281904, 311.50878329013136, 311.51655572652567, 311.5320690798129]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [311.53081915380363, 311.51703622705776, 311.50868386860714, 311.51864248147876, 311.62029368523343, 312.04439928205954, 313.0784982471102, 314.7903455426928, 317.35143025967074, 320.78817007202855  …  300.123411846651, 303.4809608073854, 306.5063311295877, 309.0596449124253, 310.64200558908317, 311.3079830643987, 311.48064538698287, 311.50645449163227, 311.5153332187792, 311.5319700963798]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [311.53115612550357, 311.5171386523416, 311.50872344139515, 311.5186602196238, 311.6203204486871, 312.0444171204889, 313.0782082273968, 314.7888195748722, 317.344278666802, 320.77068407921956  …  300.1324193397899, 303.48693759793025, 306.50900624125785, 309.0599727598518, 310.64206328408716, 311.3080523913984, 311.48070695829153, 311.50650900312047, 311.51544163374854, 311.532305624135]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [311.5314926017719, 311.517241028891, 311.5087629809176, 311.5186780741581, 311.6203479301102, 312.0444394456178, 313.07793236689776, 314.78731865250495, 317.3371958559993, 320.753350618558  …  300.14138992410193, 303.4928857559626, 306.5116654620897, 309.06029299199173, 310.642116168778, 311.3081205204054, 311.48076837703763, 311.50656347409983, 311.51555000281087, 311.532640660938]</span></span>
<span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;"> [311.53182861097815, 311.5173433676519, 311.5088024951084, 311.5186960528868, 311.6203761395942, 312.0444662177174, 313.0776704685165, 314.7858423097674, 317.3301804135121, 320.7361663784501  …  300.15032485470937, 303.4988061768453, 306.514309247385, 309.0606057667646, 310.6421643030953, 311.3081874727605, 311.48082964883554, 311.5066179078212, 311.51565833355505, 311.5329752336077]</span></span></code></pre></div><p>Temperature profile plotting utilities</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> geo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cell_centroids[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, cells]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> plot_aquifer_temperature!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig, T_line, stage, cycle)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Create subplot for specific operational stage and cycle</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    row, col </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cycle, stage </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Charging&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> :</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[row, col],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ylabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;T, cycle </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$cycle</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> (°C)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        xlabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;x (m)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cycle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> stage </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        limits </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">90.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Plot temperature profiles throughout the operational stage</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> stage </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Charging&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        steps </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ch_start[cycle]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ch_stop[cycle]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    else</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        steps </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dch_start[cycle]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dch_stop[cycle]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    colors </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cgrad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:seaborn_icefire_gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(steps), categorical </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (n, T_n) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> enumerate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(T_line[steps])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        T_n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> convert_from_si</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(T_n, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Celsius</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, x, T_n, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> colors[n], linewidth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        label </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Year </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$(round(times[n], digits</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1))</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ax</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">plot_aquifer_temperature! (generic function with 1 method)</span></span></code></pre></div><p>Plot temperature profiles during charge and discharge stages for all cycles Shows thermal plume evolution and migration patterns over multiple years</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">800</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cycle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">num_years</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Plot charging stage temperatures (thermal plume development)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> plot_aquifer_temperature!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig, T_line, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Charging&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, cycle)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cycle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> num_years</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        hidexdecorations!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax; grid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Plot discharging stage temperatures (thermal recovery and cooling)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> plot_aquifer_temperature!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig, T_line, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Discharging&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, cycle)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cycle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> num_years</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        hidedecorations!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax; grid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    else</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        hideydecorations!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax; grid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR25/assets/njdwtsc.U1Bj55zA.jpeg" alt=""></p><h3 id="Plot-aquifer-temperature-statistics-over-time" tabindex="-1">Plot aquifer temperature statistics over time <a class="header-anchor" href="#Plot-aquifer-temperature-statistics-over-time" aria-label="Permalink to &quot;Plot aquifer temperature statistics over time {#Plot-aquifer-temperature-statistics-over-time}&quot;">​</a></h3><p>Many regions operate under legal regulations limiting the maximum allowable temperature increase in the aquifer to protect groundwater resources. This is typically defined as the mean temperature increase across the entire aquifer volume. We monitor the overall thermal state of the aquifer throughout the simulation to assess system-wide temperature impacts and thermal equilibrium.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cells </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> layers </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">T_aquifer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [state[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][cells] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> state </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> results</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">states]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">T_mean </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">mean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">convert_from_si</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(T, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:Celsius</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> T </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> T_aquifer]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Figure</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">800</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">400</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ax </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Axis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fig[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Mean aquifer temperature evolution&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    xlabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Time (years)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ylabel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Temperature (°C)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    limits </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ((times[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], times[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">end</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lines!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ax, times, T_mean, color </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> lcolor, linewidth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fig</span></span></code></pre></div><p><img src="/Fimbul.jl/previews/PR25/assets/acunyig.6ilJO98w.jpeg" alt=""></p><p>The proposed setup results in a maximum increase in the mean aquifer temperature of approximately 1°C due to charging. However, the setup also results in a higher rate during discharging compared to charging, leading to a net cooling effect.</p><h2 id="Example-on-GitHub" tabindex="-1">Example on GitHub <a class="header-anchor" href="#Example-on-GitHub" aria-label="Permalink to &quot;Example on GitHub {#Example-on-GitHub}&quot;">​</a></h2><p>If you would like to run this example yourself, it can be downloaded from the Fimbul.jl GitHub repository <a href="https://github.com/sintefmath/Fimbul.jl/blob/main/examples/storage/ates_demo.jl" target="_blank" rel="noreferrer">as a script</a>.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;">This example took 224.244274123 seconds to complete.</span></span></code></pre></div><hr><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl" target="_blank" rel="noreferrer">Literate.jl</a>.</em></p></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-4f9813fa><!--[--><!--]--><div class="edit-info" data-v-4f9813fa><div class="edit-link" data-v-4f9813fa><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://https://github.com/sintefmath/Fimbul.jl/edit/main/docs/src/examples/storage/ates_demo.md" target="_blank" rel="noreferrer" data-v-4f9813fa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-4f9813fa></span> Edit this page<!--]--></a></div><!----></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-4f9813fa><span class="visually-hidden" id="doc-footer-aria-label" data-v-4f9813fa>Pager</span><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link prev" href="/Fimbul.jl/previews/PR25/extras/refs" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Previous page</span><span class="title" data-v-4f9813fa>Bibliography</span><!--]--></a></div><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link next" href="/Fimbul.jl/previews/PR25/examples/storage/btes_demo" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Next page</span><span class="title" data-v-4f9813fa>Borehole Thermal Energy Storage (BTES)</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860>Made with <a href="https://luxdl.github.io/DocumenterVitepress.jl/dev/" target="_blank"><strong>DocumenterVitepress.jl</strong></a><br></p><p class="copyright" data-v-c970a860>© Copyright 2025.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"examples_analytical_analytical_1d.md\":\"BKequpgS\",\"examples_production_doublet_demo.md\":\"h87_wa9i\",\"examples_storage_ates_demo.md\":\"Yjv9QL79\",\"examples_storage_btes_demo.md\":\"Df-IXJXQ\",\"examples_storage_egg_htates.md\":\"BCXCEcFa\",\"extras_refs.md\":\"DaPqex-e\",\"index.md\":\"DBC9CJnu\",\"man_cases_cases.md\":\"C-JQa8JW\",\"man_cases_utils.md\":\"Dfu3j1B6\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Fimbul.jl\",\"description\":\"Documentation for Fimbul.jl\",\"base\":\"/Fimbul.jl/previews/PR25/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"logo\":{\"src\":\"/logo.png\",\"width\":24,\"height\":24},\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"text\":\"Manual\",\"collapsed\":false,\"items\":[{\"text\":\"Introduction\",\"collapsed\":false,\"items\":[{\"text\":\"Fimbul.jl\",\"link\":\"/index\"}]},{\"text\":\"Cases\",\"collapsed\":false,\"items\":[{\"text\":\"Setup functions\",\"link\":\"/man/cases/cases\"},{\"text\":\"Utilities\",\"link\":\"/man/cases/utils\"}]},{\"text\":\"References\",\"collapsed\":false,\"items\":[{\"text\":\"Bibliography\",\"link\":\"/extras/refs\"}]}]},{\"text\":\"Examples\",\"collapsed\":false,\"items\":[{\"text\":\"Storage\",\"collapsed\":false,\"items\":[{\"text\":\"Aquifer Thermal Energy Storage (ATES)\",\"link\":\"/examples/storage/ates_demo\"},{\"text\":\"Borehole Thermal Energy Storage (BTES)\",\"link\":\"/examples/storage/btes_demo\"},{\"text\":\"Digital twinning of a high-temperature aquifer thermal energy storage system\",\"link\":\"/examples/storage/egg_htates\"}]},{\"text\":\"Production\",\"collapsed\":false,\"items\":[{\"text\":\"Geothermal energy production from a well doublet\",\"link\":\"/examples/production/doublet_demo\"}]},{\"text\":\"Analytical\",\"collapsed\":false,\"items\":[{\"text\":\"Heat equation in 1D\",\"link\":\"/examples/analytical/analytical_1d\"}]}]},{\"component\":\"VersionPicker\"}],\"sidebar\":[{\"text\":\"Manual\",\"collapsed\":false,\"items\":[{\"text\":\"Introduction\",\"collapsed\":false,\"items\":[{\"text\":\"Fimbul.jl\",\"link\":\"/index\"}]},{\"text\":\"Cases\",\"collapsed\":false,\"items\":[{\"text\":\"Setup functions\",\"link\":\"/man/cases/cases\"},{\"text\":\"Utilities\",\"link\":\"/man/cases/utils\"}]},{\"text\":\"References\",\"collapsed\":false,\"items\":[{\"text\":\"Bibliography\",\"link\":\"/extras/refs\"}]}]},{\"text\":\"Examples\",\"collapsed\":false,\"items\":[{\"text\":\"Storage\",\"collapsed\":false,\"items\":[{\"text\":\"Aquifer Thermal Energy Storage (ATES)\",\"link\":\"/examples/storage/ates_demo\"},{\"text\":\"Borehole Thermal Energy Storage (BTES)\",\"link\":\"/examples/storage/btes_demo\"},{\"text\":\"Digital twinning of a high-temperature aquifer thermal energy storage system\",\"link\":\"/examples/storage/egg_htates\"}]},{\"text\":\"Production\",\"collapsed\":false,\"items\":[{\"text\":\"Geothermal energy production from a well doublet\",\"link\":\"/examples/production/doublet_demo\"}]},{\"text\":\"Analytical\",\"collapsed\":false,\"items\":[{\"text\":\"Heat equation in 1D\",\"link\":\"/examples/analytical/analytical_1d\"}]}]}],\"editLink\":{\"pattern\":\"https://https://github.com/sintefmath/Fimbul.jl/edit/main/docs/src/:path\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/sintefmath/Fimbul.jl\"}],\"footer\":{\"message\":\"Made with <a href=\\\"https://luxdl.github.io/DocumenterVitepress.jl/dev/\\\" target=\\\"_blank\\\"><strong>DocumenterVitepress.jl</strong></a><br>\",\"copyright\":\"© Copyright 2025.\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>